<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Crayon&#39;s Blog</title>
    <link>http://ddongeee.github.io/</link>
    
    <atom:link href="/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description></description>
    <pubDate>Wed, 02 Sep 2020 17:20:27 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>BookReview 오브젝트 - 01.객체,설계</title>
      <link>http://ddongeee.github.io/2020/09/02/bookreview-object-01/</link>
      <guid>http://ddongeee.github.io/2020/09/02/bookreview-object-01/</guid>
      <pubDate>Wed, 02 Sep 2020 08:02:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h3 id=&quot;Definition&quot;&gt;&lt;a href=&quot;#Definition&quot; class=&quot;headerlink&quot; title=&quot;Definition&quot;&gt;&lt;/a&gt;Definition&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><ul><li><strong>자율적인 객체</strong>들이 오직 <strong>메시지</strong>만을 통해 <strong>협력</strong>하여 요구사항을 해결하도록 설계하는것</li></ul><h3 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h3><ul><li><strong>요구사항 변경에 용이</strong>하고, <strong>코드 파악도 쉬워</strong>진다. </li></ul><h3 id="How"><a href="#How" class="headerlink" title="How"></a>How</h3><ul><li><h6 id="자율적인-객체-만들기"><a href="#자율적인-객체-만들기" class="headerlink" title="자율적인 객체 만들기"></a>자율적인 객체 만들기</h6><ul><li>캡슐화 적용<ul><li>메시지 만으로 객체와 상호작용</li><li>객체 내부의 상태를 캡슐화, 객체간에 오직 메시지를 통해서만 상호작용하도록 만드는것</li><li>불필요한 의존성을 제거함으로써, 결합도(coupling) 낮추기</li></ul></li><li>책임의 이동<ul><li>절차지향과는 다른 객체지향의 특징중 하나.</li><li>연관된 상태(데이터) 혹은 행동(메소드)를 가지고 있는 객체에게 위임.<ul><li>응집도가 높아짐</li></ul></li></ul></li><li>의인화 적용<ul><li>능동적인(자율적인) 객체가 될수 있음 </li></ul></li></ul></li><li><h6 id="메시지만을-통한-객체간에-협력적인-관계-만들기"><a href="#메시지만을-통한-객체간에-협력적인-관계-만들기" class="headerlink" title="메시지만을 통한 객체간에 협력적인 관계 만들기"></a>메시지만을 통한 객체간에 협력적인 관계 만들기</h6><ul><li>메시지(인터페이스)로 상호작용 (모든 객체는 캡슐화 되어있다)</li><li>상대 객체의 상태 혹은 행동으로 대화하지 않고, 필요한 부분을 위임하고, 결과만 받기</li></ul></li></ul><h3 id="What"><a href="#What" class="headerlink" title="What"></a>What</h3><ul><li>적절한 책임을 가지고 있는 각각의 자율적인 객체들은, 협력하는 객체들과 의존성(결합도)이 낮다.<ul><li>이는 요구사항 변경에 용이하다.</li></ul></li><li>이러한 책임을 가지는 객체들이 메시지로만 상호작용한다면, 추상화 하기 편하다.<ul><li>추상화된 코드는 이해하기 편하다. (vs getter, setter)</li></ul></li></ul><h3 id="Etc"><a href="#Etc" class="headerlink" title="Etc"></a>Etc</h3><h6 id="결합도-Coupling-응집도-Cohesion-관련"><a href="#결합도-Coupling-응집도-Cohesion-관련" class="headerlink" title="결합도(Coupling), 응집도(Cohesion) 관련"></a>결합도(Coupling), 응집도(Cohesion) 관련</h6><ul><li>Getter, Setter 사용<ul><li>Getter, Setter 는 메시지가 아니다. (개인적인 생각..)</li><li>Getter, Setter 를 사용하면 결합도가 높아진다.</li><li>Getter, Setter 를 사용하면 응집도가 낮아진다.</li><li>객체 내부의 여러 상태를 바꾸는 혹은 생성후 설정하는 것을 여러 setter로 하는것과 context 를 넘겨 자율적으로 설정하는 것</li></ul></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2020/09/02/bookreview-object-01/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Book review 오브젝트intro</title>
      <link>http://ddongeee.github.io/2020/08/30/bookreview-object-introduction/</link>
      <guid>http://ddongeee.github.io/2020/08/30/bookreview-object-introduction/</guid>
      <pubDate>Sat, 29 Aug 2020 21:47:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;서문&lt;/p&gt;
&lt;p&gt;목차&lt;/p&gt;
&lt;p&gt;1장 ‘객체, 설계’&lt;/p&gt;
&lt;p&gt;2장 ‘객체지향 프로그래밍’&lt;/p&gt;
&lt;p&gt;3장 ‘역할, 책임, 협력’&lt;/p&gt;
&lt;p&gt;4장 ‘설계 품질과 트레이드오프’&lt;/p&gt;
&lt;p&gt;5
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><p>서문</p><p>목차</p><p>1장 ‘객체, 설계’</p><p>2장 ‘객체지향 프로그래밍’</p><p>3장 ‘역할, 책임, 협력’</p><p>4장 ‘설계 품질과 트레이드오프’</p><p>5장 ‘책임 할당하기’</p><p>6장 ‘메시지와 인터페이스’</p><p>7장 ‘객체 분해’</p><p>8장 ‘의존성 관리하기’</p><p>9장 ‘유연한 설계’</p><p>10장 ‘상속과 코드 재사용’</p><p>11장 ‘합성과 유연한 설계’</p><p>12장 ‘다형성’</p><p>13장 ‘서브클래싱과 서브타이핑’</p><p>14장 ‘일관성 있는 협력’</p><p>15장 ‘디자인 패턴과 프레임워크’</p><p>부록 A ‘계약에 의한 설계’</p><p>부록 B ‘타입 계층의 구현’</p><p>부록 C ‘동적인 협력, 정작인 코드’</p><p>부록 D ‘참고문헌’</p><h1 id="테스트"><a href="#테스트" class="headerlink" title="테스트"></a>테스트</h1><h1 id="H1-Hello-World"><a href="#H1-Hello-World" class="headerlink" title="H1 : Hello World"></a>H1 : Hello World</h1><h2 id="H2-Hello-World"><a href="#H2-Hello-World" class="headerlink" title="H2 : Hello World"></a>H2 : Hello World</h2><h3 id="H3-Hello-world"><a href="#H3-Hello-world" class="headerlink" title="H3 : Hello world"></a>H3 : Hello world</h3><h4 id="H4-Hello-world"><a href="#H4-Hello-world" class="headerlink" title="H4 : Hello world"></a>H4 : Hello world</h4><h5 id="H5-Hello-world"><a href="#H5-Hello-world" class="headerlink" title="H5 : Hello world"></a>H5 : Hello world</h5><h6 id="H6-Hello-world"><a href="#H6-Hello-world" class="headerlink" title="H6 : Hello world"></a>H6 : Hello world</h6><p>H7 : Hello world</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String helloWorld = <span class="hljs-string">"Hello World!"</span>;</span><br></pre></td></tr></tbody></table></figure></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2020/08/30/bookreview-object-introduction/#disqus_thread</comments>
    </item>
    
    <item>
      <title>AWS training</title>
      <link>http://ddongeee.github.io/2019/12/16/aws-training/</link>
      <guid>http://ddongeee.github.io/2019/12/16/aws-training/</guid>
      <pubDate>Sun, 15 Dec 2019 15:30:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 id=&quot;AWS-기반-아키텍처-설계-시작&quot;&gt;&lt;a href=&quot;#AWS-기반-아키텍처-설계-시작&quot; class=&quot;headerlink&quot; title=&quot;AWS 기반 아키텍처 설계 시작&quot;&gt;&lt;/a&gt;AWS 기반 아키텍
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h2 id="AWS-기반-아키텍처-설계-시작"><a href="#AWS-기반-아키텍처-설계-시작" class="headerlink" title="AWS 기반 아키텍처 설계 시작"></a>AWS 기반 아키텍처 설계 시작</h2><h5 id="모듈0-Tech-Traniner-김현도님"><a href="#모듈0-Tech-Traniner-김현도님" class="headerlink" title="모듈0 - Tech Traniner 김현도님"></a>모듈0 - Tech Traniner 김현도님</h5><ul><li>(기본) 교육과정 : 아키텍쳐, 개발, 운영</li><li>on promise : I형 T형 인재</li><li>AWS 아키텍쳐 설계, 예제</li></ul><p>3티어 웹서비스 구축 하기</p><ul><li>모듈별 진행 예정(3 tier)<ul><li>S3 (presentation) - > EC2(), 컨테이너, 람다 -> DB layer</li></ul></li><li>(module 5 ~) 기반서비스<ul><li>network -> network 확장</li></ul></li><li>IAM 권한제어</li><li>확장성 가용성 및 모니터링<ul><li>ELB, Cloud watch</li></ul></li><li>자동화<ul><li>AWS CloudFormation</li></ul></li></ul><p>캐싱</p><p>Loosed coupled 하게</p><p>MSA, 서비리스</p><ul><li>쿠버네티스</li></ul><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">## 실습사이트</span></span><br><span class="line">http://aws-class.com/43319</span><br><span class="line"><span class="hljs-comment">## 교재</span></span><br><span class="line">https://online.vitalsource.com/</span><br></pre></td></tr></tbody></table></figure><p>ARN : 리소스 식별자</p><p>클라우드 </p><ul><li><p>소프트웨어(API : 코드) > 모든것을 코드로 한다. > 자동화 할수 있다. > </p></li><li><p>정의</p><ul><li>프로그래밍 가능한 리소스, 동적기능, 종량과금(디펜던시 줄여야함)</li></ul></li><li><p>장점</p><ul><li>빠른 대응(속도 및 민첩성. MSA, CI, CD 는 결국 빠른 Infra support 를 위해) + Fail fast</li></ul></li></ul><p>서버 vs 인스턴스</p><ul><li>인스턴스는 1회성 작업용</li></ul><p>AWS Well Architectred Framwork : WAF</p><ul><li>보안, 안정성, 비용 최적화, 성능효율성, 운영탁월성</li></ul><p>죽는경우 대비해서 설계 하기</p><p>CDN : Cloud front</p><p>Region service : 모든 AZ 에 들어간다.</p><p>AZ service : 특정 AZ에 들어간다.</p><p>S2</p><ul><li>EBS(Block storage) : 공유 x</li><li>EFS(File storage) : NFS(리눅스 기준)</li><li>S3(Object storage) : 파일시스템 x (메타데이터 줄이기)<ul><li>3tier : web + index server + disk server(메타 데이터를 최소화, 진짜 폴더 아님)</li><li>key value data store</li><li>HA, endurance</li><li>99.9(*9) : 연간 downtime 1시간</li><li>웹서비스를 구현할수 잇다!</li><li>transfer acceleration 옵션 체크: Upload 빠르게 , AWS backbone 사용. </li><li>빅데이터분석 트렌드 : ETL -> ELT (S3 연동으로 많이함)</li><li>mutipart upload api 제공, 분할 다운로드도 제공(byte 단위로)</li><li>S3 종류 : 과금때무네. (Life cycle 로 자동적으로 migration 설정할수 잇따.)</li></ul></li></ul><h3 id="EC2"><a href="#EC2" class="headerlink" title="EC2"></a>EC2</h3><ul><li>리전선택<ul><li>데이터 거버넌스 : 데이터 주권, 규정에 따라.</li><li>서비스 주요 제공 국가. 레이턴시 고려</li></ul></li></ul><h4 id="개념"><a href="#개념" class="headerlink" title="개념"></a>개념</h4><ul><li>shut-down / up<ul><li>사설 ip : N</li><li>공용 ip : Y</li><li>IS : Y</li><li>EBS : N</li></ul></li><li>EBS <ul><li>optimized (스토리지 독립 네트워크 어뎁터 사용) : 속도 좋음</li><li>EC2 root 볼륨은 기본적으로 EBS</li><li>따로 만들수도 있음</li></ul></li><li>user data 로 인스턴스 시작시에 셋팅<ul><li>169.254~/meta-data/public-hostname 에서 메타 데이터 가져올수잇음</li></ul></li><li>스팟인스턴스로</li><li>전용인스턴스, 전용 호스트</li><li>배치그룹<ul><li>AZ 내에 렉을 컨트롤</li><li>cluster(같은 렉에, 높은 bandwith), spread(서로다른렉에 배포, 렉마다의 장애, 가용성을 높이기 위해), partition(파티션그룹으로 만들어서 cluster + spread사용)</li></ul></li></ul><h3 id="데이터베이스"><a href="#데이터베이스" class="headerlink" title="데이터베이스"></a>데이터베이스</h3><ul><li>SQL vs NoSQL<ul><li>무결성 과 성능</li></ul></li><li>RDS(관리형) , DynamoDB(완전관리형:serverless)</li></ul><h2 id="네트워크"><a href="#네트워크" class="headerlink" title="네트워크"></a>네트워크</h2><ul><li>VPC : 사내망 분리</li><li>route53<ul><li>public ~</li><li>private :: region :: VPCs</li></ul></li><li>IG (for public subnet)<ul><li>들어오고 나갈수 잇따. </li><li>create IG > subnet~</li><li>create route > add route > destination: 0.0.0.0/0, target: pub-igw</li></ul></li><li>NAT GW<ul><li>내보낼수만 잇다.</li></ul></li><li>NIC</li><li>EIP<ul><li>안쓰면 과금</li></ul></li><li>SG<ul><li>EC2 interface에 할당</li><li>default deny</li><li>룰 최종 결과에 따라</li><li>statefull : 들어온거 처리하면 나가는거는 처리 안해도됨.</li></ul></li><li>NACL<ul><li>subnet 에 설정</li><li>룰 순차적으로. (범용적인 룰은 밑에 선언)</li><li>stateless(패킷추적x, 인바운드 아웃바운드 따로 처리해야함)</li></ul></li><li>site-to-site vpn connections</li></ul><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://s3.console.aws.amazon.com/s3/buckets/website-2321/?region=us-west-2&tab=properties</span><br></pre></td></tr></tbody></table></figure><p>관리형, 비관리형</p><ul><li>mysql ~</li></ul><p>ARN</p><ul><li>arn:aws;s3;:A:bucketname/filename</li><li>s3는 버켓의 이름이 글로벌함. 그래서 regionName,A가 생략된다.</li></ul><p>실습내용</p><ol><li>S3로 웹서비스 제공<ol><li>bucket 생성후(public accessable)에, 속성에서 Static web service hosting 하고, index.html 을 public 으로 하면 됨</li></ol></li><li></li></ol><h3 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h3><ul><li>동일 AZ 를 사용하는 기업 업체가 많이 있는가? 있음</li><li>AZ 개수의 기준이 무엇? 버지니아 6, 한국3.. 속도 위험성? 일본의 경우에는 천재지변 위험성때문에 있음. 그러나 버지니아 같은경우에는 사용자가 많아서</li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/12/16/aws-training/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Functional programming in java8</title>
      <link>http://ddongeee.github.io/2019/12/08/java8/</link>
      <guid>http://ddongeee.github.io/2019/12/08/java8/</guid>
      <pubDate>Sat, 07 Dec 2019 22:18:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 id=&quot;목적&quot;&gt;&lt;a href=&quot;#목적&quot; class=&quot;headerlink&quot; title=&quot;목적&quot;&gt;&lt;/a&gt;목적&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;구현기술 및 정의, 컨셉, 패러다임 파악&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 i
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h2 id="목적"><a href="#목적" class="headerlink" title="목적"></a>목적</h2><ul><li>구현기술 및 정의, 컨셉, 패러다임 파악</li></ul><h2 id="관련된-다양한-정의-혹은-개념"><a href="#관련된-다양한-정의-혹은-개념" class="headerlink" title="관련된 다양한 정의 혹은 개념"></a>관련된 다양한 정의 혹은 개념</h2><ul><li><p>함수형 인터페이스</p><ul><li>하나의 추상 메소드만 가진 인터페이스</li><li>명시적으로 @FunctioalInterface 어노테이션을 선언해 놓을수 있다.</li></ul></li><li><p>순수함수 (Fure fuction)</p><ul><li>동일한 입력값에 대해서 항상 동일한 출력값을 리턴하는 함수.</li><li>함수의 실행이 외부의 상태에 영향을 미치지 않는 함수</li><li>멀티쓰레드 환경 및 병렬 처리에 적합하다.</li></ul></li><li><p>1급 객체</p></li><li><p>고차함수</p><ul><li>정의<ul><li>파라미터 혹은 리턴값을 함수로 사용하는 함수</li><li>현재 상태가 아닌 다른 상태에서 함수를 재사용 할수 있는 개념</li></ul></li><li>활용 혹은 이점<ul><li>객체,클래스가 아닌 함수 자체로 사용되어 작고 집중되어 있고, 두개이상 결합 가능할수 있다.</li></ul></li></ul></li><li><p>커링 </p></li><li><p>렉시컬 스코프</p><ul><li><p>사용한 하나의 컨텍스트에서 제공한 값을 캐시해 두었다가, 나중에 다른 컨텍스트에서 사용하는 기술</p></li><li><p><strong>클로저와 상관 관계는?</strong></p></li><li><p>정적 메소드의 파라미터 혹은 기타 방법으로 컨텍스트 값을 캐시하는 방법보다. Function interface를 한번더 랩핑하는것이 더 효율적이다. </p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function<String, Predicate<String>> startWithLetter = letter -> name -> name.startWith(name);</span><br></pre></td></tr></tbody></table></figure></li></ul></li><li><p>참조 투명성</p><ul><li>?</li></ul></li></ul><h2 id="일반적인-장점"><a href="#일반적인-장점" class="headerlink" title="일반적인 장점"></a>일반적인 장점</h2><h3 id="함수형-서술형-스타일-vs-명령형-스타일"><a href="#함수형-서술형-스타일-vs-명령형-스타일" class="headerlink" title="함수형(서술형) 스타일 vs 명령형 스타일"></a>함수형(서술형) 스타일 vs 명령형 스타일</h3><ul><li>(명령형->선언형) for + if 으로 구성된 코드를 stream + filter + map 으로 변환하면<ul><li>세련되고, 간결하고, 오류 줄어들고, 효율적이고, 더욱 쉽게 최적화 성능향상, 병렬화 가능</li><li>변수의 명시적인 재할당 문제 해결가능</li><li>병렬화 쉽게 가능</li><li>직관적, 가독성이 좀더 높다. (코드가 더 간결해 진다. 왜냐면, 로우 레벨의 판단 코드가 내부로 들어가있어서..)</li></ul></li><li>객체지향에서 함수지향으로 패러다임 자체가 변하는 것은 아니다!<ul><li>명령형 스타일에서 서술적 스타일로 변경된것일뿐!</li></ul></li></ul><h3 id="설계관점에서-다양한-장점을-갖을수-있다"><a href="#설계관점에서-다양한-장점을-갖을수-있다" class="headerlink" title="설계관점에서 다양한 장점을 갖을수 있다!"></a>설계관점에서 다양한 장점을 갖을수 있다!</h3><h2 id="사용"><a href="#사용" class="headerlink" title="사용"></a>사용</h2><ul><li><p>Typed Stream 을 사용하면 sum(), max(), min(), sorted(), average() 를 사용할수 있다.</p></li><li><p>reduce()</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// reduce 에 default 값을 넣어주면 결과값이 Optional 이 아닌 String 으로 return</span></span><br><span class="line">Optional<String> longestNameOpt = results.stream()</span><br><span class="line">  .reduce((n1, n2) -> n1.length() >= n2.length() ? n1:n2);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// String.join(",", results); 와 같은</span></span><br><span class="line">results.stream().collect(joining(<span class="hljs-string">","</span>));</span><br></pre></td></tr></tbody></table></figure></li><li><p>String, Comparator, filter..</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="hljs-comment">// 문자의 각각의 캐릭터를 가져온다. 숫자 제외</span></span><br><span class="line">  someString.chars()</span><br><span class="line">    .filter(ch -> !Character.isDigit(ch)) <span class="hljs-comment">// 메서드 레퍼런스를 사용할수도 있다.</span></span><br><span class="line">      .mapToObj(ch -> Character.valueOf((<span class="hljs-keyword">char</span>)ch));</span><br><span class="line">  </span><br><span class="line">  <span class="hljs-comment">// Comparator</span></span><br><span class="line">  people.stream().sorted(Person::ageDifferent).reversed();</span><br><span class="line">  people.stream().max(Person::ageDifferent).ifPresent(~);</span><br><span class="line">  people.stream().sorted((p1,p2) -> p1.getName().compareTo(p2.getName()));</span><br><span class="line">  people.stream().sorted(comparing(Person::getAge).thenComparing(Person::getName));</span><br><span class="line">  </span><br><span class="line">  List<Person> personList = people.stream().collect(Collectors.toList());</span><br><span class="line"><span class="hljs-comment">// 아래 groupingBy() 의 파라미터를 분류함수(classifier function) 이라고 한다.</span></span><br><span class="line">  Map<Integer,List<Person>> peopleByAge = people.stream()</span><br><span class="line">    .collect(Collectors.groupingBy(Person::getAge));</span><br><span class="line">  Map<Integer, List<String>> nameOfPeopleByAge = people.stream()</span><br><span class="line">    .collect(groupingBy(Person::getAge, mapping(Person::getName, toList())));</span><br><span class="line">  Map<Character, Optional<Person>> oldesTpersonOfEachLetter = people.steram()</span><br><span class="line">    .collect(</span><br><span class="line">    groupingBy(p -> p.getName().charAt(<span class="hljs-number">0</span>), reducing(maxBy(comparing(Person::getAge)))</span><br><span class="line">  );</span><br></pre></td></tr></tbody></table></figure></li></ul><h2 id="설계-관점에서의-FP"><a href="#설계-관점에서의-FP" class="headerlink" title="설계 관점에서의 FP"></a>설계 관점에서의 FP</h2><p>문제의 분리</p><ul><li>람다표현식 + Strategy pattern 으로 SoC 구현하기</li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// 객체의 appleFilter라는 Predicate Functional interface를 받는 고차함수를 만듦으로써 </span></span><br><span class="line"><span class="hljs-comment">// Strategy pattern 구현가능 및 Predicate 를 합성하여 넘겨줄수도 있음</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findSomeApples</span><span class="hljs-params">(<span class="hljs-keyword">final</span> List<Apple> apples, <span class="hljs-keyword">final</span> Predicate<Apple> appleFilter)</span> </span>{</span><br><span class="line"><span class="hljs-keyword">return</span> apples.stream()</span><br><span class="line">.filter(appleFilter)</span><br><span class="line">.collect(Collectos.toList());</span><br><span class="line">}</span><br><span class="line">List<Apple> greenApples = findSomeApples(appleList, apple -> apple.isGreen());</span><br><span class="line"><span class="hljs-keyword">final</span> Predicate<Apple> greenAppleFilter = a -> a.isGreen();</span><br><span class="line"><span class="hljs-keyword">final</span> Predicate<Apple> redAppleFilter = a -> a.isRed();</span><br><span class="line">List<Apple> redAndGreenApples = findSomeApples(appleList, greenAppleFilter.and(redAppleFilter));</span><br></pre></td></tr></tbody></table></figure><ul><li>클래스에 독립적인 비헤이비어 구현하여 다양화. 설계 유연화<ul><li>의존성 인젝션과 의존성 인버전 원칙(Dependency inversion priciple)을 적용</li><li>로직을 추상화 하고, 실제 delegate 되는 동작을 생성자 인젝션으로 설정한다.</li></ul></li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Function<String,Integer> engine;</span><br><span class="line">  </span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Function<String,Integer> engine)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">this</span>.engine = engine;</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getMaxSpeed</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> engine.maxSpeed();</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>데코레이션 패턴 구현(체이닝)</li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setFilters</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Function<Color,Color>... filters)</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">this</span>.filters = Stream.of(filters)</span><br><span class="line">    .reduce((filter, nextFilter) -> filter.andThan(nextFilter))</span><br><span class="line">    .orElse(color -> color); <span class="hljs-comment">// 또는 orElseGet(Function::identity)</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>예외처리</li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@FunctionalInterface</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UseInstance</span><<span class="hljs-title">T</span>, <span class="hljs-title">X</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Throwable</span>> </span>{</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(T instance)</span> throw X</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li><p>리소스 처리 패턴</p><ul><li>JVM 은 외부 리소스에 대해서 자동으로 GC를 안함 (ex. DB connection, File socket Open, 네이티브 리소스 사용)</li><li>EAM(excute around method) 패턴을 사용해야함<ul><li>Lock 관리나 예외처리 테스트 가능하게함</li></ul></li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="hljs-comment">// ARM:automatic resource management</span></span><br><span class="line"><span class="hljs-comment">// 자바 7부터, try 블록을 사용하면, 자바 컴파일러는 자동으로 finally 블록과 close() 메소드 호출을 추가한다.</span></span><br><span class="line"><span class="hljs-comment">// 또한 try-with-resource 사용하기 위해서는 AutoCloseable 이 구현되어 있어야함..</span></span><br><span class="line"><span class="hljs-keyword">try</span>(<span class="hljs-keyword">final</span> FilteWriterARM writerARM = <span class="hljs-keyword">new</span> FileWriterARM(<span class="hljs-string">"something.txt"</span>)) {</span><br><span class="line">  writerARM.writeStuff(<span class="hljs-string">"Hello world :)"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 고차함수를 사용하여 좀더 나은 방향으로 구현하기</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">use</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String fileName, <span class="hljs-keyword">final</span> UseInstance<FileWriterARM, IOException> block)</span> <span class="hljs-keyword">throws</span> IOException </span>{</span><br><span class="line">  <span class="hljs-keyword">final</span> FileWriterEAM writerEAM = <span class="hljs-keyword">new</span> FileWriterEAM(fileName);</span><br><span class="line">  <span class="hljs-keyword">try</span> {</span><br><span class="line">    block.accept(writerEAM);</span><br><span class="line">  } <span class="hljs-keyword">finally</span> {</span><br><span class="line">    writerEAM.close();</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">FileWriterEAM.use(<span class="hljs-string">"test.txt"</span>, writerEAM -> {</span><br><span class="line">  writerEAM.writeStuff(<span class="hljs-string">"Hello"</span>);</span><br><span class="line">  writerEAM.writeStuff(<span class="hljs-string">"World"</span>);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 잠금관리 관련</span></span><br><span class="line"><span class="hljs-comment">// synchronized는 상호 배제(mutual exclusion)를 제공하기 위해 사용되는 키워드</span></span><br><span class="line"><span class="hljs-comment">// 하지만 synchronized는 메소드가 호출되는 시간을 제어하기 힘들다. deadlock, livelock이 발생할 가능성 증가</span></span><br><span class="line"><span class="hljs-comment">// 또한 스레드 세이프한지 테스트 하기 힘듦</span></span><br><span class="line"><span class="hljs-comment">// Java5 에서 ReentrantLock 관련 구현체에 관련되어 Lock 관련 인터페이스 문제는 개발자가 직접 locking, unlocking 설정을 해줘야함</span></span><br><span class="line">Lock lock = <span class="hljs-keyword">new</span> ReentrantLock();</span><br><span class="line"><span class="hljs-function">pubilc <span class="hljs-keyword">void</span> <span class="hljs-title">doSome</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">  lock.lock();</span><br><span class="line">  <span class="hljs-keyword">try</span> {</span><br><span class="line">    <span class="hljs-comment">// do something</span></span><br><span class="line">  } <span class="hljs-keyword">finally</span> {</span><br><span class="line">    lock.unlock();</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 테스트 헬퍼 적용</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestHelper</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <X extends Throwable> <span class="hljs-function">Throwable <span class="hljs-title">assertThrows</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Class<X> exceptionClass, <span class="hljs-keyword">final</span> Runnable block)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">try</span> {</span><br><span class="line">      block.run();</span><br><span class="line">    } <span class="hljs-keyword">catch</span> (Throwable ex) {</span><br><span class="line">      <span class="hljs-keyword">if</span> (exceptionClass.isInstance(ex)) {</span><br><span class="line">        <span class="hljs-keyword">return</span> ex;</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    fail(<span class="hljs-string">"Failed to throw expected exception "</span>);</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul><h2 id="이벨류에이션-지연"><a href="#이벨류에이션-지연" class="headerlink" title="이벨류에이션 지연"></a>이벨류에이션 지연</h2><ul><li>지연초기화 구현가능 </li><li>Eager 방식은 간단하지만, Lazy 방식은 효율적이다. (eager computaion -> lazy evaluation)</li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// 생성자를 Supplier 로 제공하는 방법</span></span><br><span class="line"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Supplier<Apple> makeApple = () -> <span class="hljs-keyword">new</span> Apple(); <span class="hljs-comment">// 또는 Apple::new</span></span><br></pre></td></tr></tbody></table></figure><ul><li>Lazy evaluation</li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// func1() || func2() 혹은 func1() && func2() 와 같은 short-circuit-ing 을 통해 성능 향상</span></span><br><span class="line"><span class="hljs-comment">// 메서드에 대한 모든 인수는 실행되기전에 모두 평가 되기 때문에, 이를 지연하면 성능향상에 도움이 된다.</span></span><br><span class="line"><span class="hljs-comment">// 메소드 내부에서 boolean 값으로 쇼트서킷이 사용되는 부분을 리팩터링 해보면</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isAllRight</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Supplier<Boolean> sup1, <span class="hljs-keyword">final</span> Supplier<Boolean> sup2)</span> </span>{</span><br><span class="line"><span class="hljs-keyword">return</span> sup1.get() && sup2.get();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Stream 의 lazy evaluation</span></span><br><span class="line"><span class="hljs-comment">// 중간(Intermediate) operation, 종단(Terminal) operation</span></span><br><span class="line"><span class="hljs-comment">// Intermediate operation은 실행되기 전까지 캐시해 놓는다. </span></span><br><span class="line"><span class="hljs-comment">// 캐시 비헤이비어는 종단 operation 호출될때 실행된다.</span></span><br><span class="line"><span class="hljs-comment">// filter, map 메소드는 본질적으로 lazy 속성을 가진다.</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// findFirst() 의 경우 모든 person 이 filter()가 호출되지 않고, 찾을때 까지만 filter가 적용된다.</span></span><br><span class="line"><span class="hljs-comment">// 즉 people 에서 3번째 한국인이 있었다면, filter(3번호출), map(1번호출) 이 된다!</span></span><br><span class="line">Optional<Person> firstKoreanName = people.stream().filter(Person::isKorean).map(Person:: getName).findFirst();</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// infinite stream </span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPrime</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> number)</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">return</span> number > <span class="hljs-number">1</span> && IntStream.rangeClosed(<span class="hljs-number">2</span>, (<span class="hljs-keyword">int</span>) Math.sqrt(number))</span><br><span class="line">    .nonMatch(divisor -> number % divisor == <span class="hljs-number">0</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="재귀호출최적화-TOC-Tail-Call-Optimization"><a href="#재귀호출최적화-TOC-Tail-Call-Optimization" class="headerlink" title="재귀호출최적화 (TOC : Tail-Call Optimization)"></a>재귀호출최적화 (TOC : Tail-Call Optimization)</h2><ul><li>Trampoline call 이라고도 한다.</li><li>Memoization 기술을 사용한다.</li></ul><h2 id="그래서-결론은"><a href="#그래서-결론은" class="headerlink" title="그래서 결론은"></a>그래서 결론은</h2><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// 우리가 해결해야하는 문제, 개발해야 하는 목표를 코드로 설명할수 있어야 하며,</span></span><br><span class="line"><span class="hljs-comment">// 이러한 목표를 성취하기 위해서는 문제를 좀더 서술적으로 생각하고 표현할수 있어야 한다. (추상화 레벨을 올려야 한다.)</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 불변성을 선호 혹은 추구 함으로써, 병렬화 시에 가변 변수를 공유할때 생기는 이슈를 해결할수 있다.</span></span><br><span class="line"><span class="hljs-comment">// 함수형 스타일을 사용하면 가변성을 쉽게 피할수 있다. 순수함수.. :)</span></span><br></pre></td></tr></tbody></table></figure><h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ul><li><a href="https://www.coupang.com/vp/products/4122909?itemId=20151148&vendorItemId=3827923639&q=%EB%9E%8C%EB%8B%A4%EC%9D%98+%ED%9E%98&itemsCount=1&searchId=5d80016814a84647b778b26f612f2c6b&rank=0&isAddedCart=" target="_blank" rel="external nofollow noopener noreferrer">람다의 힘</a></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/12/08/java8/#disqus_thread</comments>
    </item>
    
    <item>
      <title>OOP : Object Oriented Programming</title>
      <link>http://ddongeee.github.io/2019/11/28/oop/</link>
      <guid>http://ddongeee.github.io/2019/11/28/oop/</guid>
      <pubDate>Thu, 28 Nov 2019 02:47:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;객체지향의-사실과-오해-역할-책임-협력관점에서-본-객체지향&quot;&gt;&lt;a href=&quot;#객체지향의-사실과-오해-역할-책임-협력관점에서-본-객체지향&quot; class=&quot;headerlink&quot; title=&quot;객체지
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="객체지향의-사실과-오해-역할-책임-협력관점에서-본-객체지향"><a href="#객체지향의-사실과-오해-역할-책임-협력관점에서-본-객체지향" class="headerlink" title="객체지향의 사실과 오해 : 역할, 책임, 협력관점에서 본 객체지향"></a>객체지향의 사실과 오해 : 역할, 책임, 협력관점에서 본 객체지향</h1><ol><li><h2 id="객체지향의-공통적인-특징-추상화-캡슐화-상속-다형성"><a href="#객체지향의-공통적인-특징-추상화-캡슐화-상속-다형성" class="headerlink" title="객체지향의 공통적인 특징 : 추상화, 캡슐화, 상속, 다형성"></a>객체지향의 공통적인 특징 : 추상화, 캡슐화, 상속, 다형성</h2></li><li><h2 id="객체지향-디자인의-5원칙-SOLID-원칙"><a href="#객체지향-디자인의-5원칙-SOLID-원칙" class="headerlink" title="객체지향 디자인의 5원칙(SOLID 원칙)"></a>객체지향 디자인의 5원칙(SOLID 원칙)</h2><ol><li>S - SRP (Single Responsibility Principle)</li><li>O - OCP (Open Closed Principle)</li><li>L  - LSP (Liskov Substitusion Principle)</li><li>I - ISP (Interface Segregation Principle)</li><li>D - DIP (Dependency Inversion Principle)</li></ol></li><li><h2 id="객체지향이란-무엇인가"><a href="#객체지향이란-무엇인가" class="headerlink" title="객체지향이란 무엇인가?"></a>객체지향이란 무엇인가?</h2><ol><li>클래스가 아닌, 객체를 바라보는것</li><li>기능을 구현하기 위해 협력하는 공동체의 존재</li><li>협력에 참여하는 객체들에게 얼마나 적절한 역할과 책임을 부여하는것</li></ol></li><li><h2 id="책의-구성"><a href="#책의-구성" class="headerlink" title="책의 구성"></a>책의 구성</h2><ol><li>객체지향 패러다임의 핵심이 클래스나 상속이 아닌 자율적 객체의 협력<ol><li>객체간에 req,resp를 통해 collaboration 할 수 있다.</li><li>collaboration 과정속에 각 객체는 role을 부여받는다. 이러한 role은 협력안에서 차지하는 책임이나 임무를 의미</li></ol></li><li>위에서 말한 객체에 대해 얘기, 객체는 상태와 행동, 식별자를 가진존재</li><li>타입과 추상화에 대해서 얘기. 동적인 객체들을 단순화시켜 정적인 타입으로 갈무리 하는것</li><li>객체지향의 핵심인 “<strong>역할, 책임, 협력</strong>“을 얘기</li><li>객체의 자율성과 설계의 유연성은 얼마나 훌륭한 “<strong>메시지</strong>“를 선택하느냐에 달려있다.</li><li>구조와 기능이라는 두가지 관점. 도메인 모델과 유스케이스 모델</li><li>결론</li></ol></li><li><h2 id="기타"><a href="#기타" class="headerlink" title="기타"></a>기타</h2><ol><li>객체란 현실세계에 존재하는 사물이나 현상, 정의에 대한 추상화</li><li>객체지향의 목표는 실세계를 모방하는것이 아닌 새로운 세계를 창조하는 것이다.</li></ol></li></ol><h1 id="추가"><a href="#추가" class="headerlink" title="추가"></a>추가</h1><ol><li>RUP란?</li><li></li></ol></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/11/28/oop/#disqus_thread</comments>
    </item>
    
    <item>
      <title>ML : Machine Learning</title>
      <link>http://ddongeee.github.io/2019/11/28/ML/</link>
      <guid>http://ddongeee.github.io/2019/11/28/ML/</guid>
      <pubDate>Thu, 28 Nov 2019 02:47:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;구글-머신러닝&quot;&gt;&lt;a href=&quot;#구글-머신러닝&quot; class=&quot;headerlink&quot; title=&quot;구글 머신러닝&quot;&gt;&lt;/a&gt;구글 머신러닝&lt;/h1&gt;&lt;h2 id=&quot;소개&quot;&gt;&lt;a href=&quot;#소개&quot; cl
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="구글-머신러닝"><a href="#구글-머신러닝" class="headerlink" title="구글 머신러닝"></a>구글 머신러닝</h1><h2 id="소개"><a href="#소개" class="headerlink" title="소개"></a>소개</h2><p>머신러닝의 실용적 가치 이해</p><p>머신러닝의 원리 이해</p><ol><li>Reduce time programming</li><li>Customize and scale products</li><li>Complete seemingly “unprogrammable” tasks</li></ol><p>etc</p><ol><li>철학적인 이유 : 논리학에서 자연과학으로 초점이 바뀜</li></ol><h2 id="머신러닝-문제로-표현하기"><a href="#머신러닝-문제로-표현하기" class="headerlink" title="머신러닝 문제로 표현하기"></a>머신러닝 문제로 표현하기</h2><h3 id="프레이밍"><a href="#프레이밍" class="headerlink" title="프레이밍"></a>프레이밍</h3><p>기본적인 머신러닝 용어 알아보기</p><p>다양한 머신러닝 용도 확인</p><ol><li>라벨<ol><li>예측하는 항목(선형 회귀의 y변수)</li><li>밀의 향후 가격, 사진에 표시되는 동물의 종류 등등..</li></ol></li><li>특성<ol><li>입력변수(선형 회귀의 x변수)</li><li>수백만개의 특성을 사용할수 있다.</li><li>스팸감지 예에서<ol><li>이메일 텍스트의 단어</li><li>보낸느 사람의 주소</li><li>이메일이 전송된 시간</li><li>‘이상한 속임수 하나’ 라는 구문이 포함된 이메일</li></ol></li></ol></li><li>모델 <ol><li>feature 와 label 간의 관계 정의 # {features, ?} : (x, ?)<ol><li><strong>학습</strong>이란, 모델을 만들거나 <strong>배우는</strong> 것을 의미<ol><li>즉 라벨이 있는 예를 모델에 보여주고, 모델이 특성과 라벨의 관계를 점차적으로 학습하도록 한다.</li></ol></li><li><strong>추론</strong>은 학습된 모델을 라벨이 없는 예에 적용하는 것을 의미<ol><li>즉 학습된 모델을 사용하여 유용한 예측(y’)을 해낸다.</li></ol></li></ol></li></ol></li><li>회귀와 분류<ol><li>회귀모델<ol><li>연속적인 값을 예측<ol><li>캘리포니아의 주택가격</li><li>사용자가 이 광고를 클릭할 확율</li></ol></li></ol></li><li>분류모델<ol><li>불연속적인 값을 예측<ol><li>스팸 메일인지 아닌지</li><li>이미지가 강아지 혹은 고양이 혹은 햄스터인지?</li></ol></li></ol></li></ol></li></ol><h3 id="선형회귀"><a href="#선형회귀" class="headerlink" title="선형회귀"></a>선형회귀</h3></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/11/28/ML/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Setting Oracle using docker</title>
      <link>http://ddongeee.github.io/2019/11/28/setting_oracle/</link>
      <guid>http://ddongeee.github.io/2019/11/28/setting_oracle/</guid>
      <pubDate>Thu, 28 Nov 2019 02:47:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h3 id=&quot;Local-Base-Oracle-환경구축&quot;&gt;&lt;a href=&quot;#Local-Base-Oracle-환경구축&quot; class=&quot;headerlink&quot; title=&quot;Local Base Oracle 환경구축&quot;
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h3 id="Local-Base-Oracle-환경구축"><a href="#Local-Base-Oracle-환경구축" class="headerlink" title="Local Base Oracle 환경구축"></a>Local Base Oracle 환경구축</h3><h3 id="설치"><a href="#설치" class="headerlink" title="설치"></a>설치</h3><h5 id="방법1"><a href="#방법1" class="headerlink" title="방법1"></a>방법1</h5><ul><li><a href="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html" target="_blank" rel="external nofollow noopener noreferrer">https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html</a><ul><li>Oracle DB 11g Express 로 다운로드 : <ul><li>비트 확인 $ uname -a </li><li>Oracle Database 11<em>g</em> Release 2 Express Edition downloads for <a href="https://www.oracle.com/technetwork/database/database-technologies/express-edition/downloads/index.html?ssSourceSiteId=null" target="_blank" rel="external nofollow noopener noreferrer">Linux x86 and Windows</a>.</li></ul></li><li>Express Edition 법적 정책 : <a href="https://m.blog.naver.com/PostView.nhn?blogId=hanajava&logNo=220824719322&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F" target="_blank" rel="external nofollow noopener noreferrer">https://m.blog.naver.com/PostView.nhn?blogId=hanajava&logNo=220824719322&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F</a></li></ul></li></ul><h5 id="방법2"><a href="#방법2" class="headerlink" title="방법2"></a>방법2</h5><ul><li>docker 로 oracle 띄워서 사용하기 <ul><li>(도커 설치후에) <ul><li>다운로드 : <a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="external nofollow noopener noreferrer">https://www.docker.com/products/docker-desktop</a></li><li>설명 : <a href="http://lhoris.tistory.com/18" target="_blank" rel="external nofollow noopener noreferrer">http://lhoris.tistory.com/18</a></li></ul></li><li>$ docker pull wnameless/oracle-xe-11g</li><li>$docker run -d -p 59160:22 -p 59161:1521 wnameless/oracle-xe-11g<ul><li>-d : 백그라운드 실행 , -p : 호스트 포스트를 도커 포트와 매핑</li></ul></li><li>접근 : system / oracle (ID/PW)<ul><li>로케일 이슈잇을시에 시스템 환경설정 > 언어 및 지역 > 지역 잠깐 바꾼후에 connect해보기</li></ul></li></ul></li></ul><h3 id="Todo"><a href="#Todo" class="headerlink" title="Todo"></a>Todo</h3><ul><li><p>로컬에 system/oracle을 netpion/netpion으로 바꾸기</p></li><li><p>로컬 시스템 재부팅시에 도커 이미지(오라클) 자동 재실행 관련 ::: systemctl</p><ul><li><a href="https://github.com/xmlangel/docker/wiki/%EB%B6%80%ED%8C%85%EC%8B%9C-%EC%8B%9C%EC%9E%91" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/xmlangel/docker/wiki/%EB%B6%80%ED%8C%85%EC%8B%9C-%EC%8B%9C%EC%9E%91</a></li></ul></li><li><p>오라클 도커 이미지 재실행시, 내부 table 데이터 초기화 관련 ::: 호스트 디렉토리 볼륨에 맵핑하기</p><ul><li><a href="https://github.com/wnameless/docker-oracle-xe-11g/issues/64" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/wnameless/docker-oracle-xe-11g/issues/64</a></li><li>docker run –name oracle11g -d -p 59161:22 -p 59162:1521 -p 59163:8080 -v /oracle11g-data/:/u01/app/oracle/oradata/oracle11g-data/ -e ORACLE_ALLOW_REMOTE=true –restart=always wnameless/oracle-xe-11g</li></ul></li><li><p>초기 sequence 존재 안한다는 에러 ?</p><ul><li>SELECT MARKETING_EMAIL_SEQUENCE.nextval from dual; 쿼리 실행필요?</li></ul><p>docker run –name oracle11g -d -p 59161:22 -p 59162:1521 -p 59163:8080 -v /oracle11g-data/:/u01/app/oracle/oradata/oracle11g-data/ -e ORACLE_ALLOW_REMOTE=true –restart=always wnameless/oracle-xe-11g</p></li></ul><h3 id="ETC"><a href="#ETC" class="headerlink" title="ETC"></a>ETC</h3><ul><li>tablespace란<ul><li><a href="http://12bme.tistory.com/249" target="_blank" rel="external nofollow noopener noreferrer">http://12bme.tistory.com/249</a></li><li><a href="http://www.gurubee.net/lecture/1094" target="_blank" rel="external nofollow noopener noreferrer">http://www.gurubee.net/lecture/1094</a></li></ul></li></ul><h4 id><a href="#" class="headerlink" title></a></h4></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/11/28/setting_oracle/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Gradle!</title>
      <link>http://ddongeee.github.io/2019/10/30/gradle/</link>
      <guid>http://ddongeee.github.io/2019/10/30/gradle/</guid>
      <pubDate>Wed, 30 Oct 2019 14:46:48 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;Dependency-configurations&quot;&gt;&lt;a href=&quot;#Dependency-configurations&quot; class=&quot;headerlink&quot; title=&quot;Dependency config
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="Dependency-configurations"><a href="#Dependency-configurations" class="headerlink" title="Dependency configurations"></a>Dependency configurations</h1><ul><li>api vs implemetation<ul><li><a href="https://medium.com/mindorks/implementation-vs-api-in-gradle-3-0-494c817a6fa" target="_blank" rel="external nofollow noopener noreferrer">https://medium.com/mindorks/implementation-vs-api-in-gradle-3-0-494c817a6fa</a></li><li><a href="https://developer.android.com/studio/build/gradle-plugin-3-0-0-migration.html?hl=ko" target="_blank" rel="external nofollow noopener noreferrer">https://developer.android.com/studio/build/gradle-plugin-3-0-0-migration.html?hl=ko</a></li><li>api : 특정 모듈에서 변경이 발생하였을때, 변경 발생 모듈로 부터 연관된 하이라키의 가장 마지막 모듈까지 모두 빌드</li><li>implemetation : 하이라키에서 direct로 연관되어 있는 모듈만 리빌드</li><li>위 2개를 통해 빌드 및 접근 제한도 할수 잇는것 같음! 테스트 해보기</li></ul></li><li>compileOnly</li><li>runtimeOnly</li><li>annotationProcessor</li></ul><h1 id="Comands"><a href="#Comands" class="headerlink" title="Comands"></a>Comands</h1><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./gradlew app:dependencies</span><br><span class="line">./gradlew app:dependencies --dependency modulename</span><br><span class="line">./gradlew app:dependencies --configuration compile</span><br></pre></td></tr></tbody></table></figure></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/10/30/gradle/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Docker</title>
      <link>http://ddongeee.github.io/2019/08/25/docker/</link>
      <guid>http://ddongeee.github.io/2019/08/25/docker/</guid>
      <pubDate>Sun, 25 Aug 2019 14:46:03 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;What-is-Docker&quot;&gt;&lt;a href=&quot;#What-is-Docker&quot; class=&quot;headerlink&quot; title=&quot;What is Docker?&quot;&gt;&lt;/a&gt;What is Docker?&lt;/h
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="What-is-Docker"><a href="#What-is-Docker" class="headerlink" title="What is Docker?"></a>What is Docker?</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><ul><li>쉽게 배포 패키징, 대규모 환경에서 배포, 빠르고 심플하게 작업절차를 구성</li><li>원자적(automic)이면서 쉽게 쓰고 버릴 수 있는 컨테이너 개념</li><li>모든 상태가 직접 배포 결과물에 포함. 수정 불가능한 상태 > 애플리케이션 확장에 용이, 더 안정적으로 동작</li><li>장점<ul><li>단일 파일인 Docker image를 통해 소프트웨어 패키징을 간소화</li><li>OS 파일 시스템을 하나의 표준화된 이미지 포맷으로 통합</li><li>모든 시스템과 모든 환경에 대해 정확히 동일한 결과물로 테스트하고 배포하는 데 사용</li><li>자원 낭비 없이 하드웨어로부터 소프트웨어 애플리케이션을 추상화<ul><li>VM들을 관리하는 하이퍼바이저와 각 VM들이 실행 중인 커널은 하드웨어 시스템 자원의 일부를 점유</li><li>컨테이너는 리눅스 커널과 직접 통신하는 또다른 프로세스에 불과</li></ul></li></ul></li><li>단점<ul><li>컨테이너는 호스트와 동일한 커널을 공유한다.</li><li>컨테이너 실행상태를 관리 하지는 않는다.</li><li>배포과정을 완전히 자동화 시켜 주지는 않는다.</li><li>내부적으로 클러스터 개념이 없다.</li></ul></li></ul><h2 id="Preview"><a href="#Preview" class="headerlink" title="Preview"></a>Preview</h2><ul><li>절차단순화<ul><li>개발자와 운영자 사이에 많은 프로세스들을 간소화 시켜 준다.</li><li>역할 분리와 의존성의 캡슐화를 제공</li></ul></li><li>아키텍쳐<ul><li>클라이언트/서버/레지스트리 모델</li><li>컨테이너 네트워킹<ul><li>각각의 도커 컨테이너가 private 네트워크의 호스트 처럼 동작</li></ul></li></ul></li><li>도커 워크플로<ul><li>리비전 제어<ul><li>파일 시스템 계층</li><li>이미지태그</li></ul></li><li>빌드</li><li>테스팅</li><li>패키징</li><li>배포</li></ul></li></ul><h2 id="Terms"><a href="#Terms" class="headerlink" title="Terms"></a>Terms</h2><ul><li>Volume<ul><li>container 변경사항을 UnionFS 를 통해 관리</li><li>UnionFS 는 image layer 와 write layer(휘발성) 둘다관리</li><li>목적 : write layer 데이터를 그나마. <strong>비휘발성인 host 저장</strong>하거나, <strong>컨테이너 사이 데이터 공유</strong></li><li>host 와 container 가 동기화 됨으로, 양방향 으로 모든 액션(생성,수정,삭제)가 동기화됨</li><li>$ docker run -it -v (호스트 디렉토리):(컨테이너의 volume 디렉토리) (이미지) /bin/bash</li><li>다양한 응용의 고찰 : <a href="https://darkrasid.github.io/docker/container/volume/2017/05/10/docker-volumes.html" target="_blank" rel="external nofollow noopener noreferrer">https://darkrasid.github.io/docker/container/volume/2017/05/10/docker-volumes.html</a></li><li></li></ul></li></ul><h1 id="Client-Images-Containers"><a href="#Client-Images-Containers" class="headerlink" title="Client, Images, Containers"></a>Client, Images, Containers</h1><h2 id="Containers"><a href="#Containers" class="headerlink" title="Containers"></a>Containers</h2><ul><li>컨테이너는 호스트 시스템의 커널을 공유하며 (선택에 의해) 다른 컨테이너로부터 독립적이고 완비된 실행환경<ul><li>전체 OS 환경이 필요하지 않음</li><li>커널공유 : 독립적인 작업과 하위의 실제 하드웨어 사이에 간접적인 계층이 하나 줄어든다.</li><li><strong>그러나!</strong> 하부의 커널과 호환되는 프로세스만 실행될수 있다!</li></ul></li></ul><h2 id="Command-Tools"><a href="#Command-Tools" class="headerlink" title="Command Tools"></a>Command Tools</h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">$ docker version</span><br><span class="line">$ docker info</span><br><span class="line">$ docker images</span><br><span class="line">$ docker inspect {{containerId|containerName}}</span><br><span class="line">$ docker -it {{containerId|containerName}}</span><br><span class="line">$ docker system prune <span class="hljs-comment"># docker stop된 컨테이너 모두 삭제 delete</span></span><br><span class="line"><span class="hljs-comment"># $ nsenter</span></span><br><span class="line">$ docker volume ls</span><br><span class="line">$ docker volume inspect {{volumeId}}</span><br><span class="line">$ docker volume prune <span class="hljs-comment"># docker volume 모두 삭제(delete all)</span></span><br><span class="line"><span class="hljs-comment"># 컨테이너 접근 어려울때 아래로 확인 가능하다.</span></span><br><span class="line">$ sudo ls -al /var/lib/docker/containers/{{containerFullId}}</span><br><span class="line">$ docker logs {{containerId|containerName}}  <span class="hljs-comment"># docker logs -f {{containerId}}</span></span><br><span class="line">$ docker stats {{containerId}} <span class="hljs-comment"># docker stats</span></span><br><span class="line"><span class="hljs-comment"># 인증 먼저 해야함..</span></span><br><span class="line">$ curl -s http://localhost:2375/v1/containers/{{containerId}}/stats</span><br><span class="line">$ curl -s http://localhost:2375/v1/containers/{{containerId}}/stats | head -1 | python -m json.tool</span><br><span class="line">$ docker events <span class="hljs-comment"># --since 혹은 --until 옵션으로 추가 제어 가능</span></span><br><span class="line"><span class="hljs-comment">#### cAdvisor 라고, 구글 사내에서 쓰는 그래프용 모니터링 툴을 docker로 띄울수도 있다. 참고</span></span><br><span class="line">$ docker top {{containerId}}</span><br><span class="line">$ docker <span class="hljs-built_in">history</span> {{imageId}}</span><br><span class="line">$ sudo docker diff {{containerId}}</span><br><span class="line"><span class="hljs-comment"># 도커컨테이너 내부로 들어가기</span></span><br><span class="line">$ docker <span class="hljs-built_in">exec</span> -it {{container_id | container_name}} /bin/bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 도커 실행 관련</span></span><br><span class="line"><span class="hljs-comment"># docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARGS...]</span></span><br><span class="line"><span class="hljs-comment"># 우분투 실행</span></span><br><span class="line"><span class="hljs-comment"># -t 혹은 (--tag) </span></span><br><span class="line">$ docker run -d -t ubuntu /bin/bash</span><br><span class="line">$ docker build -t {{name}}:{{version}} .</span><br><span class="line">$ docker login && docker push {{tagName1}}/{{tabName2}}</span><br><span class="line">$ docker rm {{containerId}}</span><br><span class="line">$ docker rmi {{imageId}},{{imageId}}, ...</span><br><span class="line"><span class="hljs-comment"># 도커 이미지 다운로드</span></span><br><span class="line"><span class="hljs-comment"># docker pull [OPTIONS] NAME[:TAG|@DIGEST]</span></span><br><span class="line"><span class="hljs-comment"># tag 지정하지 않으면 최신버전으로 다운로드</span></span><br><span class="line">$ docker pull mysql</span><br><span class="line"><span class="hljs-comment"># 레디스 실행</span></span><br><span class="line"><span class="hljs-comment"># -d (백그라운드로), -p (로컬포트 4321를 도커 컨테이너 6379에 연결)</span></span><br><span class="line">$ docker run -d -p 4321:6379 redis</span><br><span class="line"><span class="hljs-comment"># 도커 컨테이너 중지</span></span><br><span class="line">$ docker stop {{docker_container_id}}</span><br><span class="line"><span class="hljs-comment"># 중지된 컨테이너 일괄삭제</span></span><br><span class="line">$ docker rm -v $(docker ps -a -q -f status=exited)</span><br><span class="line"><span class="hljs-comment"># 컨테이너 볼륨 마운트</span></span><br><span class="line">$ docker run -d -p 3306:3306 \</span><br><span class="line">-e MYSQL_ALLOW_EMPTY_PASSWORD=<span class="hljs-literal">true</span> \</span><br><span class="line">--name mysql</span><br><span class="line">-v /my/own/dir:/var/lib/mysql</span><br><span class="line">mysql:5.7</span><br></pre></td></tr></tbody></table></figure><h1 id="Productionize-Debuging-flow"><a href="#Productionize-Debuging-flow" class="headerlink" title="Productionize, Debuging flow"></a>Productionize, Debuging flow</h1><h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><ul><li>오케스트레이션</li><li>분산 스케줄러(Distributed scheduler) :: 쿠버네티스 참고<ul><li>다중 서버 노드를 단일 컴퓨터로 묶어주는 수단.</li><li>메소스와 같은 도구들은 개별 서버들과 전체 데이터 센터를 거대한 자원 풀로 추상화 하여 컨테이너 기반 작업을 수행.</li></ul></li></ul><h1 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h1><h1 id="Enhancedment"><a href="#Enhancedment" class="headerlink" title="Enhancedment"></a>Enhancedment</h1><ul><li>컨테이너를 구성하는 매커니즘<ul><li>cgroup : 자원제한<ul><li>메모리 스왑 CPU 등의 한도를 제어하는데 사용</li><li>작업들과 그 미래의 자식들을 포함하여 특화된 종작과 연관된 그룹들로 계층화 하기 위해서 통합/분할하는 매커니즘</li></ul></li><li>namespace : 프로세스 구분, 시스템과 독립된 시점을 제공<ul><li>single global resource를 컨테이너에 속한 single global resource 로 보이게 만들어 준다.</li><li>마운트, UTS, IPC, PID, 네트워크, 사용자 네임스페이스</li><li>파일 시스템, 네트워크 인터페이스, 디스크, 등등</li><li></li></ul></li><li>SE리눅스/앱아머 : 강한 보안 고립화 제공</li></ul></li><li></li></ul><h1 id="Core-concept"><a href="#Core-concept" class="headerlink" title="Core concept"></a>Core concept</h1><h1 id="docker-compose-사용하기"><a href="#docker-compose-사용하기" class="headerlink" title="docker-compose 사용하기"></a>docker-compose 사용하기</h1><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># docker-compose 설치</span></span><br><span class="line">$ curl -L <span class="hljs-string">"https://github.com/docker/compose/releases/download/1.9.0/docker-compose-<span class="hljs-variable">$(uname -s)</span>-<span class="hljs-variable">$(uname -m)</span>"</span> -o /usr/<span class="hljs-built_in">local</span>/bin/docker-compose</span><br><span class="line">$ chmod +x /usr/<span class="hljs-built_in">local</span>/bin/docker-compose</span><br><span class="line"><span class="hljs-comment"># test 해보기</span></span><br><span class="line">$ docker-compose version</span><br></pre></td></tr></tbody></table></figure><h5 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h5><figure class="highlight yaml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># yaml 파일</span></span><br><span class="line"><span class="hljs-attr">app:</span></span><br><span class="line"><span class="hljs-attr">image:</span> <span class="hljs-string">{{image-name</span> <span class="hljs-string">|</span> <span class="hljs-string">image-url}}</span></span><br><span class="line"><span class="hljs-attr">ports:</span> </span><br><span class="line"><span class="hljs-bullet">-</span> <span class="hljs-number">10001</span><span class="hljs-string">:10001</span></span><br><span class="line"><span class="hljs-bullet">-</span> <span class="hljs-number">11619</span><span class="hljs-string">:11619</span></span><br><span class="line">    <span class="hljs-attr">environment:</span></span><br><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-string">JVM_OPTIONS=-Xms4g</span> <span class="hljs-string">-Xmx25g</span> <span class="hljs-string">-XX:+UseG1GC</span></span><br><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILE=production</span></span><br><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-string">CMDB_OPTS=-Dcmdb.role={{role}}</span> <span class="hljs-string">-Dfile.encoding=UTF-8</span></span><br><span class="line">    <span class="hljs-attr">volumes:</span></span><br><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-string">/local/dir/logs:/container/dir/logs</span></span><br></pre></td></tr></tbody></table></figure><p>docker options</p><figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://pyrasis.com/book/DockerForTheReallyImpatient/Chapter20/28 여기에 잘설명</span><br></pre></td></tr></tbody></table></figure><h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><p>docker lifeCycle 관련 : <a href="https://medium.com/@nagarwal/lifecycle-of-docker-container-d2da9f85959" target="_blank" rel="external nofollow noopener noreferrer">https://medium.com/@nagarwal/lifecycle-of-docker-container-d2da9f85959</a></p><p>Docker(container)의 작동 원리: namespaces and cgroups : <a href="https://tech.ssut.me/what-even-is-a-container/" target="_blank" rel="external nofollow noopener noreferrer">https://tech.ssut.me/what-even-is-a-container/</a></p></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/08/25/docker/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Kafka</title>
      <link>http://ddongeee.github.io/2019/08/06/kafka/</link>
      <guid>http://ddongeee.github.io/2019/08/06/kafka/</guid>
      <pubDate>Mon, 05 Aug 2019 15:07:19 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;정의&quot;&gt;&lt;a href=&quot;#정의&quot; class=&quot;headerlink&quot; title=&quot;정의&quot;&gt;&lt;/a&gt;정의&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;링크드인 에서 개발된 ‘분산 메시징 시스템’&lt;/li&gt;
&lt;li&gt;대용량 실
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="정의"><a href="#정의" class="headerlink" title="정의"></a>정의</h1><ul><li>링크드인 에서 개발된 ‘분산 메시징 시스템’</li><li>대용량 실시간 로그 처리에 특화되어 있음. TPS 높음</li></ul><h1 id="vs-기존-메시징-시스템"><a href="#vs-기존-메시징-시스템" class="headerlink" title="vs 기존 메시징 시스템"></a>vs 기존 메시징 시스템</h1><ul><li>TPS 가 보다 뛰어나다. 성능이 아주 좋다.</li><li>분산 및 복제 구성을 보다 쉽게 사용할수 있다.</li><li>TCP 기반의 프로토콜을 사용하여, 프로토콜에 의한 오버헤드가 감소했다.</li><li>Producer 에서 batch 형태로 Publish 가능하여, TCP/IP 라운드트립 횟수를 줄일수 있다. (좀더 빠르다?!)</li><li>메시지를 메모리가 아닌 <strong>‘파일시스템’</strong>에 저장한다.<ul><li>자동으로 영속성(durability) 보장.</li><li>메시지가 누적되어도 성능 감소 영향 없음.</li><li>실시간 처리 뿐만 아니라, 주기적 batch 작업을 위한 데이터 저장용도로도 사용가능.</li></ul></li><li>Consumer는 pulling 방식으로 동작하여 최고의 퍼포먼스를 발휘할수 있다.</li><li>처리해야 하는 메시지에 대한 메타 정보를 Consumer가  트래킹 하고 있어서, Broker의 관리 부담이 줄어들었다.</li></ul><h1 id="구현기술"><a href="#구현기술" class="headerlink" title="구현기술"></a>구현기술</h1><ul><li>Pub/Sub 모델로 동작하며, Producer, Broker, Consumer로 구성되어 있다.</li><li>Topic 이라는 개념으로 메시지를 관리한다. </li><li>실제 메시지는 Topic을 <strong>‘Partition’</strong>이란 단위로 나눠서 메시지큐에 저장하고 사용된다.<ul><li>Partition 들은 클러스터의 각 노드에 분산 저장된다.</li><li>고가용성을 위한 복제(replication) 설정시에 복제된 Partition 도 분산 저장되며, 장애 발생시 Partition 단위로 Fail over가 수행된다.</li><li>Partition 에선 Message 에게 Offset 이라는 unique 한 ID를 부여하고, 이를 식별자로 사용한다.<ul><li>Offset은 Partition 마다 관리됨으로, 특정 메시지를 찾을땐, <strong>‘partition 번호 + offset 값’</strong> 으로 찾아야 한다.</li></ul></li><li>Topic으로 들어온 메시지는 기본적으로 라운드로빈 방식으로 Partition에 분배된다.</li><li>Replication factor 값 설정을 통해 복제 설정을 할수 있다. <ul><li>ex) replication factor 3으로 설정시, 똑같은 파티션이 3개의 노드에 존재하게 된다.</li><li></li></ul></li></ul></li><li>확장성(scale-out)과 고가용성(High availability)을 위해 Broker들이 클러스터로 동작한다.<ul><li>사실은 Zookeeper 가 클러스터 관리한다?!</li></ul></li><li></li><li>커밋과 오프셋<ul><li>자동커밋과 수동커밋</li></ul></li></ul><h1 id="주요개념"><a href="#주요개념" class="headerlink" title="주요개념"></a>주요개념</h1><h1 id="순서"><a href="#순서" class="headerlink" title="순서"></a>순서</h1><h1 id="사용"><a href="#사용" class="headerlink" title="사용"></a>사용</h1><h1 id="Kafka-cli-사용"><a href="#Kafka-cli-사용" class="headerlink" title="Kafka cli 사용"></a>Kafka cli 사용</h1><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># 선행조건</span></span><br><span class="line"><span class="hljs-comment"># 1. https://kafka.apache.org/downloads 에서 카프카 다운로드</span></span><br><span class="line"><span class="hljs-comment"># 2. 압축해제후 해당 디렉토리를 .bashrc 혹은 .zshrc에 전역 변수로 등록</span></span><br><span class="line"><span class="hljs-comment"># ex) export KAFKA_HOME=~/Development/supports/kafka_2.11-2.0.0</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Run Zookeeper for Kafka</span></span><br><span class="line"><span class="hljs-variable">$KAFKA_HOME</span>/bin/zookeeper-server-start.sh <span class="hljs-variable">$KAFKA_HOME</span>/config/zookeeper.properties</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Run Kafka Server</span></span><br><span class="line"><span class="hljs-variable">$KAFKA_HOME</span>/bin/kafka-server-start.sh <span class="hljs-variable">$KAFKA_HOME</span>/config/server.properties</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Create Kafka Topic</span></span><br><span class="line"><span class="hljs-variable">$KAFKA_HOME</span>/bin/kafka-topics.sh --create \</span><br><span class="line">  --zookeeper localhost:2181 \</span><br><span class="line">  --replication-factor 1 --partitions 13 \</span><br><span class="line">  --topic my-topic</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># List Topics</span></span><br><span class="line"><span class="hljs-variable">$KAFKA_HOME</span>/bin/kafka-topics.sh --list \</span><br><span class="line">    --zookeeper localhost:2181</span><br><span class="line">    </span><br><span class="line"><span class="hljs-comment"># Run Kafka Producer Console</span></span><br><span class="line"><span class="hljs-variable">$KAFKA_HOME</span>/bin/kafka-console-producer.sh \</span><br><span class="line">    --broker-list localhost:9092 \</span><br><span class="line">    --topic my-topic</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Run Kafka Consumer Console</span></span><br><span class="line"><span class="hljs-comment"># Order is only guaranteed within a partition.</span></span><br><span class="line"><span class="hljs-variable">$KAFKA_HOME</span>/bin/kafka-console-consumer.sh \</span><br><span class="line">    --bootstrap-server localhost:9092 \</span><br><span class="line">    --topic my-topic \</span><br><span class="line">    --from-beginning</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Run Consumer with consumer group id</span></span><br><span class="line">kafka/bin/kafka-console-consumer.sh \</span><br><span class="line">    --bootstrap-server localhost:9092 \</span><br><span class="line">    --topic my-topic \</span><br><span class="line">    --consumer-property group.id=mygroup</span><br><span class="line">    </span><br><span class="line"><span class="hljs-comment"># Topology of Kafka Topic Partition Ownership  </span></span><br><span class="line"><span class="hljs-comment"># to see how the Kafka topic is laid out among the Kafka brokers. </span></span><br><span class="line"><span class="hljs-comment"># The ---describe will show partitions, ISRs:in-sync replicas, and broker partition leadership.)</span></span><br><span class="line"><span class="hljs-variable">$KAFKA_HOME</span>/bin/kafka-topics.sh --describe \</span><br><span class="line">    --topic ap.pushtriggerevent.1 \</span><br><span class="line">    --zookeeper localhost:2181</span><br></pre></td></tr></tbody></table></figure><h1 id="정리"><a href="#정리" class="headerlink" title="정리"></a>정리</h1><p>Computing architecture trend</p><p>Loosely coupled computing architecture(Not strongly coupled)</p><p>Not persistent every thing, Can be auto-scale in/out</p><p>So result, Asynchronous Messaging freamwork. like kafka, akka</p><p>Reference</p><ul><li><a href="http://cloudurable.com/blog/kafka-tutorial-kafka-from-command-line/index.html" target="_blank" rel="external nofollow noopener noreferrer">http://cloudurable.com/blog/kafka-tutorial-kafka-from-command-line/index.html</a></li><li><a href="https://epicdevs.com/17" target="_blank" rel="external nofollow noopener noreferrer">https://epicdevs.com/17</a></li><li><a href="https://taetaetae.github.io/2017/11/02/what-is-kafka/" target="_blank" rel="external nofollow noopener noreferrer">https://taetaetae.github.io/2017/11/02/what-is-kafka/</a></li><li><a href="https://getto215.github.io/kafka-architecture-2/" target="_blank" rel="external nofollow noopener noreferrer">https://getto215.github.io/kafka-architecture-2/</a></li><li><a href="https://medium.com/@umanking/카프카에-대해서-이야기-하기전에-먼저-data에-대해서-이야기해보자-d2e3ca2f3c2" target="_blank" rel="external nofollow noopener noreferrer">https://medium.com/@umanking/%EC%B9%B4%ED%94%84%EC%B9%B4%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C-%EC%9D%B4%EC%95%BC%EA%B8%B0-%ED%95%98%EA%B8%B0%EC%A0%84%EC%97%90-%EB%A8%BC%EC%A0%80-data%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C-%EC%9D%B4%EC%95%BC%EA%B8%B0%ED%95%B4%EB%B3%B4%EC%9E%90-d2e3ca2f3c2</a></li><li><a href="https://www.popit.kr/kafka-운영자가-말하는-처음-접하는-kafka/" target="_blank" rel="external nofollow noopener noreferrer">https://www.popit.kr/kafka-%EC%9A%B4%EC%98%81%EC%9E%90%EA%B0%80-%EB%A7%90%ED%95%98%EB%8A%94-%EC%B2%98%EC%9D%8C-%EC%A0%91%ED%95%98%EB%8A%94-kafka/</a></li><li><a href="https://coding-start.tistory.com/133" target="_blank" rel="external nofollow noopener noreferrer">https://coding-start.tistory.com/133</a></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/08/06/kafka/#disqus_thread</comments>
    </item>
    
    <item>
      <title>future &amp; java</title>
      <link>http://ddongeee.github.io/2019/07/11/java/</link>
      <guid>http://ddongeee.github.io/2019/07/11/java/</guid>
      <pubDate>Wed, 10 Jul 2019 15:00:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;Future-vs-CompleteableFuture&quot;&gt;&lt;a href=&quot;#Future-vs-CompleteableFuture&quot; class=&quot;headerlink&quot; title=&quot;Future vs C
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="Future-vs-CompleteableFuture"><a href="#Future-vs-CompleteableFuture" class="headerlink" title="Future vs CompleteableFuture"></a>Future vs CompleteableFuture</h1><h2 id="Future"><a href="#Future" class="headerlink" title="Future"></a>Future</h2><ul><li>java7 에서 제공하는 인터페이스</li><li>비동기 프로세스 수행할수 있게 해줌</li><li>비동기 프로세스 종료확인하는 isDone(), 타임아웃 제공하고 결과 출력하는 get() 메소드 제공</li><li>간단하기는 하나 제공되는 기능이 별로 없음</li></ul><h2 id="CompeteableFuture"><a href="#CompeteableFuture" class="headerlink" title="CompeteableFuture"></a>CompeteableFuture</h2><ul><li>java8 에서 제공하는 클래스</li><li>Future 구현?! 클래스 간에 여러 의존성에 대한 관리를 쉽게 할수 있음</li><li>Stream API 나 Optional 와 같은 람다 표현식과 파이프라인을 사용하여 비동기 작업을 조합할수 있다.</li></ul><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://doohyun.tistory.com/52" target="_blank" rel="external nofollow noopener noreferrer">https://doohyun.tistory.com/52</a></li><li>[아직안봄] <a href="https://medium.com/@chanhyeonglee/completable-future-가이드-파트2-eb82768f095d" target="_blank" rel="external nofollow noopener noreferrer">https://medium.com/@chanhyeonglee/completable-future-%EA%B0%80%EC%9D%B4%EB%93%9C-%ED%8C%8C%ED%8A%B82-eb82768f095d</a></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/07/11/java/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Python&#39;s infra</title>
      <link>http://ddongeee.github.io/2019/07/11/python-infra/</link>
      <guid>http://ddongeee.github.io/2019/07/11/python-infra/</guid>
      <pubDate>Wed, 10 Jul 2019 15:00:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h3 id=&quot;Class&quot;&gt;&lt;a href=&quot;#Class&quot; class=&quot;headerlink&quot; title=&quot;Class&quot;&gt;&lt;/a&gt;Class&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;인스턴스라는 말은 특정 객체 (a)가 어떤 
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h3 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h3><ul><li><p>인스턴스라는 말은 특정 객체 (a)가 어떤 클래스(A) 의 객체인지를 관계 위주로 설명할때 사용</p><ul><li>‘a는 인스턴스’ 모다는 ‘a는 객체’라는 표현이 어울리며, ‘a 는 A의 객체’ 보다는 ‘a는 A의 인스턴스’라는 표현이 어울린다.</li><li>type(a) 는 a객체가 어떤 타입인지 return 한다.</li><li>id(a) 는 a객체의 주소를 return 한다.</li></ul></li><li><p>pass 는 아무것도 사용하지 않는 문법으로, 임시로 코드를 작성할때 주로 사용된다.</p></li><li><p>Constructor & Method</p><ul><li><p>아래와 같이 선언</p><figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SomeParent</span>:</span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, first, second)</span>:</span></span><br><span class="line">    self.first = first</span><br><span class="line">    self.second = second</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setData</span><span class="hljs-params">(self, first, second)</span>:</span></span><br><span class="line">self.first = first</span><br><span class="line">self.second = second</span><br></pre></td></tr></tbody></table></figure></li><li><p>파이썬에서는 메서드의 첫번째 매개변수로 ‘self’를 사용한다. 객체를 호출할때 호출객체 자신이 전달되기 때문이다.</p></li></ul></li><li><p>Inheritance </p><ul><li><pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">SomeChild</span><span class="params">(SomeParent)</span>:</span>  classVariable = <span class="string">"hello"</span>  <span class="function"><span class="keyword">def</span> <span class="title">pow</span><span class="params">(self)</span>:</span>    <span class="keyword">return</span> self.first ** self.second<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - Method overriding 도 가능하다.</span><br><span class="line"></span><br><span class="line">  - classVariable 의 경우 클래스 변수이다.</span><br><span class="line"></span><br><span class="line">- Lambda</span><br><span class="line"></span><br><span class="line">  - ```python</span><br><span class="line">    >>> add = lambda a,b: a+b</span><br><span class="line">    >>> result = add(3,4)</span><br><span class="line">    >>> print(result)</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><p>위와 같이 람다를 사용할수 있다.</p></li></ul></li></ul><h3 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h3><ul><li><p>Library.</p></li><li><p>함수나 변수 또는 클래스를 모아놓은 파일.</p></li><li><p>사용용도를 기준으로 파일을 나누어, 필요할때 해당 코드를 Import 하여 사용하기 위한 기준? 단위</p></li><li><p>포함하려는 파일이 같은 디렉토리에 있어야 한다.</p></li><li><p>import ‘moduleName’ 으로 사용한다. ‘.py’는 입력하지 않아도 된다.</p><ul><li>함수를 파일명 없이 바로 사용하고 싶다면, ‘from 모듈이름 import 모듈함수, 모듈함수, …’ 와 같이 사용할수 있다.</li><li>‘from 모듈이름 import *’ 은 ‘모듈이름’ 에 포함된 모든 함수를 사용한다는 뜻</li></ul></li><li><pre><code class="python"><span class="comment"># __name__ 변수는 파이썬이 내부적으로 사용하는 변수 이름이다. '특정.py'을 직접 실행할 경우, 해당 특정.py 내부의 __name__ 변수에는 __main__ 값이 저장된다. 하지만 파이썬 셸이나 다른 파이썬 모듈에서 import 특정 일경우, __name__ 안에는 __특정__ 이 저장되어 있다.</span><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:    <span class="keyword">print</span> (<span class="string">"Hello"</span>)<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 모듈이 있는 디렉토리로 이동하지 않고 아래의 방법을 사용하여 어디서든 모듈을 불러와 사용할두 있다.</span><br><span class="line"></span><br><span class="line">  - ```python</span><br><span class="line">    $ python</span><br><span class="line">    >>> import sys</span><br><span class="line">    >>> sys.path</span><br><span class="line">    >>> sys.path.append("/User/crayon/..")</span><br><span class="line">    </span><br><span class="line">    # 혹은</span><br><span class="line">    </span><br><span class="line">    $ set PYTHONPATH=/User/crayon</span><br><span class="line">    $ python </span><br><span class="line">    >>> import someParent</span><br><span class="line">    >>> ~~</span><br></pre></td></tr></tbody></table></figure></code></pre></li></ul><h3 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h3><ul><li><p>dot(.) 를 사용하여 파이썬 모듈을 계층적(디렉토리 구조)으로 관리할수 있게 해준다.</p></li><li><p>파이썬 패키지는 디렉토리와 파이썬 모듈로 이뤄져 있다.</p></li><li><pre><code class="python"><span class="comment"># 패키지 않의 함수 실행 방법</span><span class="comment"># 1.</span><span class="meta">>>> </span><span class="keyword">import</span> game.sound.echo<span class="meta">>>> </span>game.sound.echo.echo_test()<span class="comment"># 2.</span><span class="meta">>>> </span><span class="keyword">from</span> game.sound <span class="keyword">import</span> echo<span class="meta">>>> </span>echo.echo_test()<span class="comment"># 3.</span><span class="meta">>>> </span><span class="keyword">from</span> game.sound.echo <span class="keyword">import</span> echo_test<span class="meta">>>> </span>echo_test()<span class="comment"># 4. 아래와 같이 사용하려면, 특정 위치의 __init__.py에 아래와 같이 선언되어야 한다.</span><span class="comment"># /User/crayon/game/sound/__init__.py</span><span class="comment"># __all__ = ['echo']</span><span class="meta">>>> </span><span class="keyword">from</span> game.sound <span class="keyword">import</span> *<span class="meta">>>> </span>echo.echo_test()<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- relative 패키지</span><br><span class="line"></span><br><span class="line">  - . 혹은 .. 으로 선언하는거 같다.</span><br><span class="line"></span><br><span class="line">### PyPI</span><br><span class="line"></span><br><span class="line">- Python Package Index의 줄임말로 파이썬 패키지 저장소</span><br><span class="line"></span><br><span class="line">### pip, pip3</span><br><span class="line"></span><br><span class="line">- Python package management system. 파이썬으로 작성된 패키지 라이브러리를 관리해 주는 시스템</span><br><span class="line"></span><br><span class="line">- python 3.4 이후에는 기본적으로 포함되어 있음</span><br><span class="line"></span><br><span class="line">- pip list 를 통해 현재 local에 설치된 파이썬 패키지 목록을 확인할수 있음</span><br><span class="line"></span><br><span class="line">- 아래를 통해 pip 를 업데이트 할수 있다.</span><br><span class="line"></span><br><span class="line">- ```bash</span><br><span class="line">  # pip update 하기</span><br><span class="line">  $ pip install --upgrade pip</span><br><span class="line">  # python 패키지 설치하기</span><br><span class="line">  $ pip install numpy</span><br><span class="line">  # 특정버전 설치</span><br><span class="line">  $ pip install numpy == 1.0.0</span><br><span class="line">  # 패키지 버전 업그레이드</span><br><span class="line">  $ pip install --upgrade numpy</span><br><span class="line">  # python 패키지 제거하기</span><br><span class="line">  $ pip uninstall numpy</span><br></pre></td></tr></tbody></table></figure></code></pre></li></ul><h3 id="Virtaul-env"><a href="#Virtaul-env" class="headerlink" title="Virtaul env"></a>Virtaul env</h3><ul><li>virtualenv is a tool to create isolated Python environments.</li></ul><p>pyenv, pyenv-virtualenv setting</p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ brew install pyenv</span><br><span class="line">$ brew install pyenv-virtualenv</span><br><span class="line">$ brew install readline xz</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">################################## write one .zshrc ##################################</span></span><br><span class="line"><span class="hljs-built_in">export</span> PYENV_ROOT=<span class="hljs-variable">$HOME</span>/.pyenv</span><br><span class="line"><span class="hljs-keyword">if</span> <span class="hljs-built_in">which</span> pyenv > /dev/null; <span class="hljs-keyword">then</span> <span class="hljs-built_in">eval</span> <span class="hljs-string">"<span class="hljs-variable">$(pyenv init -)</span>"</span>; <span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-keyword">if</span> <span class="hljs-built_in">which</span> pyenv-virtualenv-init > /dev/null; <span class="hljs-keyword">then</span> <span class="hljs-built_in">eval</span> <span class="hljs-string">"<span class="hljs-variable">$(pyenv virtualenv-init -)</span>"</span>; <span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-comment">######################################################################################</span></span><br><span class="line"></span><br><span class="line">$ pyenv install --list</span><br><span class="line">$ pyenv install 3.7.4</span><br><span class="line">$ pyenv uninstall 3.7.4</span><br><span class="line">$ pyenv global 3.7.4</span><br><span class="line">$ pyenv versions</span><br><span class="line">$ pyenv <span class="hljs-built_in">local</span></span><br><span class="line">$ pyenv <span class="hljs-built_in">which</span> python</span><br><span class="line"></span><br><span class="line">$ pyenv virtualenv 3.7.4 sample-env</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">## Apply env on directory</span></span><br><span class="line">$ <span class="hljs-built_in">cd</span> some_dicrector</span><br><span class="line">$ pyenv <span class="hljs-built_in">local</span> sample-env</span><br><span class="line">$ pyenv <span class="hljs-built_in">local</span></span><br><span class="line">$ pip list</span><br></pre></td></tr></tbody></table></figure><p>참고</p><ul><li><a href="https://book.coalastudy.com/python-basic/" target="_blank" rel="external nofollow noopener noreferrer">https://book.coalastudy.com/python-basic/</a></li><li><a href="https://wikidocs.net/29" target="_blank" rel="external nofollow noopener noreferrer">https://wikidocs.net/29</a></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/07/11/python-infra/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Akka &amp; k8s</title>
      <link>http://ddongeee.github.io/2019/07/07/akka-k8s/</link>
      <guid>http://ddongeee.github.io/2019/07/07/akka-k8s/</guid>
      <pubDate>Sat, 06 Jul 2019 15:00:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;한것들&quot;&gt;&lt;a href=&quot;#한것들&quot; class=&quot;headerlink&quot; title=&quot;한것들&quot;&gt;&lt;/a&gt;한것들&lt;/h1&gt;&lt;h2 id=&quot;Spring-boot-application-을-jar-로-만들기&quot;
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="한것들"><a href="#한것들" class="headerlink" title="한것들"></a>한것들</h1><h2 id="Spring-boot-application-을-jar-로-만들기"><a href="#Spring-boot-application-을-jar-로-만들기" class="headerlink" title="Spring boot application 을 jar 로 만들기"></a>Spring boot application 을 jar 로 만들기</h2><figure class="highlight groovy hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// build.gradle에 아래 선언후 bootJar 실행 하면 jar떨어짐</span></span><br><span class="line">apply <span class="hljs-string">plugin:</span> <span class="hljs-string">'io.spring.dependency-management'</span></span><br></pre></td></tr></tbody></table></figure><h2 id="Docker-compose-로-spring-boot-실행하기"><a href="#Docker-compose-로-spring-boot-실행하기" class="headerlink" title="Docker compose 로 spring boot 실행하기"></a>Docker compose 로 spring boot 실행하기</h2><ul><li>Dockerfile 만들기<ul><li>ADD 에서 파일 위치는 ‘Dockerfile 위치를 기준으로 해야함!’</li></ul></li></ul><figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:8-jdk-alpine</span><br><span class="line">ADD /build/libs/springbootapp-1.0-SNAPSHOT.jar app.jar</span><br><span class="line">ENV JAVA_OPTS=""</span><br><span class="line">EXPOSE 8080</span><br></pre></td></tr></tbody></table></figure><ul><li>Docker image Build & Run </li></ul><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker images</span><br><span class="line">$ docker build -t bootapp:0.1</span><br><span class="line">$ docker run -p 8080:8080 bootapp:0.1</span><br></pre></td></tr></tbody></table></figure><ul><li>docker-compose.yml<ul><li>run : docker-compose up -d</li></ul></li></ul><figure class="highlight yaml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attr">app:</span></span><br><span class="line">  <span class="hljs-attr">image:</span> <span class="hljs-string">bootapp:0.1</span></span><br><span class="line">  <span class="hljs-attr">ports:</span></span><br><span class="line">  <span class="hljs-bullet">-</span> <span class="hljs-number">8080</span><span class="hljs-string">:8080</span></span><br><span class="line">  <span class="hljs-attr">command:</span> <span class="hljs-string">java</span> <span class="hljs-string">-jar</span> <span class="hljs-string">/app.jar</span> <span class="hljs-string">>></span> <span class="hljs-string">~/shared/logs/app.out</span> <span class="hljs-number">2</span><span class="hljs-string">>&1</span></span><br><span class="line">  <span class="hljs-attr">volumes:</span></span><br><span class="line">  <span class="hljs-bullet">-</span> <span class="hljs-string">~/shared/logs:~/shared/logs</span></span><br></pre></td></tr></tbody></table></figure><h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ul><li><p><a href="https://medium.com/@sairamkrish/docker-for-spring-boot-gradle-java-micro-service-done-the-right-way-2f46231dbc06" target="_blank" rel="external nofollow noopener noreferrer">https://medium.com/@sairamkrish/docker-for-spring-boot-gradle-java-micro-service-done-the-right-way-2f46231dbc06</a></p></li><li><p>springboot + akka : <a href="http://wiki.webnori.com/display/AKKA/Spring+Boot+With+AKKA" target="_blank" rel="external nofollow noopener noreferrer">http://wiki.webnori.com/display/AKKA/Spring+Boot+With+AKKA</a></p></li><li><p>Clustering Akka in Kubernetes with Statefulset and Deployment</p><ul><li><a href="https://medium.com/google-cloud/clustering-akka-in-kubernetes-with-statefulset-and-deployment-459c0e05f2ea" target="_blank" rel="external nofollow noopener noreferrer">https://medium.com/google-cloud/clustering-akka-in-kubernetes-with-statefulset-and-deployment-459c0e05f2ea</a></li></ul></li><li><p>Akka Cluster On Kubernetes</p><ul><li><a href="http://charithe.github.io/akka-cluster-on-kubernetes.html" target="_blank" rel="external nofollow noopener noreferrer">http://charithe.github.io/akka-cluster-on-kubernetes.html</a></li></ul></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/07/07/akka-k8s/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Apache Airflow</title>
      <link>http://ddongeee.github.io/2019/07/01/apache-airflow/</link>
      <guid>http://ddongeee.github.io/2019/07/01/apache-airflow/</guid>
      <pubDate>Mon, 01 Jul 2019 01:00:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h3 id=&quot;정의&quot;&gt;&lt;a href=&quot;#정의&quot; class=&quot;headerlink&quot; title=&quot;정의&quot;&gt;&lt;/a&gt;정의&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Airflow&lt;/strong&gt; is a platform 
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h3 id="정의"><a href="#정의" class="headerlink" title="정의"></a>정의</h3><ul><li><strong>Airflow</strong> is a platform to programmaticaly author, schedule and monitor workflows or data pipelines<ul><li><strong>Workflow</strong> is<ul><li>a sequence of tasks</li><li>started on a schedule or triggered by an event</li></ul></li></ul></li><li>A traditional ETL <ul><li>Approach<ul><li>Writing a script to pull data from database and send it to HDFS to process.</li><li>Schedule the script as a cronjob.</li></ul></li><li>Problem<ul><li>Failures<ul><li>retry if failure happens (how many times? how often?)</li></ul></li><li>Monitoring<ul><li>success or failure status, how log does the process runs?</li></ul></li><li>Dependencies<ul><li>Data dependencies : upstream data is missing.</li><li>Execution dependencies : job 2 runs after job 1 is finished.</li></ul></li><li>Scalability<ul><li>there is no centralized scheduler between different cron machines.</li></ul></li><li>Deployment<ul><li>deploy new changes constantly</li></ul></li><li>Process historic data<ul><li>backfill/rerun historical data</li></ul></li></ul></li></ul></li><li>A workflow (data-pipeline) management system developed by Airbnb<ul><li>A framework to define tasks & dependencies in python</li><li>Executing, scheduling, distributing tasks accross worker nodes.</li><li>View of present and past runs, logging feature</li><li>Extensible through plugins</li><li>Nice UI, possibility to define REST interface</li><li>Interact well with database</li></ul></li><li>Airflow DAG<ul><li>A workflow as a Directed Acyclic Graph (DAG) with multiple tasks which can be executed independently</li><li>Airflow DAGs are composed of Tasks</li></ul></li><li>What makes Airflow great?<ul><li>Can handle upstream/downstream dependencies gracefully (Example : upstream missing tables)</li><li>Easy to reprocess historical jobs by date, or re-run for specific intervals</li><li>Jobs can pass parameters to other jobs downstream</li><li>Handle errors and failures gracefully. Automatically retry when a task fails.</li><li>Ease of deployment of workflow changes (continuous integration)</li><li>Integrations with a log of infrastructure (Hive, Presto, Druid, AWS, Google cloud, etc)</li><li>Data sensors to trigger a DAG when data arrives</li><li>Job testing through airflow itself</li><li>Accessibility of log files and other meta-data through the web GUI</li><li>Implement trigger rules for tasks</li><li>Monitoring all jobs status in real time + Email alerts</li><li>Community support</li></ul></li><li>Airflow applications<ul><li>Data warehousing : cleanse, organize, data quality check, and publish/stream data into our growing data warehouse</li><li>Machine Learning : automate machine learning workflows</li><li>Growth analytics : compute metrics around guest and host engagement  as well as growth accounting</li><li>Experimentation : compute A/B testing experimentation frameworks logic and aggregates</li><li>Email targeting : apply rules to target and engage users through email campaigns</li><li>Sessionization : compute clickstream and time spent datasets</li><li>Search: compute search ranking related metrics</li><li>Data infrastructure maintenance : database scrapes, floder cleanup, applying data retention policies, …</li></ul></li></ul><p>Running Airflow using Docker</p><ul><li>What is Docker ?<ul><li>Docker is an open platform for developing, shipping, and running applications</li><li>Docker provides the ability to package and run an application in a loosely isolated environment called a container. The isolation and security allow you to run many containers simultaneously on a given host, regardless of its operating system: Mac, Windows, PC, cloud, data center, …</li><li>Containers are lightweight because they don’t need the extra load of a hypervisor, but run directly within the host machine’s kernel. This means you can run more containers on a given hardware combination than if you were using virtual machines.</li></ul></li><li>Benefits of using Docker<ul><li>Docker is freeing us from the task of manaing, maintening all of the Airflow dependencies, and deployment.</li><li>Easy to share and deploy different versions and environments.</li><li>Keep track through Github tags and releases.</li><li>Ease of deployment from testing to production environment.</li></ul></li><li>Best tutorial<ul><li><a href="https://github.com/tuanavu/airflow-tutorial" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/tuanavu/airflow-tutorial</a></li></ul></li></ul><p>Writing your first workflow</p><p>Steps to write an Airflow DAG</p><ul><li>A DAG file, which is basically just a Python script, is a configuration file specifying the DAG’s structure as code.</li><li>There are only 5 steps you need to remember to write an Airflow DAG or workflow<ul><li>Step 1 : Importing modules</li><li>Step 2 : Define default Arguments</li><li>Step 3 : Instanticate a DAG</li><li>Step 4 : Tasks</li><li>Step 5 : Setting up Dependencies<ul><li>Set the dependencies or the order in which the tasks should be executed in.</li><li>Here’s a few ways you can define dependencies between them:<ul><li>downstream example : t1 >> t2 </li><li>list of tasks can also be set as : t1 >> [t2, t3]</li></ul></li></ul></li></ul></li></ul><p>Recap</p><ul><li>Basically a DAG is just a Python file, which is used to organize tasks and set their execution context. DAGs do not perform any actual computation.</li><li>Instead, tasks are the elements of Airflow that actually “do the work” we want performed. And it is your job to write the configuration and orgaize the tasks in specific orders to create a complete data pipeline.</li></ul><p>Airflow concept</p><ul><li>We will learn about Airflow’s key concept</li></ul><p>Overview </p><ul><li>Airflow is a workflow management system which is used to programmatically author, schedule and monitor workflows</li></ul><p>DAGs</p><ul><li>Workflows are called DAGs (Directed Acyclic Graph).</li><li>A DAG is a collection of alll the tasks you want to run, organized in a way that reflects their relationships and dependencies.</li></ul><p>Understand Directed Acyclic Graph</p><ul><li><p>To understand what is a Directed Acyclic Graph? First, we need to understand the graph data structure. This is a very special data structure in computer science.</p><ul><li>A Graph has 2 main parts:<ul><li>The vertices (nodes) where the data is stored</li><li>The edges (connections) which connect the nodes</li></ul></li></ul></li><li><p>Graphs are used to solve many real-life problems because they are used to represent networks.</p><ul><li>For example: social networks, system of roads, airline flights from city to city, how the Internet is conneted, etc</li></ul></li><li><p>To represent direction in a graph</p><ul><li>Undirected graph: The relationship exists in both directions, the edge has no direction. <ul><li>Example : If Mary was a friend of Francis, Francis would likewise be a friend of Mary.</li></ul></li><li>Directed graph (digraph): Direction matters, since the edges in a graph are all one-way<ul><li>An example graph: the course requirements for a computer science major.</li><li>The class prerequisites graph is clearly a digraph since you must take some classes before others.</li></ul></li><li>Acyclic graph: a graph has no cycles.</li><li>Cyclic graph: a graph has cycles.<ul><li>A cycle in a directed graph is a path that starts and ends at the same node. It has loop.</li></ul></li><li>DAGs Summary <ul><li><strong>Directed Acyclic Graph</strong> is a graph that has <strong>no cycles</strong> and data in each node flows forward in only <strong>one direction</strong>.</li></ul></li></ul></li><li><p>It is useful to represent a complex data flows using a graph.</p><ul><li>Each node in the graph is a task</li><li>The edges represent dependencies amongst tasks.</li><li>These graphs are called computation graphs or data flow graphs and it transform the data as it flow through the graph and enable very complex numberic computations.</li><li>Given that data only needs to be computed once on a given task and the computation then carries forward, the graph is directed and acyclic. This is why Airflow jobs are commonly referred to as “DAGs” (Directed Acyclic Graphs)</li></ul></li><li><p>Beside Airflow, there are other cutting edge big data/data science frameworks is bulit using graph data structure.</p></li><li><p>Tensorflow - An open source machine learning framework</p><ul><li>TensorFlow uses a dataflow graphe to represent your computation in terms of the dependencies between individual operations.</li></ul></li></ul><p>Operators, and Tasks</p><ul><li>DAGs do not perform any actual computation. Instead, Operators determine what actually gets done.</li><li>Task: once an operator is instantiated, it is referred to as a “task”. An operator describes a single task in a workflow.<ul><li>Instantiating a task requires providing a unique task_id and DAG container</li></ul></li><li>A DAG is a container that is used to organize tasks and set their execution context.</li></ul><p>Operators categories</p><ul><li>Typically, Operators are classified inot three categories:<ul><li>Sensors<ul><li>a certain type of operator that will keep running until a certain critera is met. Example include waiting for a certain time, external file, or upstream data source.<ul><li>HdfsSensor: Waits for a file or floder to ladn in HDFS</li><li>NamedHivePartitionSensor: check whether the most recent partition of a Hive table is available for downstream processing</li></ul></li></ul></li><li>Operators<ul><li>triggers a certain action (e.g. run a bash command, execute a python funtion, or exxecute a Hive query, etc)<ul><li>BashOperator: executes a bash command</li><li>PythonOperator: calls an arbitrary Python function</li><li>HiveOpertor: executes hql code or hive script in a specific Hive databases.</li><li>BigQueryOperator: executes Google BigQuery SQL queries in a specific BigQuery database</li></ul></li></ul></li><li>Transfers<ul><li>moves data from one location to another.<ul><li>MySqlToHiveTransfer: Moves data from MySql to Hive</li><li>S3toRedshiftTransfer: load files from s3 to Redshift</li></ul></li></ul></li></ul></li></ul><p>Working with Operators</p><ul><li>Airflow provides prebuilt operators for many common tasks.</li><li>There are more operators being added by the community. You can just go to the Airflow official Github repo, specifically in the airflow / contrib / directory to look for the community added operators</li><li>All operators are derived from BaseOperator and acquire much functionality throgh inheritance. Contributors can extend BaseOperator class to create custom operators as they see fit. </li><li>Go to Github : apache / incubator-airflow / airflow / contrib / operators</li></ul><p>Defining Task Dependencies</p><ul><li>After defining a DAG, and instantiate all the tasks, you can then set the dependencies or the order in which the tasks should be executed in. </li><li>Task dependencies are set using:<ul><li>the set_upstream and set_downstream operators.</li><li>the bitshift operators << and >></li></ul></li></ul><p>DagRuns and TaskInstances</p><ul><li>A key concept in Airflow is the excution_time. The execution times begin at the DAG’s start_date and repeat every schedule_interval.</li><li>For this example the scheduled executin times would be (‘2018-12-01 00:00:00’, ‘2018-12-02 00:00:00’,…). For each execution_time, a DagRun is created an operates under the context of that execution time. A DagRun is simply a DAG that has a specific execution time.</li><li>DagRuns are DAGs that runs at a certain time.</li><li>TaskInstances are the task belongs to that DagRuns.<ul><li>Each DagRun and TaskInstance is associated with an entry in Airflow’s metadata database that logs their state (e.g. “queued”, “running”, “failed”, “skipped”, “up for retry”).</li></ul></li><li>You can check the concept on UI DAG Graph View and UI DAG Tree View<ul><li>What each of the circle is a DagRun at a certain time and a little square boxes are all the test instances belong to that DagRuns </li></ul></li></ul><p>Airflow variables</p><ul><li></li></ul><ul><li>작업의 흐름을 실행, 관리하는 오픈소스 플랫폼</li><li>데이터 처리 파이프라인을 조율 하여, 데이터 중심 워크플로우를 구성할수 있다.</li><li>워크플로우를 하나의 DAG로 정의<ul><li>하나의 DAG는 한개 이상의 작업들(tasks)로 이뤄진다.</li><li>작업간의 의존성 혹은 전후 관계가 생긴다.</li></ul></li></ul><h3 id="vs-타-흐름-관리-도구-like-oozie"><a href="#vs-타-흐름-관리-도구-like-oozie" class="headerlink" title="vs 타 흐름 관리 도구 (like oozie)"></a>vs 타 흐름 관리 도구 (like oozie)</h3><ul><li>flow 정의 : 파이썬 코드로 정의</li><li>확장성 : 새로운 연산자와 실행자를 쉽게 정의, 라이브러리를 확장할수 있다.</li><li>간결성 : Jinja 템플릿 엔진을 통해 깔끔하게 스크립트 매개 변수를 전달</li><li>가용성 : 모듈 아키텍쳐를 가지며, 클러스터로 확장 가능한 메시지 큐를 통해 작업을 관리.</li><li>직관적이고 다양한 기능의 UI</li><li>적은 관리비용</li></ul><h3 id="개념"><a href="#개념" class="headerlink" title="개념"></a>개념</h3><ul><li>작업(task)과 연산자(operator) 를 이용한다.</li><li>DAG(Directed Acyclec Graph; 방향성 비순환 그래프)로 표현된다.<ul><li>각 노드는 task, 방향성을 갖는 링크는 작업순서를 표현</li><li>DagRun 이란 어떤시점에 실행된 DAG를 의미, 인스턴스 정로로 이해?!</li></ul></li><li>기본적으로 제공하는 연산자는 아래와 같다.<ul><li>BashOperator : Bash 실행</li><li>PythonOperator : Python 함수 실행</li><li>EmailOperator : 이메일 전송</li><li>HTTPOperator : HTTP 요청 전송</li><li>MySqlOperator, SqliteOperator, PostgresOperator, MsSqlOperator, OracleOperator, JdbcOperator: SQL 명령 실행</li><li>Sensor : 특정시간, 파일, DB 레코드, S3 키 등을 기다림</li></ul></li><li>파라미터 값이 적용된 연산자의 오브젝트를 task라 부른다.</li></ul><h3 id="용어"><a href="#용어" class="headerlink" title="용어"></a>용어</h3><ul><li>Airflow DAG는 태스크로 구성된다.</li><li>각 태스크는 오퍼레이터 클래스를 인스턴스화하여 만든다.</li><li>DAG가 시작되면 Airflow 데이터베이스에 DagRun 항목을 만든다.</li><li>특정 DagRun 맥락에서 태스크를 실행하면 태스크 인스턴스가 만들어진다.</li><li>AIRFLOW_HOME은 DAG 정의 파일과 Airflow 플러그인을 저장하는 디렉터리이다.</li></ul><h3 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h3><ul><li><a href="https://jwon.org/airflow-concepts/" target="_blank" rel="external nofollow noopener noreferrer">https://jwon.org/airflow-concepts/</a></li><li><a href="https://aldente0630.github.io/data-engineering/2018/06/17/developing-workflows-with-apache-airflow.html" target="_blank" rel="external nofollow noopener noreferrer">https://aldente0630.github.io/data-engineering/2018/06/17/developing-workflows-with-apache-airflow.html</a></li><li><a href="https://graspthegist.com/post/learn-airflow-part-0/" target="_blank" rel="external nofollow noopener noreferrer">https://graspthegist.com/post/learn-airflow-part-0/</a></li><li><a href="https://graspthegist.com/post/learn-airflow-part-1-2/" target="_blank" rel="external nofollow noopener noreferrer">https://graspthegist.com/post/learn-airflow-part-1-2/</a></li><li><a href="https://www.youtube.com/watch?v=AHMm1wfGuHE" target="_blank" rel="external nofollow noopener noreferrer">https://www.youtube.com/watch?v=AHMm1wfGuHE</a></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/07/01/apache-airflow/#disqus_thread</comments>
    </item>
    
    <item>
      <title>AWS X-ray</title>
      <link>http://ddongeee.github.io/2019/07/01/aws-xray/</link>
      <guid>http://ddongeee.github.io/2019/07/01/aws-xray/</guid>
      <pubDate>Sun, 30 Jun 2019 19:00:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;AWS-X-Ray-란&quot;&gt;&lt;a href=&quot;#AWS-X-Ray-란&quot; class=&quot;headerlink&quot; title=&quot;AWS X-Ray 란?&quot;&gt;&lt;/a&gt;AWS X-Ray 란?&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;A
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="AWS-X-Ray-란"><a href="#AWS-X-Ray-란" class="headerlink" title="AWS X-Ray 란?"></a>AWS X-Ray 란?</h1><ul><li>Application이 처리하는 요청에 대한 데이터를 수집하는 서비스</li><li>데이터 뷰잉, 필터링 하여 서비스 이슈파악 모니터링 및 최적화를 위한 좋은 인사이트가 될수 있다.</li><li>모든 요청 응답 트레이싱. <ul><li>AWS 리소스, 마이크로서비스, 데이터베이스, HTTP API 등</li></ul></li><li>제공되는 X-Ray SDK  활용<ul><li>인터셉터</li><li>클라이언트 핸들러</li><li>HTTP 클라이언트</li></ul></li></ul><h1 id="사용사례"><a href="#사용사례" class="headerlink" title="사용사례"></a>사용사례</h1><h1 id="시작하기"><a href="#시작하기" class="headerlink" title="시작하기"></a>시작하기</h1><h1 id="개념"><a href="#개념" class="headerlink" title="개념"></a>개념</h1><h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ol><li><a href="https://docs.aws.amazon.com/ko_kr/xray/latest/devguide/aws-xray.html" target="_blank" rel="external nofollow noopener noreferrer">https://docs.aws.amazon.com/ko_kr/xray/latest/devguide/aws-xray.html</a></li><li>쿠팡내부 세션:Serverless application debug deep dive (X-ray)</li></ol><hr><p>현륜식 , aws 솔류션 아키텍트,SA</p><p>전통 디버깅. 방식 > 로그보면서.. <> xray : 세그먼트로 비교</p><p>구성 : 내부서비스에 데몬(버퍼링)띄워서 xray api 호출</p><p>코드삽입</p><p>서비스맵 : </p><ul><li>처음보는 화면</li><li>그래프를 보면서 병목 확인, 오류상황 손쉽게 확인</li><li>엣지선택하면, 히스토그램 확인할수 있음</li><li>트레이스리스트 로도 확인할수 있음</li><li>트레이스 :<ul><li>세그먼트</li><li>하위세그먼트</li></ul></li><li>필터 할수 있음</li><li>클라우드 메트릭을 사요할수 있음</li><li>api 관련<ul><li>트레이스 단위로 데이터를 가지고 올수 있음</li></ul></li><li>비용<ul><li>프리티어 <ul><li>10만건  저장</li><li>100만건 스캔 검색 (컨디션으로 검색 안됨?)</li></ul></li><li>추가 비용<ul><li>100 만건당 5달러</li></ul></li></ul></li><li>데모<ul><li>람다 함수 액티브 추적 활성화 : IAM 자동 추가됨</li><li>람다 콜드스타트 : 클라우드 와치를 통해 주기적 핑때리기.. 웜상태를 유지하기 위해..</li><li>api gateway > 람다(get news)</li></ul></li></ul><p>관련해서 서비스 반영하려고 하는데</p><ul><li>원시 데이터텝에 개인정보 포함되어 있어서(누구나 접근하고 볼수 있음) 보안검토가 통과되지 않음..<ul><li>그래서 AWS 쪽에서는 feature 로 등록한 상태</li></ul></li></ul><p>X ray 사용위해 람다 제외하고 무조건 데몬을 띄워야함.</p><p>내부 세션 정리</p><p>Akka 와 같은 분산처리 클러스터링 베이스 서비스의 경우에 사용사례가 있는지?</p><p>참고하면 좋은 것들이 있는지 추천 부탁.</p></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/07/01/aws-xray/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Enhanced factory pattern with spring framework</title>
      <link>http://ddongeee.github.io/2019/06/06/spring-design-pattern-first/</link>
      <guid>http://ddongeee.github.io/2019/06/06/spring-design-pattern-first/</guid>
      <pubDate>Wed, 05 Jun 2019 20:00:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 id=&quot;목표&quot;&gt;&lt;a href=&quot;#목표&quot; class=&quot;headerlink&quot; title=&quot;목표&quot;&gt;&lt;/a&gt;목표&lt;/h2&gt;&lt;p&gt;스프링 프레임워크 프로젝트에서 Bean 생성 혹은 선택을 Factory patte
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h2 id="목표"><a href="#목표" class="headerlink" title="목표"></a>목표</h2><p>스프링 프레임워크 프로젝트에서 Bean 생성 혹은 선택을 Factory pattern으로 구현한 설계를 개선한다.</p><ul><li>OCP 에 좀더 부합하도록 코드 리펙터링을 진행하고 싶다.<ul><li>클래스 안에 If, else 구문 제거 시키고 싶다.</li></ul></li><li>재사용성 및 중복코드 제거 하고 싶다.</li></ul><h2 id="배경"><a href="#배경" class="headerlink" title="배경"></a>배경</h2><p>프로젝트를 진행하면서 특정 type으로 서로다른 구현체(Bean)를 필요하는 경우 Factory pattern 을 사용하여 다형성을 구현하였습니다. 이를 통해 다양한 타입에 따른 Bean 생성혹은 선택 로직을 팩토리 클래스 하나에 응집시켜, 관련 로직 수정시 단순히 팩토리 메소드 안에 있는 코드만 수정함으로써 어느정도 유지보수에 도움을 줄수 있었습니다. 하지만 서로 다른 성격의 type들이 추가되고, 이러한 팩토리 클래스 종류도 다양해지고 많아졌습니다. 일반적으로 해당 팩토리 클래스의 구현은 if(type.equals(“A”)) else if .. 와 같은식으로 구현되고 있기 때문에 동일 팩토리 클래스에 새로운 type 을 추가하고 싶을경우 해당 팩토리 클래스의 수정이 불가피 했습니다. 결국 OCP에 부합하지 않는 코드가 계속적으로  만들어 지고 있는중 입니다.</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoffeeMakerFactoryLegacy</span> </span>{</span><br><span class="line"><span class="hljs-comment">//    @Autowired private AmericanoMakerLegacy americanoMakerLegacy;</span></span><br><span class="line"><span class="hljs-comment">//    @Autowired private CappuccinoMakerLegacy cappuccinoMakerLegacy;</span></span><br><span class="line"><span class="hljs-comment">//    @Autowired private EspressoMakerLegacy espressoMakerLegacy;</span></span><br><span class="line">    <span class="hljs-meta">@Autowired</span> <span class="hljs-keyword">private</span> CoffeeMakerLegacy americanoMakerLegacy;</span><br><span class="line">    <span class="hljs-meta">@Autowired</span> <span class="hljs-keyword">private</span> CoffeeMakerLegacy cappuccinoMakerLegacy;</span><br><span class="line">    <span class="hljs-meta">@Autowired</span> <span class="hljs-keyword">private</span> CoffeeMakerLegacy espressoMakerLegacy;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> CoffeeMakerLegacy <span class="hljs-title">select</span><span class="hljs-params">(CoffeeName coffeeName)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">if</span> (CoffeeName.Americano == coffeeName) {</span><br><span class="line">            <span class="hljs-keyword">return</span> americanoMakerLegacy;</span><br><span class="line">        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (CoffeeName.Cappuccino == coffeeName) {</span><br><span class="line">            <span class="hljs-keyword">return</span> cappuccinoMakerLegacy;</span><br><span class="line">        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (CoffeeName.Espresso == coffeeName) {</span><br><span class="line">            <span class="hljs-keyword">return</span> espressoMakerLegacy;</span><br><span class="line">        } <span class="hljs-keyword">else</span> {</span><br><span class="line">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Invalid CoffeeName : "</span> + coffeeName.name());</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CoffeeMakerLegacy</span> </span>{</span><br><span class="line">    <span class="hljs-function">Coffee <span class="hljs-title">make</span><span class="hljs-params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AmericanoMakerLegacy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CoffeeMakerLegacy</span> </span>{</span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Coffee <span class="hljs-title">make</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Americano();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="문제-해결"><a href="#문제-해결" class="headerlink" title="문제 해결"></a>문제 해결</h2><p>크게 2가지 Skill 을 통해 OCP 에 부합하는 Factory pattern을 구현해 보고자 합니다.</p><ul><li>Spring framework 의 DI </li><li>자료구조중에 Map </li></ul><p>그밖에 다양한 기본기술이 사용되지만, 핵심이 되는 기술은 위와 같습니다.</p><p>그럼 이러한 2가지 기술을 통해, 보다 OCP에 부합되는 소프트웨어를 만들어 봅시다.</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoffeeMakerFactoryList</span> </span>{</span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-keyword">private</span> List<CoffeeMakerV1> coffeeMakers;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * getChannel() 호출시, 매번 n(bean 개수)번씩 loop 순회 필요</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> CoffeeMakerV1 <span class="hljs-title">select</span><span class="hljs-params">(CoffeeName coffeeName)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> coffeeMakers.stream()</span><br><span class="line">                .filter(c -> c.key() == coffeeName)</span><br><span class="line">                .collect(Collectors.toList())</span><br><span class="line">                .get(<span class="hljs-number">0</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>List<bean>  autowired 를 통한 첫번째 방법 입니다. select() 호출시, 매번 n번의 Bean 탐색이 필요합니다. </bean></p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoffeeMakerFactoryMap</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map<CoffeeName, CoffeeMakerV1> coffeeMakerMap = <span class="hljs-keyword">new</span> HashMap<>();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * Spring beans 초기화시에 호출</span></span><br><span class="line"><span class="hljs-comment">     **/</span></span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(List<CoffeeMakerV1> coffeeMakers)</span> </span>{</span><br><span class="line">        coffeeMakers.forEach(c -> coffeeMakerMap.put(c.key(), c));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> CoffeeMakerV1 <span class="hljs-title">select</span><span class="hljs-params">(CoffeeName coffeeName)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> coffeeMakerMap.get(coffeeName);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CoffeeMakerV1</span> </span>{</span><br><span class="line">    <span class="hljs-function">CoffeeName <span class="hljs-title">key</span><span class="hljs-params">()</span></span>;</span><br><span class="line">    <span class="hljs-function">Coffee <span class="hljs-title">make</span><span class="hljs-params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AmericanoMakerV1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CoffeeMakerV1</span> </span>{</span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> CoffeeName <span class="hljs-title">key</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> CoffeeName.Americano;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Coffee <span class="hljs-title">make</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Americano();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>Map<Key, Bean> autowired 를 통한 두번째 방법 입니다. </p><p>위와 같이 만들경우, 새로운 구현체(Bean)가 추가되더라도, 기존의 Factory 클래스의 코드 변경이 없습니다. 스프링 환경의 초기화 시점에 해당 Interface(CoffeeMakerV1) 를 구현하고 있는 bean들은 Autowired 됩니다. 결론적으로 OCP를 충족시켜 줄수 있습니다. 또한 프로젝트에 다양하게 존재한 type별 구현체 if else 구문이 모두 제거 되어 코드 복잡도를 좀더 낮출수 있게 되었습니다. 그렇지만 아직 한가지 아쉬운 부분은 이러한 코드 또한, 다양한 팩토리 메소드 마다 중복 존재한다는 부분입니다. 중복제거 및 재사용 관점에서 알아보겠습니다.</p><h2 id="중복-제거-및-재사용-관점"><a href="#중복-제거-및-재사용-관점" class="headerlink" title="중복 제거 및 재사용 관점"></a>중복 제거 및 재사용 관점</h2><p>위의 아키텍쳐에서 pattern 이 존재하는것을 확인할수있습니다. 이를 하나로 통합하여, 추후에 적용해야하는 다양한 팩토리 클래스에 대해서 일괄 적용한다면, 중복코드 제거 및 재사용성을 높일수 있습니다.  이를 위해 추가적으로 2가지 컨셉을 적용해 보겠습니다.</p><ul><li>디자인 패턴 중 Template pattern</li><li>Spring framework 4.0 에서부터 제공하는 Autowiring of Generic Types</li></ul><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Supported from Spring 4.0 and later</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractBeanSelector</span><<span class="hljs-title">K</span>, <span class="hljs-title">V</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Key</span><<span class="hljs-title">K</span>>> </span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map<K, V> beanMap = <span class="hljs-keyword">new</span> HashMap<>();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(List<V> beans)</span> </span>{</span><br><span class="line">        beans.forEach(bean -> beanMap.put(bean.key(), bean));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">select</span><span class="hljs-params">(K type)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> beanMap.get(type);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Key</span><<span class="hljs-title">K</span>> </span>{</span><br><span class="line">    <span class="hljs-function">K <span class="hljs-title">key</span><span class="hljs-params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CoffeeMaker</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Key</span><<span class="hljs-title">CoffeeName</span>> </span>{</span><br><span class="line">    <span class="hljs-function">Coffee <span class="hljs-title">make</span><span class="hljs-params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoffeeMakerBeanSelector</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractBeanSelector</span><<span class="hljs-title">CoffeeName</span>, <span class="hljs-title">CoffeeMaker</span>> </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * 아래와 같이 CoffeeMaker 구현체인 AmericanoMaker 만 추가함으로써 확장 가능</span></span><br><span class="line"><span class="hljs-comment"> */</span> </span><br><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AmericanoMaker</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CoffeeMaker</span> </span>{</span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> CoffeeName <span class="hljs-title">key</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> CoffeeName.Americano;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Coffee <span class="hljs-title">make</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Americano();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Barista</span> </span>{</span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-keyword">private</span> AbstractBeanSelector<CoffeeName, CoffeeMaker> coffeeMakerBeanSelector;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Coffee <span class="hljs-title">make</span><span class="hljs-params">(CoffeeName coffeeName)</span> </span>{</span><br><span class="line">        CoffeeMakerV2 coffeeMaker = coffeeMakerBeanSelector.select(coffeeName)</span><br><span class="line">                .orElseThrow(() -> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"못만들어요 : "</span> + coffeeName));</span><br><span class="line">        <span class="hljs-keyword">return</span> coffeeMaker.make();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>이제 Barista(최초 caller)는 단순히 AbstractBeanSelector 타입으로만 디펜던시가 존재하며, 스프링에서 coffeeMakerBeanSelector 이름의 구현체 Bean 을 autowiring 시켜 줍니다. 이를 단순히 coffeeMakerBeanSelector.select(coffeeName) 메소드를 통해 Bean을 가지고 올수 있습니다. 이를 위해 기존 클래스를 제외하고 추가 되어야 하는 클래스는 아래와 같이 CoffeeMakerBeanSelector 밖에 없습니다.</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoffeeMakerBeanSelector</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractBeanSelector</span><<span class="hljs-title">CoffeeName</span>, <span class="hljs-title">CoffeeMaker</span>> </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>이제는 중복 코드가 존재 하지 않습니다. 재사용도 무척 편리합니다.</p><h2 id="딥다이브-깊게생각해보기"><a href="#딥다이브-깊게생각해보기" class="headerlink" title="딥다이브:깊게생각해보기"></a>딥다이브:깊게생각해보기</h2><p>최종적으로 도출된 재사용성이 높은 클래스에는 혹시 이슈가 있을까요? 아니면 추가적으로 필요한 비지니스가 생길수 있을까요? 휴먼에러가 될수도 있고, 의도하였거나 하지 못한 부분이 생겨날수도 있는 부분이 있습니다. 사용하는 자료구조가 Map 이라는것에 이슈가 생길수도 있습니다. 예를들어, 비지니스에 변경및 추가가 생겨서 새로운 CoffeeMaker 구현체가 추가된다고 가정해 봅시다. 그러한 CoffeeMaker의 구현체 Key가 이미 존재하는 구현체의 Key와 겹친다면? 둘중 하나는 CoffeeMaker구현체는 Map의 Value에서 사라져 버리겠죠. 이를 개발자에게 인지시켜주거나 새로운 로직 추가 및 분기가 필요해 보입니다.</p><p>만일 Bean(ex. CoffeeMaker구현체) 마다 유니크한 Key를 가지는것이 원칙일때, 개발과정에서 동일 키를 가진 Bean이 추가됬을 경우, 서비스가 deployed 되기 전에(Spring beans initialize 시점에) 개발자에게 에러 상황을 알려줘야 합니다.</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Supported from Spring 4.0 and later</span></span><br><span class="line"><span class="hljs-comment"> * Bean 이 Single Key 를 가지고 있고, key 값이 Unique 한 경우.</span></span><br><span class="line"><span class="hljs-comment"> * K:V = 1:1</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractUniqueBeanSelector</span><<span class="hljs-title">K</span>, <span class="hljs-title">V</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SingleKey</span><<span class="hljs-title">K</span>>> </span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map<K, V> beanMap = <span class="hljs-keyword">new</span> HashMap<>();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(List<V> beans)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">if</span> (beans.isEmpty()) {</span><br><span class="line">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Bean is not exist : "</span> + getClass().getSimpleName());</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">for</span> (V bean : beans) {</span><br><span class="line">            <span class="hljs-keyword">if</span> (beanMap.get(bean.key()) != <span class="hljs-keyword">null</span>) {</span><br><span class="line">                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Bean's key is not unique : "</span> + bean.key());</span><br><span class="line">            }</span><br><span class="line">            beanMap.put(bean.key(), bean);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Optional<V> <span class="hljs-title">select</span><span class="hljs-params">(K type)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> Optional.ofNullable(beanMap.get(type));</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">SingleKey</span><<span class="hljs-title">K</span>> </span>{</span><br><span class="line">    <span class="hljs-function">K <span class="hljs-title">key</span><span class="hljs-params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>그러나 만약 하나의 key에 2개 이상의 Bean이 존재할수 있다면, 이를 시스템적으로 지원해 주도록 해야합니다. </p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * !Supported from Spring 4.0 and later</span></span><br><span class="line"><span class="hljs-comment"> * Bean 이 Single Key 를 가지고 있고, 하나의 Key 값에 여러 Bean 이 존재하는경우</span></span><br><span class="line"><span class="hljs-comment"> * K:V = 1:n 인경우 사용</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractMultipleBeanSelector</span><<span class="hljs-title">K</span>, <span class="hljs-title">V</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SingleKey</span><<span class="hljs-title">K</span>>> </span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map<K, List<V>> beanMap = <span class="hljs-keyword">new</span> HashMap<>();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(List<V> beans)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">if</span> (beans.isEmpty()) {</span><br><span class="line">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Bean is not exist : "</span> + getClass().getSimpleName());</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">for</span> (V bean : beans) {</span><br><span class="line">            beanMap.computeIfAbsent(bean.key(), k -> <span class="hljs-keyword">new</span> ArrayList<>())</span><br><span class="line">                    .add(bean);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> List<V> <span class="hljs-title">select</span><span class="hljs-params">(K type)</span> </span>{</span><br><span class="line">        List<V> beans = beanMap.get(type);</span><br><span class="line">        <span class="hljs-keyword">return</span> beans == <span class="hljs-keyword">null</span> ? <span class="hljs-keyword">new</span> ArrayList<>() : beans;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>마지막으로 K:V 가 n:n 일경우</p><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * !Supported from Spring 4.0 and later</span></span><br><span class="line"><span class="hljs-comment"> * Bean 이 Multiple Key 를 가지고 있고, 하나의 Key 값에 여러 Bean 이 존재하는경우</span></span><br><span class="line"><span class="hljs-comment"> * K:V = n:n 인경우 사용</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractMultipleBeanSelectorWithMultipleKey</span><<span class="hljs-title">K</span>, <span class="hljs-title">V</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MultipleKey</span><<span class="hljs-title">K</span>>> </span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map<K, List<V>> beanMap = <span class="hljs-keyword">new</span> HashMap<>();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(List<V> beans)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">if</span> (beans.isEmpty()) {</span><br><span class="line">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Bean is not exist : "</span> + getClass().getSimpleName());</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">for</span> (V bean : beans) {</span><br><span class="line">            <span class="hljs-keyword">for</span> (K key : bean.keys()) {</span><br><span class="line">                beanMap.computeIfAbsent(key, k -> <span class="hljs-keyword">new</span> ArrayList<>())</span><br><span class="line">                          .add(bean);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> List<V> <span class="hljs-title">select</span><span class="hljs-params">(K type)</span> </span>{</span><br><span class="line">        List<V> beans = beanMap.get(type);</span><br><span class="line">        <span class="hljs-keyword">return</span> beans == <span class="hljs-keyword">null</span> ? <span class="hljs-keyword">new</span> ArrayList<>() : beans;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">MultipleKey</span><<span class="hljs-title">K</span>> </span>{</span><br><span class="line">    <span class="hljs-function">List<K> <span class="hljs-title">keys</span><span class="hljs-params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="정리"><a href="#정리" class="headerlink" title="정리"></a>정리</h2><p><img src="https://user-images.githubusercontent.com/10233723/59331508-17930080-8d2f-11e9-96e4-7e7850cfc8f6.png" alt="select-bean-class-uml"></p><p>SpringFramework 안에서 OCP 및 재사용성을 높인 Enhanced Abstract Factory Pattern 을 만들어 보았습니다. </p></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/06/06/spring-design-pattern-first/#disqus_thread</comments>
    </item>
    
    <item>
      <title>Unix &amp; Linux command and shell script!</title>
      <link>http://ddongeee.github.io/2019/04/08/shell-command-and-script/</link>
      <guid>http://ddongeee.github.io/2019/04/08/shell-command-and-script/</guid>
      <pubDate>Sun, 07 Apr 2019 17:00:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 id=&quot;Concept&quot;&gt;&lt;a href=&quot;#Concept&quot; class=&quot;headerlink&quot; title=&quot;Concept&quot;&gt;&lt;/a&gt;Concept&lt;/h2&gt;&lt;figure class=&quot;highlight bas
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h2 id="Concept"><a href="#Concept" class="headerlink" title="Concept"></a>Concept</h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 0(stdin), 1(stdout), 2(stderr)</span><br><span class="line">2. input redirection(0< 생략), output redirection(1> 생략)</span><br><span class="line">3. > (replace), >> (없으면생성, 있으면 다음행에 append)</span><br><span class="line">4. >& (해당 기호 뒤에 fd 생략 불가능.. ex. >>&1 , >&2 )</span><br><span class="line">5. 명령어의 실행결과를 다음 명령어의 입력으로 연결하는, 즉 출입력을 연결하는 기호</span><br><span class="line">    1. ls -l /var/<span class="hljs-built_in">log</span> | sort -rk 9 (9번째 열의 데이터로 desc)</span><br><span class="line">6. SomeCommand > /dev/null 2>&1 하면 로그 버림</span><br></pre></td></tr></tbody></table></figure><h2 id="Commands"><a href="#Commands" class="headerlink" title="Commands"></a>Commands</h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># 사용가능한 모든 쉘</span></span><br><span class="line">$ cat /etc/shells</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 현재 사용중인 쉘</span></span><br><span class="line">$ <span class="hljs-built_in">echo</span> <span class="hljs-variable">$SHELL</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 쉘 바꾸기</span></span><br><span class="line">$ chsh</span><br><span class="line"></span><br><span class="line">$ date</span><br><span class="line"></span><br><span class="line">$ at (특정시간에 특정 잡을 실행)</span><br><span class="line"></span><br><span class="line">$ chmod (접근 권한 변경), ls -al 으로 확인(소유자,소유자그룹,모든사용자)</span><br><span class="line"><span class="hljs-comment"># chmod 755 file</span></span><br><span class="line"><span class="hljs-comment"># chmod u+x file</span></span><br><span class="line"></span><br><span class="line">$ chown (소유자, 소유자그룹변경. root 만 가능)</span><br><span class="line"></span><br><span class="line">$ cmp (파일을 비교하여 차이점을 알려주는 명령어)</span><br><span class="line"></span><br><span class="line">$ col (개행 혹은 공백 치환 역할을 하는 명령어)</span><br><span class="line"></span><br><span class="line">$ colctr (- 옵션과 같이 쓰면 <span class="hljs-string">'_'</span> 를 제거해 준다.)</span><br><span class="line"></span><br><span class="line">$ cp (복사)(-r 디렉터리의 하위 파일 및 디렉토리 모두 복사)</span><br><span class="line"></span><br><span class="line">$ cut (파이프 결과중에 지정된 부분만 표시.)</span><br><span class="line"><span class="hljs-comment"># (bcf 옵션에는 숫자범위 지정할수 있음. A, A-, A-B, -B)</span></span><br><span class="line"><span class="hljs-comment"># (-c 문자단위로분할)</span></span><br><span class="line"><span class="hljs-comment"># (-d 구분자이용)</span></span><br><span class="line"><span class="hljs-comment"># (-f 지정된 필드만 표시)</span></span><br><span class="line"><span class="hljs-comment"># (-s 구분자에 포함되지 않은 행은 표시하지 않음)</span></span><br><span class="line"><span class="hljs-comment"># cut -d ":" -f1,7 /etc/passwd 혹은 cut -d: -f1,2,3 /etc/passwd</span></span><br><span class="line"></span><br><span class="line">$ date (날짜 표시)</span><br><span class="line"><span class="hljs-comment"># date +%Y-%m-%d' '%k:%M:%S</span></span><br><span class="line"><span class="hljs-comment"># date +%Y%m%d%k%M%S</span></span><br><span class="line"></span><br><span class="line">$ df (파일 시스템의 디스크 용량 확인)</span><br><span class="line"><span class="hljs-comment"># df -aH</span></span><br><span class="line"></span><br><span class="line">$ diff (두 파일간의 비교)</span><br><span class="line"></span><br><span class="line">$ du (현재 디렉터리의 사용량을 표시)        </span><br><span class="line"><span class="hljs-comment"># du -sh</span></span><br><span class="line"></span><br><span class="line">$ <span class="hljs-built_in">echo</span> (문자열 출력, 환경변수 확인할수도 있음, 로그 용도로도 사용)</span><br><span class="line"></span><br><span class="line">$ find (파일을 찾을때 사용)</span><br><span class="line"></span><br><span class="line">$ free (메모리 사용량 체크 명령어)</span><br><span class="line"></span><br><span class="line">$ ifconfig (네트워크 인터페이스 설정 확인 및 변경)</span><br><span class="line"></span><br><span class="line">$ grep (대소문자 구별하여 검색) </span><br><span class="line"><span class="hljs-comment"># (-c 해당 패턴 포함된 행의 개수 출력)</span></span><br><span class="line"><span class="hljs-comment"># (-i 대소문자 구분없앰)</span></span><br><span class="line"><span class="hljs-comment"># (-n 행번호 출력)</span></span><br><span class="line"><span class="hljs-comment"># (-v 제외하고 출력)</span></span><br><span class="line"><span class="hljs-comment"># 정규 표현식 가능. </span></span><br><span class="line"><span class="hljs-comment"># cat somefile.txt | grep '[0-9]' // 숫자 포함 검색</span></span><br><span class="line"><span class="hljs-comment"># la -al | grep '^d' | grep -v '[.]' // 현재 디렉토리에 파일 검색</span></span><br><span class="line"><span class="hljs-comment"># ls -al | grep '\.log$' // 로그 파일 검색</span></span><br><span class="line"><span class="hljs-comment"># OR 조건 걸기. cat some.txt | grep 'A\|B\|C'</span></span><br><span class="line"></span><br><span class="line">$ lsof (list open files 명령어는 시스템에서 열린 파일 목록 확인 및 프로세스, 디바이스 정보 등을 표시)</span><br><span class="line"><span class="hljs-comment"># (-i 특정 포트를 사용하는 프로세스를 출력. lsof -i TCP:80, lsof -i :22-2202)</span></span><br><span class="line"><span class="hljs-comment"># (-c 특정 명령어가 사용하는 프로세스 출력. lsof -c httpd)</span></span><br><span class="line"><span class="hljs-comment"># (+D 특정 디렉터리 하위에 열려있는 프로세스 출력. lsof +D ~)</span></span><br><span class="line"><span class="hljs-comment"># lsof /var/log/messages 는 해당 파일을 사용하는 프로세스를 출력한다.</span></span><br><span class="line"></span><br><span class="line">$ netstat (현재 시스템에 연결되어 있는 네트워크 연결 상태 및 포트 정보 표시)</span><br><span class="line"><span class="hljs-comment"># netstat -nr IP주소와 커널의 라우팅 테이블 정보를 출력. route와 동일</span></span><br><span class="line"></span><br><span class="line">$ ps (현재시스템의 프로세스 상태 출력)</span><br><span class="line"><span class="hljs-comment"># ps -u crayon -ax</span></span><br><span class="line"></span><br><span class="line">$ script (터미널에서 수행하는 작업들을 텍스트 형식으로 저장한다.)</span><br><span class="line"></span><br><span class="line">$ sort (텍스트 파일을 행 단위로 정렬한다.)</span><br><span class="line"><span class="hljs-comment"># (-d 알파벳과 숫자를 사전순으로 정렬한다.)</span></span><br><span class="line"><span class="hljs-comment"># (-r desc 으로 정렬한다.)</span></span><br><span class="line"><span class="hljs-comment"># (-t 필드 구분자를 지정한다.)</span></span><br><span class="line"><span class="hljs-comment"># (-k 각 행의 지정된 필드를 기준으로 정렬한다.)</span></span><br><span class="line"><span class="hljs-comment"># ls -alh | sort -rk 5 // 디렉토리에서 5행(용량) 기준으로 desc 정렬한다.</span></span><br><span class="line"><span class="hljs-comment"># ls -alh | grep -v ^d | sort -rk 8</span></span><br><span class="line"></span><br><span class="line">$ tail (마지막 행의 내용부터 출력한다.)</span><br><span class="line"><span class="hljs-comment"># (-f 명령을 종료하지 않고 추가되는 내용을 실시간으로 출력한다.)</span></span><br><span class="line"><span class="hljs-comment"># (-n 마지막 행부터 n행까지의 내용을 출력한다. n 생략 가능.. tail -10 somefile)</span></span><br><span class="line"></span><br><span class="line">$ tar (여러개의 파일을 하나의 파일로 묶는다.)</span><br><span class="line"><span class="hljs-comment"># tar -cvf merged_file.tar /test/etc // /test/ectdml 파일 및 디렉터리를 묶는다.</span></span><br><span class="line"><span class="hljs-comment"># tar -xvf merged_file.tar // 묶은것을 해제한다.</span></span><br><span class="line"></span><br><span class="line">$ time (특정 프로세스나 명령어에 사용된 시스템 자원 정보를 출력한다.)</span><br><span class="line"><span class="hljs-comment"># time ls</span></span><br><span class="line"></span><br><span class="line">$ touch (0바이트의 빈 파일을 생성하거나, 파일 존재시 수정시간을 현재 시간으로 변경한다.)</span><br><span class="line"></span><br><span class="line">$ tr (특정 문자를 다른 문자로 변경할 때 사용. 대부분 재지정 시 활용)</span><br><span class="line"><span class="hljs-comment"># tr "a-z" "A-Z" < tr.test // 소문자를 대문자로 변경</span></span><br><span class="line"><span class="hljs-comment"># tr -d "_" < tr.test // 모든 '_' 제거</span></span><br><span class="line"></span><br><span class="line">$ traceroute (네트워크 경로를 확인하기 위해 패킷이 거쳐가는 경로 추적. 경로중에 부하높은곳을 찾을수 있다.)</span><br><span class="line"></span><br><span class="line">$. uptime (평균 시스템 부하 정보 출력)</span><br><span class="line"></span><br><span class="line">$. w (로그인한 사용자 출력)</span><br><span class="line"></span><br><span class="line">$. sed (스트림 편집기를 의미하며, 택스트 처리 혹은 치환 용도로 사용된다.)</span><br><span class="line"></span><br><span class="line">$. awk (텍스트 형태의 데이터를 행과 열로 구분하여 처리하고 결과를 출력한다. 조건문 사용가능 )</span><br><span class="line"><span class="hljs-comment"># awk '표현식 {액션}' 파일</span></span><br><span class="line"><span class="hljs-comment"># awk -f [awk 명령 스크립트 파일] 파일</span></span><br><span class="line"><span class="hljs-comment"># cat /etc/passwd | awk -F: '/^user/{print $1, $6}'</span></span><br><span class="line"><span class="hljs-comment"># df -k | grep -v Filesystem | sed -e s/%//g | awk '$5 > 70 {print $0}' // 디스크 사용량이 70% 이상인 파일시스템 확인</span></span><br><span class="line"><span class="hljs-comment"># grep '^Listen' /etc/httpd.conf | awk '{if($2 == 80) print "Http Service Port is 80"; else print Service Port is Not 80}'</span></span><br><span class="line"><span class="hljs-comment"># cat /etc/passwd| awk -F: 'BEGIN{print "User / Home Dir"};/^_k/{print $1,$6};END{print "- END -"}' // BEGIN, END 사용</span></span><br><span class="line"><span class="hljs-comment"># cat /etc/passwd | awk -F: '/[nologin]$/{print $1 | "sort"}'</span></span><br><span class="line"></span><br><span class="line">$ env, printenv (환경변수보기)    </span><br><span class="line"></span><br><span class="line">$ <span class="hljs-built_in">set</span> (현재 쉘에서만 사용할수 있는 지역변수 보기),</span><br><span class="line"></span><br><span class="line">$ rm (파일지우기)</span><br><span class="line"><span class="hljs-comment"># pipe로 지우는 방법.. ls -al | grep -v '^d' | awk '{print $9}' | xargs rm</span></span><br><span class="line"></span><br><span class="line">$ ps -ef</span><br><span class="line"><span class="hljs-comment"># You can add 'aux' option to show usages of CPU, MEM and process status</span></span><br><span class="line"></span><br><span class="line">$ file -I {{fileName}}</span><br><span class="line"><span class="hljs-comment"># file 인코딩 확인</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 머신, 하드웨어 타입 출력</span></span><br><span class="line">$ uname -m </span><br><span class="line"><span class="hljs-comment"># 운영체제 이름 출력</span></span><br><span class="line">$ uname -s</span><br><span class="line"><span class="hljs-comment"># 모든 정보 출력</span></span><br><span class="line">$ uname -a</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Client url로 서버와 통신할수 있는 command line tool</span></span><br><span class="line"><span class="hljs-comment"># proxy, cookie, header 설정 가능</span></span><br><span class="line"><span class="hljs-comment"># 다양한 프로토콜 지원</span></span><br><span class="line"><span class="hljs-comment"># -L 옵션의 경우, 서버에서 301,302으로 응답이 왔을경우, redirect url을 따라간다.</span></span><br><span class="line">$ curl -L www.naver.com </span><br><span class="line"><span class="hljs-comment"># -o 옵션의 경우, 출력 내용을 파일로 저장한다. (파일 다운로드시에 유용)</span></span><br><span class="line"><span class="hljs-comment"># -O 의 경우 remote file name 으로 저장한다. (파일 length 없으면 에러)</span></span><br><span class="line">$ curl -o ~/Development/<span class="hljs-built_in">test</span>/google www.google.com</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 파일이나 디렉토리의 접근 권한을 변경</span></span><br><span class="line"><span class="hljs-comment"># +x 옵션의 경우, </span></span><br><span class="line">$ chmod +x /usr/<span class="hljs-built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 사용자 컴퓨터의 네트워크 환경을 알려줌 : 시스템 네트워크 연결목록</span></span><br><span class="line"><span class="hljs-comment"># 로컬과 리모트 서버 ip/호스트네임과 포트 표기</span></span><br><span class="line"><span class="hljs-comment"># LISTENING : 접속대기상태, ESTABLISHED : 접속된 상태, SYN_SENT : 접속하기위해 패킷보냄</span></span><br><span class="line">$ netstat </span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># list open files 로써, 열린파일목록 및 사용하는 프로세스, 디바이스정보 파일종류등을 알려줌</span></span><br><span class="line"><span class="hljs-comment"># VFS(virtual file system)을 사용하는 유닉스, 리눅스 파일 시스템에서 사용</span></span><br><span class="line"><span class="hljs-comment"># 다른 유사한 명령어가 linux,unix 계열 명령어가 있지만, 제각각 이라서, lsof 사용이 유리</span></span><br><span class="line"><span class="hljs-comment"># 열린파일정보</span></span><br><span class="line">$ lsof</span><br><span class="line"><span class="hljs-comment"># 특정 포트를 사용하는 프로세스 정보</span></span><br><span class="line">$ lsof -i TCP:22</span><br><span class="line">$ lsof -i :8080</span><br><span class="line">$ lsof -i :22-8080</span><br><span class="line"><span class="hljs-comment"># 특정 명령어가 사용하는 포트</span></span><br><span class="line"><span class="hljs-comment"># apache httpd 의 경우 fork 하여 여러개 프로세스 띄움</span></span><br><span class="line">$ lsof -c httpd</span><br><span class="line"><span class="hljs-comment"># 현재 열려있는 포트</span></span><br><span class="line"><span class="hljs-comment"># -n 옵션은, 네트워크 번호를 이름으로 변경하는것을 금지, lsof 더빨리 실행될수 있음</span></span><br><span class="line"><span class="hljs-comment"># -P 옵션은, 서비스 이름대신 포트로 표시</span></span><br><span class="line">$ lsof -i -nP | grep LISTEN | awk <span class="hljs-string">'{print $(NF-1)" "$1}'</span> | sort -u</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># $0 이라는 내부변수에 레코드(입력받은 각 라인)을 할당하고, 공백을 기준으로 $1 부터 데이터가 할당된다.</span></span><br><span class="line"><span class="hljs-comment"># NR : 레코드 넘버가 저장된다.</span></span><br><span class="line"><span class="hljs-comment"># NF : 레코드의 컬럼 사이즈, 컬럼의 개수</span></span><br><span class="line"><span class="hljs-comment"># awkfile 에서 'tomcat'이 포함된 라인에 1번째, 3번째 컬럼을 출력한다.</span></span><br><span class="line">$ awk <span class="hljs-string">'/tomcat/ {print $1, $3}'</span> awkfile</span><br><span class="line"><span class="hljs-comment"># Capacity 가 50% 이하인 filesystem 출력</span></span><br><span class="line">$ df -h | awk <span class="hljs-string">'$5 < 50'</span> </span><br><span class="line"><span class="hljs-comment"># printf 를 사용하면, 포멧팅된 출력 이용이 가능하다.</span></span><br><span class="line">$ awk <span class="hljs-string">'{printf "이름은 %-20s, 숫자는 %4d\n", $1" "$2, $3}'</span> awkfile</span><br><span class="line"><span class="hljs-comment"># -f 옵션을 사용하여, 액션과 명령어를 파일로부터 가져와 사용할수 있다.</span></span><br><span class="line">$ awk -f {{awkCommandFileName}} {{awkFile}}</span><br><span class="line"><span class="hljs-comment"># -F 으로 FS(구분자)를 변경한다.</span></span><br><span class="line"><span class="hljs-comment"># awk -F{{구분자}} '/tomcat/{print $1, $2}' awkfile</span></span><br><span class="line">$ awk -F: <span class="hljs-string">'/tomcat/{print $1, $2}'</span> awkfile</span><br><span class="line"><span class="hljs-comment"># https://zzsza.github.io/development/2017/12/20/linux-6/ 나머지 정리눈 여기</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 리눅스 디렉토리 용량 확인</span></span><br><span class="line"><span class="hljs-comment"># 확인전에 df로 먼저?</span></span><br><span class="line"><span class="hljs-comment"># df 명령은 현재 마운트 된 파일시스템의 상태를 기초로하여 사용률을 보여주는것이고,</span></span><br><span class="line"><span class="hljs-comment"># du 명령은 실제 디렉토리와 파일을 확인하고 그 크기를 보여준다.</span></span><br><span class="line"><span class="hljs-comment"># df의 경우 deleted 된 파일의 용량까지 포함해서 보여준다. 이는 lsof로 deleted상태의 프로세스를 종료혹은 리셋시킨다.</span></span><br><span class="line"><span class="hljs-comment"># folder 용량확인</span></span><br><span class="line">$ du -hs {{folder}}</span><br><span class="line"><span class="hljs-comment"># 현재 위치에 디렉토리들 용량확인</span></span><br><span class="line">$ du -hs *</span><br><span class="line"><span class="hljs-comment"># 현재 위치에 있는 폴더 및 파일중에서 용량 사이즈 큰것으로 정렬한것중 상위 10개만 보기</span></span><br><span class="line">$ du -hsx * | sort -rh | head -n 10</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 디스크</span></span><br><span class="line">$ df</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ?? </span></span><br><span class="line">$ nslookup</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 재귀 삭제</span></span><br><span class="line">find . -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">"build"</span> -<span class="hljs-built_in">exec</span> rm -rf {} \;</span><br><span class="line">find . -<span class="hljs-built_in">type</span> d -name <span class="hljs-string">"build"</span> -<span class="hljs-built_in">exec</span> rm -rf {} \;</span><br><span class="line">find . -<span class="hljs-built_in">type</span> d -name <span class="hljs-string">"out"</span> -<span class="hljs-built_in">exec</span> rm -rf {} \;</span><br></pre></td></tr></tbody></table></figure><h2 id="Vi-editor"><a href="#Vi-editor" class="headerlink" title="Vi editor"></a>Vi editor</h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 입력모드, 노멀모드, 명령모드, 비주얼모드(노멀 모드에서 v. 포인터부터 드래그 효과)</span><br><span class="line">2. 이동 ::: 0 (노멀모드에서 맨 앞으로 포인트 이동), $ (노멀모드에서 맨뒤로 포인터 이동), G (맨 마지막 행으로 이동)    </span><br><span class="line">3. 삭제 ::: u (명령취소), dd,[숫자]dd (숫자 수만큼 라인 삭제)</span><br><span class="line">4. 복사 ::: yy, [숫자]yy (커서위치한곳부터 숫자만큼 복사), p (복사한 내용을 아래쪽에 붙이기), P (복사한 내용을 위쪽에 붙이기)</span><br><span class="line">5. 환경설정 </span><br><span class="line">    1. <span class="hljs-built_in">set</span> nu (넘버링.. 반대는 <span class="hljs-built_in">set</span> nonu)</span><br><span class="line">    2. <span class="hljs-built_in">set</span> list (특수(개행) 문자 표시.. 반대는 <span class="hljs-built_in">set</span> nolist)</span><br></pre></td></tr></tbody></table></figure><h2 id="Shell-script-syntax"><a href="#Shell-script-syntax" class="headerlink" title="Shell script syntax"></a>Shell script syntax</h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 변수와 할당되는 값사이에 빈공간 있으면 않됨! </span><br><span class="line">2. 명령결과 치환 : 변수=`명령어` 와 같이 하면, 변수에는 명령어 결과가 들어간다. 와우</span><br><span class="line">    1. TEST=`expr 1 + 1` 혹은 TEST6=`expr 205 + \( 3 \* 4 \)`</span><br></pre></td></tr></tbody></table></figure><p>Example)</p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">"숫자 A를 입력하세요:"</span></span><br><span class="line"><span class="hljs-built_in">read</span> VAR1</span><br><span class="line"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">"숫자 B를 입력하세요:"</span></span><br><span class="line"><span class="hljs-built_in">read</span> VAR2</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span>[ <span class="hljs-variable">$VAR1</span> -eq <span class="hljs-variable">$VAR2</span> ]</span><br><span class="line">    <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">" 숫자 A와 B는 같습니다."</span></span><br><span class="line">        <span class="hljs-keyword">elif</span> [ <span class="hljs-variable">$VAR1</span> -ge <span class="hljs-variable">$VAR2</span> ]</span><br><span class="line">            <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">"숫자 A는 B보다 크거나 같습니다."</span></span><br></pre></td></tr></tbody></table></figure><h2 id="Useful-composed-commands"><a href="#Useful-composed-commands" class="headerlink" title="Useful composed commands"></a>Useful composed commands</h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># Kill process by PROCESS_NAME</span></span><br><span class="line"><span class="hljs-comment"># like $ sudo kill -9 `ps -ef | grep EppClient | grep -v 'grep' | awk '{print $2}'`</span></span><br><span class="line">$ <span class="hljs-built_in">kill</span> -9 `ps -ef | grep <span class="hljs-string">'PROCESS_NAME'</span> | awk {<span class="hljs-built_in">print</span> <span class="hljs-variable">$2</span>}` </span><br><span class="line"></span><br><span class="line">$ sudo ls -al /var/lib/docker/containers/ | grep `docker ps -a | grep <span class="hljs-string">'DOCKER_CONTAINER_NAME'</span> | awk <span class="hljs-string">'{print $1}'</span>` | awk <span class="hljs-string">'{print "/var/lib/docker/containers/"$9}'</span></span><br></pre></td></tr></tbody></table></figure><h1 id="VI-Tips"><a href="#VI-Tips" class="headerlink" title="VI Tips"></a>VI Tips</h1><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">## Replace all</span></span><br><span class="line"><span class="hljs-comment"># %s/before/after\r/g </span></span><br><span class="line"><span class="hljs-comment"># 위 명령어로 before 를 after(개행) 으로 처리하며 이를 /g 모두 반영한다.</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 공백 모두 제거</span></span><br><span class="line"><span class="hljs-comment"># %s/ \+$//</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ^M 문자가 엄청 포함되어 있을때, 제거하기</span></span><br><span class="line"><span class="hljs-comment"># :e ++ff=dos</span></span><br><span class="line"><span class="hljs-comment"># :set ff=unix</span></span><br><span class="line"><span class="hljs-comment"># :wq</span></span><br></pre></td></tr></tbody></table></figure></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2019/04/08/shell-command-and-script/#disqus_thread</comments>
    </item>
    
    <item>
      <title>About Redis</title>
      <link>http://ddongeee.github.io/2018/11/12/about-redis/</link>
      <guid>http://ddongeee.github.io/2018/11/12/about-redis/</guid>
      <pubDate>Mon, 12 Nov 2018 02:50:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;Redis&quot;&gt;&lt;a href=&quot;#Redis&quot; class=&quot;headerlink&quot; title=&quot;Redis&quot;&gt;&lt;/a&gt;Redis&lt;/h1&gt;&lt;h2 id=&quot;REDIS-개요&quot;&gt;&lt;a href=&quot;#REDIS-개요
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><h2 id="REDIS-개요"><a href="#REDIS-개요" class="headerlink" title="REDIS 개요"></a>REDIS 개요</h2><h3 id="REDIS란"><a href="#REDIS란" class="headerlink" title="REDIS란?"></a>REDIS란?</h3><p>REmote DIctionary Server, 디스크 기반이 아닌 인메모리 기반 데이터 저장소이다. 메모리를 사용하기 때문에 매우 빠른 장점이 있으며, 고가용성 및 샤딩을 통한 파티셔닝을 지원한다. 하지만 단점으로는 메모리 크기에 한정적이다. 아직까지는 동일 용량의 디스크 대비 메모리 가격이 비싸다. 그래서 사용하는 메모리 용량에 따라 경제적 부담을 져야하는 기회비용에 직면하게 된다. 또한 레디스는 키벨류 베이스의 디비로써, 복잡한 연산의 데이터베이스 방식에는 적절하지 않으나?! 아래 소개하는 spring data redis 로 구현은?! 할수 있다. 하지만, 여기에도 장단이 존재한다.. 관련해서 아래에서 알아보자. </p><p>리스트 데이터 입력 삭제가 MYSQL 대비 10배 빠르다고함! MAX <strong>100,000 QPS</strong></p><p>Redis서버는 1개의 싱글 쓰레드로 수행, 따라서 하나의 서버에 여러개의 서버 띄우는게 가능, 또한 이러한 특성으로 다양한 이슈가 만들어 질수 있음</p><h3 id="REDIS-vs-MEMCACHED"><a href="#REDIS-vs-MEMCACHED" class="headerlink" title="REDIS vs MEMCACHED"></a>REDIS vs MEMCACHED</h3><ul><li><p>둘다 속도는 100000QPS 로 비슷</p></li><li><p>둘다 샤딩을 통한 클러스터링 모드 지원</p></li><li><p>자료구조는 레디스가 많이 지원, 멤케시는 key-value만 지원</p></li><li><p>안정성의경우, 멤케시는 장애가 거의 없으나, 레디스의 경우 특성을 잘못 이해할경우 프로세스 장애 발생. flush_all 같은경우</p></li><li><p>응답속도의 균일성의 경우, 멤케시는 전체적으로 균일하나, 레디스는 멤케시에 비해 균일성이 떨어 질수 있음, 롱쿼리..</p></li><li><p>장애대응 혹은 영속성의경우, 레디스는 RDB(Snapshot)와 AOF(Journal)지원, 하지만 맴케시는 프로세스 재시작시 데이터 모두 날라감. 멤캐시 철학은 약간 “캐시는 정말 캐시 용도로만 써야되고, 데이터 초기화시 다시 원천소스를 조회하여 캐싱해야한다.” 와 같음</p></li><li><p>멤케시의 경우 ‘라이브러리로’ master/master 리플리케이션만 지원, 하지만 레디스는 ‘자체기능’으로 (master/slave)리플리케이션만 지원</p></li></ul><h3 id="REDIS-DATA-TYPE"><a href="#REDIS-DATA-TYPE" class="headerlink" title="REDIS DATA TYPE"></a>REDIS DATA TYPE</h3><p>아래에서 설명하는 데이터타입의경우, 실제 key-value 에서 value에 저장되는 데이터 타입을 말한다. 이것을 반드시 인지하고있어야한다.</p><ul><li>String<ul><li>동작 및 특징<ul><li>가장 기본이 되는 타입</li></ul></li><li>용도<ul><li>HTML 페이지, API 응답 이미지, 비디오, 텍스트, 바이너리 데이터 등 캐시</li><li>개수 계산이 필요한 페이지뷰, 비디오뷰 좋아요 같은 서비스</li></ul></li></ul></li><li>Hash<ul><li>동작 및 특징<ul><li>키값에 해당되는 필드를 선택적으로 가져올수 잇다. </li><li>객체를 저장하는데 훌륭</li></ul></li><li>용도<ul><li>특정 Key 값에 여러 field(hashKey)가 존재하여, 다양한 케이스에서 선택적으로 value를 가져와야하는경우</li></ul></li></ul></li><li>List<ul><li>동작 및 특징<ul><li>collection, stack, queue와 같이 동작 할수 있음</li></ul></li><li>용도<ul><li>이벤트큐, 최근 사용자 글 저장하기등</li></ul></li></ul></li><li>Set <ul><li>동작 및 특징<ul><li>순서없고, 동일한 값이 없는 콜렉션 특성을 가지고 있다. (추가,삭제,검색 성능 속도 O(1))</li><li>내부는 hash table 로 구현되있다.</li><li>교집합, 합집합 빠르게 계산</li></ul></li><li>용도<ul><li>데이터 필터링 : 특정도시에서 출발해서 특정도시로 도착하는 모든 비행기 필터링?</li><li>데이터 그룹핑 : 비슷한 제품을 보는 모든 사용자 그룹핑</li><li>엘리먼트십 확인 : 블랙리스트확인 혹은 사용자가 이미 푸시를 받앗는지 확인하기(dup check)</li></ul></li></ul></li><li>Sorted Set<ul><li>동작 및 특징</li><li>용도</li></ul></li><li><strong>BitMap</strong><ul><li>동작 및 특징<ul><li>특정 인덱스에 값을 0 또는 1로 set 및 get이 가능하다.</li><li>단일 저장 용량이 1Bit 라서, 메모리를 아주 적게 사용하여 스냅샷 서비스를 제공할수 있다.</li></ul></li><li>용도<ul><li>오늘 방문한 순수 사용자, 혹은 카운트</li><li>특정 모바일 아이디에 중복 발송을 필터링하기위한 테이블</li></ul></li></ul></li><li>HyperLogLog<ul><li>동작 및 특징</li><li>용도</li></ul></li></ul><h3 id="REDIS-PERSISTENCE"><a href="#REDIS-PERSISTENCE" class="headerlink" title="REDIS PERSISTENCE"></a>REDIS PERSISTENCE</h3><ul><li><p>시스템의 영속성을 보장하기위해 레디스에선 데이터를 디스크에 백업해 놓는 2가지 방식을 제공하고 있다.</p><ul><li><strong>Snapshotting</strong> : 레디스에 저장된 데이터를 바이너리 스냅샷으로 생성(메모리 덤프) > RDB 모드<ul><li>fork 로 자식 프로세스 생성하여 저장하는 방식<ul><li><strong>쓰기 작업이 많아지면 부모와 자식 둘다 같은 크기의 메모리를 사용할수 있음. 메모리 부족 이슈 가능</strong></li></ul></li><li>설정파일에 save 900 1 , save 300 60, save 60 10000 과 같이 설정</li></ul></li><li><strong>Journaling</strong> : 시간이 지나면서 요청된 커맨드를 사람이 읽을수 있는 파일로 생성 > AOF 모드</li></ul></li><li><p>만약 재기동 시점에 둘다 있으면, AOF 가 가장 마지막까지 실행됫다고 가정하고, AOF 모드로 재실행</p></li><li><p>하지만 이러한 persistence 기능이 장애의 주된 원인이 될수있어서, 아주 잘 사용해야 한다.</p></li></ul><h3 id="KEY-EXPIREATION-TRANSACTION-PUB-SUB"><a href="#KEY-EXPIREATION-TRANSACTION-PUB-SUB" class="headerlink" title="KEY EXPIREATION, TRANSACTION, PUB/SUB"></a>KEY EXPIREATION, TRANSACTION, PUB/SUB</h3><h4 id="KEY-EXPIREATION"><a href="#KEY-EXPIREATION" class="headerlink" title="KEY EXPIREATION"></a>KEY EXPIREATION</h4><p>key 값에 expireTime 지정이 가능하며, 해당 만료 시간을 기준으로 데이터가 삭제된다. 2가지 방식이 있으며, 초단위로 설정하거나 종료시점 날짜를 설정하여 만료시킬수 있음</p><p>맴케시의경우, 사용자가 get할때 expire체크를 하여 만료작업을 처리하지만, 레디스는 이 방법과 더불어 내부적으로 cron()을 돌려 추가적으로 만료작업을 진행한다.</p><h4 id="TRANSACTION"><a href="#TRANSACTION" class="headerlink" title="TRANSACTION"></a>TRANSACTION</h4><h4 id="PUB-SUB"><a href="#PUB-SUB" class="headerlink" title="PUB/SUB"></a>PUB/SUB</h4><h3 id="REDIS-CLUSTER"><a href="#REDIS-CLUSTER" class="headerlink" title="REDIS CLUSTER"></a>REDIS CLUSTER</h3><p>레디스 시스템 성능 확장을 위해 클러스터 모드로 레디스를 실행할수 있다. </p><p>노드간에 처리 대상은 수평분할(샤딩)의 한 방식인 해시분할(Hash partitioning)에 의해서 결정된다</p><p>해시분할방식은, 해시함수에 키값을 넣어 정수값(0~16383)을 추출, 각 마스터 노드 해시슬롯 범위에 포함된 곳에서 처리되도록 한다.</p><p>이러한 Hash key slot을 사용하여 샤딩방식으로 트래픽을 클러스터 노드별로 분산한다.</p><h3 id="REDIS-REPLICATION"><a href="#REDIS-REPLICATION" class="headerlink" title="REDIS REPLICATION"></a>REDIS REPLICATION</h3><ul><li>혹시모를 장애로 마스터 서버 이슈로, 데이터 유실 혹은 read 트래픽 분산을 위해 레디스 또한 데이터 리플리케이션 기능을 제공한다.</li><li>master / slave 복제 방식이다</li></ul><h3 id="REDIS-HA-High-Avaliability"><a href="#REDIS-HA-High-Avaliability" class="headerlink" title="REDIS HA(High Avaliability)"></a>REDIS HA(High Avaliability)</h3><ul><li>기본적으론 레디스 센티널 HA 컨트롤 되긴함.</li><li>m/s 복제 되어잇어야함</li><li>redis2.6부터 slave-read-only가 yes로 되어 있어, 무조건 마스터승격 시에 쓰기 요청 모두 실패됨. 추가설정필요..</li><li>하지만, 아주 다행히 AWS Elastic cache:Redis 사용시 replication, multi-az 2개 설정만으로 자동 장애복구 지원됨.<ul><li>replica 만 선택하고, multi-az 설정안하면, 사용자가 직접 마스터 승격시켜줘야하니.. multi-az 설정까지 해주자.ㅎㅎ</li><li>참고 : <a href="https://aws.amazon.com/ko/elasticache/faqs#다중_AZ" target="_blank" rel="external nofollow noopener noreferrer">https://aws.amazon.com/ko/elasticache/faqs#다중_AZ</a></li></ul></li></ul><h2 id="REDIS-적용"><a href="#REDIS-적용" class="headerlink" title="REDIS 적용"></a>REDIS 적용</h2><h3 id="‘’터미널’’에서-REDIS-클러스터-로컬환경-구축-및-사용"><a href="#‘’터미널’’에서-REDIS-클러스터-로컬환경-구축-및-사용" class="headerlink" title="‘’터미널’’에서 REDIS (클러스터) 로컬환경 구축 및 사용"></a>‘’터미널’’에서 REDIS (클러스터) 로컬환경 구축 및 사용</h3><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># redis가 로컬에 설치 되엇다는 가정하에 아래 실습을 진행할수 있다. </span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 6379 포트로 redis를 띄운다.</span></span><br><span class="line">$ redis-server</span><br><span class="line">127.0.0.1:6379> {{redis <span class="hljs-built_in">command</span>}}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># redis-cli는 레디스에 커맨드를 실행할수 있게 해준다. </span></span><br><span class="line"><span class="hljs-comment"># 아래는 해당 노드에 저장된 값의 size를 알수있는 command</span></span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 5000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">### 실제 로컬에서 띄울때 클러스터 모드로 띄워도 될듯!! 아래는 그 방법###</span></span><br><span class="line"></span><br><span class="line">$ redis-server --port 5000 --cluster-enabled yes --cluster-config-file nodes-5000.conf --cluster-node-timeout 2000 --cluster-slave-validity-factor 10 --cluster-migration-barrier 1 --cluster-require-full-coverage yes --dbfilename dump-5000.rdb --daemonize yes</span><br><span class="line"></span><br><span class="line">$ redis-server --port 5001 --cluster-enabled yes --cluster-config-file nodes-5001.conf --cluster-node-timeout 2000 --cluster-slave-validity-factor 10 --cluster-migration-barrier 1 --cluster-require-full-coverage yes --dbfilename dump-5001.rdb --daemonize yes</span><br><span class="line"></span><br><span class="line">$ redis-server --port 5002 --cluster-enabled yes --cluster-config-file nodes-5002.conf --cluster-node-timeout 2000 --cluster-slave-validity-factor 10 --cluster-migration-barrier 1 --cluster-require-full-coverage yes --dbfilename dump-5002.rdb --daemonize yes</span><br><span class="line"></span><br><span class="line">$ redis-cli -c -p 5000 cluster addslots {0..5460}</span><br><span class="line">$ redis-cli -c -p 5001 cluster addslots {5461..10922}</span><br><span class="line">$ redis-cli -c -p 5002 cluster addslots {10923..16383}</span><br><span class="line"></span><br><span class="line">$ redis-cli -c -p 5000 cluster <span class="hljs-built_in">set</span>-config-epoch 1</span><br><span class="line">$ redis-cli -c -p 5001 cluster <span class="hljs-built_in">set</span>-config-epoch 2</span><br><span class="line">$ redis-cli -c -p 5002 cluster <span class="hljs-built_in">set</span>-config-epoch 3</span><br><span class="line"></span><br><span class="line">$ redis-cli -c -p 5000 cluster meet 127.0.0.1 5001</span><br><span class="line">$ redis-cli -c -p 5000 cluster meet 127.0.0.1 5002</span><br><span class="line"></span><br><span class="line">$ redis-cli -c -p 6000 cluster meet 127.0.0.1 5000</span><br><span class="line">$ redis-cli -c -p 6001 cluster meet 127.0.0.1 5000</span><br><span class="line">$ redis-cli -c -p 6002 cluster meet 127.0.0.1 5000</span><br><span class="line">$ redis-cli -c -p 6003 cluster meet 127.0.0.1 5000</span><br><span class="line">$ redis-cli -c -p 6004 cluster meet 127.0.0.1 5000</span><br><span class="line">$ redis-cli -c -p 6005 cluster meet 127.0.0.1 5000</span><br><span class="line"></span><br><span class="line">$ redis-cli -c -p 6000 cluster replicate {{masterNodeIdForReplica}}</span><br><span class="line">$ redis-cli -c -p 6001 cluster replicate {{masterNodeIdForReplica}}</span><br><span class="line">$ redis-cli -c -p 6002 cluster replicate {{masterNodeIdForReplica}}</span><br><span class="line">$ redis-cli -c -p 6003 cluster replicate {{masterNodeIdForReplica}}</span><br><span class="line">$ redis-cli -c -p 6004 cluster replicate {{masterNodeIdForReplica}}</span><br><span class="line">$ redis-cli -c -p 6005 cluster replicate {{masterNodeIdForReplica}}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 클러스터 모드에서 사용</span></span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 5000 -c</span><br><span class="line">127.0.0.1:5000> <span class="hljs-built_in">set</span> hello world</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:5000> get hello</span><br><span class="line"><span class="hljs-string">"world"</span></span><br><span class="line">127.0.0.1:5000> <span class="hljs-built_in">set</span> hello2 world2</span><br><span class="line">-> Redirected to slot [7486] located at 127.0.0.1:5001</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:5001> get hello2</span><br><span class="line"><span class="hljs-string">"world2"</span></span><br></pre></td></tr></tbody></table></figure><h3 id="REDIS-Client-Library-각-라이브러리-장단점"><a href="#REDIS-Client-Library-각-라이브러리-장단점" class="headerlink" title="REDIS Client Library(각 라이브러리 장단점)"></a>REDIS Client Library(각 라이브러리 장단점)</h3><p>java base의 redis client libracy 중에 recommed 하는 라이브러리는 크게 3가지 Jedis, Lettuce, Redisson가 있다.</p><h4 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h4><ul><li>small</li></ul><h4 id="Lettuce"><a href="#Lettuce" class="headerlink" title="Lettuce"></a>Lettuce</h4><ul><li>thread-safe sync</li><li>async</li></ul><h4 id="REDISON"><a href="#REDISON" class="headerlink" title="REDISON"></a>REDISON</h4><ul><li>비동기 하이퍼포먼스</li><li>lock free redis client</li></ul><h3 id="AWS-REDIS-소개"><a href="#AWS-REDIS-소개" class="headerlink" title="AWS REDIS 소개"></a>AWS REDIS 소개</h3><p>AWS 의 서비스중에 <strong>ElasticCache</strong> 라는 것이 있는데, 해당 서비스는 인메모리 서비스 그룹으로, 실제로 해당 서비스 실행을 위해 Redis를 쓸지 Memchaed를 쓸지 선택할수 있다. AWS의 인프라 제공 능력?!으로 클릭 몇번으로 클러스터기반 마스터슬래이브 레디스 서비스를 실행할수 있다. (자동 장애복구 기능도 지원한당. 짜응)</p><h2 id="기타-알면-좋은것들"><a href="#기타-알면-좋은것들" class="headerlink" title="기타 알면 좋은것들"></a>기타 알면 좋은것들</h2><h3 id="SPRINT-DATA-REDIS-Spring-data-redis-lettuce"><a href="#SPRINT-DATA-REDIS-Spring-data-redis-lettuce" class="headerlink" title="SPRINT DATA REDIS (Spring data redis + lettuce)"></a>SPRINT DATA REDIS (Spring data redis + lettuce)</h3><h4 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h4><figure class="highlight java hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// entity class</span></span><br><span class="line"><span class="hljs-meta">@Getter</span></span><br><span class="line"><span class="hljs-meta">@Builder</span></span><br><span class="line"><span class="hljs-meta">@AllArgsConstructor</span>(access = AccessLevel.PRIVATE)</span><br><span class="line"><span class="hljs-meta">@NoArgsConstructor</span></span><br><span class="line"><span class="hljs-meta">@ToString</span></span><br><span class="line"><span class="hljs-meta">@RedisHash</span>(<span class="hljs-string">"pushResult"</span>)</span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PushResult</span> </span>{</span><br><span class="line"><span class="hljs-meta">@Id</span></span><br><span class="line"><span class="hljs-keyword">private</span> Long id;</span><br><span class="line"><span class="hljs-meta">@Indexed</span></span><br><span class="line"><span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> mobileSeq;</span><br><span class="line"><span class="hljs-meta">@Indexed</span></span><br><span class="line"><span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> campaignId;</span><br><span class="line"><span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> offerId;</span><br><span class="line"><span class="hljs-meta">@Indexed</span></span><br><span class="line"><span class="hljs-keyword">private</span> LocalDateTime preferredAt;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// *RedisRepository interface</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">PushResultRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CrudRepository</span><<span class="hljs-title">PushResult</span>, <span class="hljs-title">Long</span>> </span>{</span><br><span class="line"><span class="hljs-function">PushResult <span class="hljs-title">findByMobileSeqAndCampaignId</span><span class="hljs-params">(Long mobileSeq, Long cId)</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// service class</span></span><br><span class="line"><span class="hljs-meta">@Service</span></span><br><span class="line"><span class="hljs-keyword">public</span> PushResultService {</span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-keyword">private</span> PushResultRepository pushResultRepository;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(PushResult pushResult)</span> </span>{</span><br><span class="line">        pushResultRepository.save(pushResult);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> PushResult <span class="hljs-title">getByMobileSeqAndCId</span><span class="hljs-params">(Long mobileSeq, Long cId)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> pushResultRepository.findByMobileSeqAndCampaignId(mobileSeq, cId);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="동작"><a href="#동작" class="headerlink" title="동작"></a>동작</h4><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">###############################################################</span></span><br><span class="line"><span class="hljs-comment"># 위 spring data jpa 를 사용하여 1건의 pushResult 를 save 할경우 #</span></span><br><span class="line"><span class="hljs-comment">###############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># redis cluster nodes 에 저장된 key 개수 </span></span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 5000 dbsize</span><br><span class="line">(<span class="hljs-built_in">integer</span>) 2</span><br><span class="line"></span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 5001 dbsize</span><br><span class="line">(<span class="hljs-built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 5002 dbsize</span><br><span class="line">(<span class="hljs-built_in">integer</span>) 3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># redis cluster nodes 에 저장된 key 종류</span></span><br><span class="line">$ 127.0.0.1:5000> keys *</span><br><span class="line">1) <span class="hljs-string">"pushResult:campaignId:223456"</span></span><br><span class="line">2) <span class="hljs-string">"pushResult:-7496779863478802681:idx"</span></span><br><span class="line"></span><br><span class="line">$ 127.0.0.1:5001> keys *</span><br><span class="line">1) <span class="hljs-string">"pushResult:preferredAt:2018-10-16T15:49:12.949"</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-variable">$127</span>.0.0.1:5002> keys *</span><br><span class="line">1) <span class="hljs-string">"pushResult:mobileSeq:123456"</span></span><br><span class="line">2) <span class="hljs-string">"pushResult:-7496779863478802681"</span></span><br><span class="line">3) <span class="hljs-string">"pushResult"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 각 key 에 대한 value</span></span><br><span class="line">$ 127.0.0.1:5000> smembers pushResult:campaignId:223456</span><br><span class="line">1) <span class="hljs-string">"-7496779863478802681"</span></span><br><span class="line">$ 127.0.0.1:5000> smembers pushResult:-7496779863478802681:idx</span><br><span class="line">1) <span class="hljs-string">"pushResult:mobileSeq:123456"</span></span><br><span class="line">2) <span class="hljs-string">"pushResult:campaignId:223456"</span></span><br><span class="line">3) <span class="hljs-string">"pushResult:preferredAt:2018-10-16T15:49:12.949"</span></span><br><span class="line"></span><br><span class="line">$ 127.0.0.1:5001> smembers pushResult:preferredAt:2018-10-16T15:49:12.949</span><br><span class="line">1) <span class="hljs-string">"-7496779863478802681"</span></span><br><span class="line"></span><br><span class="line">$ 127.0.0.1:5002> smembers pushResult:mobileSeq:123456</span><br><span class="line">1) <span class="hljs-string">"-7496779863478802681"</span></span><br><span class="line">$ 127.0.0.1:5002> smembers pushResult</span><br><span class="line">1) <span class="hljs-string">"-7496779863478802681"</span></span><br><span class="line">$ 127.0.0.1:5002> hkeys pushResult:-7496779863478802681</span><br><span class="line">1) <span class="hljs-string">"_class"</span></span><br><span class="line">2) <span class="hljs-string">"mobileSeq"</span></span><br><span class="line">3) <span class="hljs-string">"id"</span></span><br><span class="line">4) <span class="hljs-string">"mobileSeq._class"</span></span><br><span class="line">5) <span class="hljs-string">"offerId"</span></span><br><span class="line">6) <span class="hljs-string">"offerId._class"</span></span><br><span class="line">7) <span class="hljs-string">"campaignId"</span></span><br><span class="line">8) <span class="hljs-string">"campaignId._class"</span></span><br><span class="line">9) <span class="hljs-string">"preferredAt"</span></span><br><span class="line">$ 127.0.0.1:5002> hgetall pushResult:-7496779863478802681</span><br><span class="line"> 1) <span class="hljs-string">"mobileSeq._class"</span></span><br><span class="line"> 2) <span class="hljs-string">"java.lang.Long"</span></span><br><span class="line"> 3) <span class="hljs-string">"offerId"</span></span><br><span class="line"> 4) <span class="hljs-string">"123456"</span></span><br><span class="line"> 5) <span class="hljs-string">"offerId._class"</span></span><br><span class="line"> 6) <span class="hljs-string">"java.lang.Long"</span></span><br><span class="line"> 7) <span class="hljs-string">"campaignId"</span></span><br><span class="line"> 8) <span class="hljs-string">"223456"</span></span><br><span class="line"> 9) <span class="hljs-string">"campaignId._class"</span></span><br><span class="line">10) <span class="hljs-string">"java.lang.Long"</span></span><br><span class="line">11) <span class="hljs-string">"mobileSeq"</span></span><br><span class="line">12) <span class="hljs-string">"123456"</span></span><br><span class="line">13) <span class="hljs-string">"_class"</span></span><br><span class="line">14) <span class="hljs-string">"com.~.pushcontroller.domain.result.PushResult"</span></span><br><span class="line">15) <span class="hljs-string">"id"</span></span><br><span class="line">16) <span class="hljs-string">"-7496779863478802681"</span></span><br><span class="line">17) <span class="hljs-string">"preferredAt"</span></span><br><span class="line">18) <span class="hljs-string">"2018-10-16T15:49:12.949"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">############################## 위 명령어가 다른이유 ##############################</span></span><br><span class="line"><span class="hljs-comment"># if value is of type string -> GET <key></span></span><br><span class="line"><span class="hljs-comment"># if value is of type hash -> HGETALL <key></span></span><br><span class="line"><span class="hljs-comment"># if value is of type lists -> lrange <key> <start> <end></span></span><br><span class="line"><span class="hljs-comment"># if value is of type sets -> smembers <key></span></span><br><span class="line"><span class="hljs-comment"># if value is of type sorted sets -> ZRANGEBYSCORE <key> <min> <max></span></span><br><span class="line"><span class="hljs-comment">#############################################################################</span></span><br></pre></td></tr></tbody></table></figure><h4 id="REDIS-비교-결과"><a href="#REDIS-비교-결과" class="headerlink" title="REDIS 비교 결과"></a>REDIS 비교 결과</h4><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">##############################</span></span><br><span class="line"><span class="hljs-comment"># [Local 환경]퍼포먼스 테스트 결과 #</span></span><br><span class="line"><span class="hljs-comment">##############################</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># master 3, slave6, network high</span></span><br><span class="line"><span class="hljs-comment"># Redisson (pure redis client): 10000/sec</span></span><br><span class="line"><span class="hljs-comment"># spring data redis : 33.3/sec</span></span><br></pre></td></tr></tbody></table></figure><h3 id="Commands"><a href="#Commands" class="headerlink" title="Commands"></a>Commands</h3><h4 id="CLUSTER-INFO"><a href="#CLUSTER-INFO" class="headerlink" title="CLUSTER INFO"></a>CLUSTER INFO</h4><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># cluster meet 전</span></span><br><span class="line">cluster_state:fail</span><br><span class="line">cluster_slots_assigned:0</span><br><span class="line">cluster_slots_ok:0</span><br><span class="line">cluster_slots_pfail:0</span><br><span class="line">cluster_slots_fail:0</span><br><span class="line">cluster_known_nodes:1</span><br><span class="line">cluster_size:0</span><br><span class="line">cluster_current_epoch:0</span><br><span class="line">cluster_my_epoch:0</span><br><span class="line">cluster_stats_messages_sent:0</span><br><span class="line">cluster_stats_messages_received:0</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># cluster meet 후</span></span><br><span class="line">cluster_state:ok</span><br><span class="line">cluster_slots_assigned:16384</span><br><span class="line">cluster_slots_ok:16384</span><br><span class="line">cluster_slots_pfail:0</span><br><span class="line">cluster_slots_fail:0</span><br><span class="line">cluster_known_nodes:3</span><br><span class="line">cluster_size:3</span><br><span class="line">cluster_current_epoch:3</span><br><span class="line">cluster_my_epoch:1</span><br><span class="line">cluster_stats_messages_ping_sent:553</span><br><span class="line">cluster_stats_messages_pong_sent:553</span><br><span class="line">cluster_stats_messages_meet_sent:2</span><br><span class="line">cluster_stats_messages_sent:1108</span><br><span class="line">cluster_stats_messages_ping_received:553</span><br><span class="line">cluster_stats_messages_pong_received:555</span><br><span class="line">cluster_stats_messages_received:1108</span><br></pre></td></tr></tbody></table></figure><h4 id="CLUSTER-KEYSLOT"><a href="#CLUSTER-KEYSLOT" class="headerlink" title="CLUSTER KEYSLOT "></a>CLUSTER KEYSLOT </h4><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ 127.0.0.1:5000> cluster keyslot pushResult:campaignId:225763</span><br><span class="line">(<span class="hljs-built_in">integer</span>) 11216</span><br></pre></td></tr></tbody></table></figure><h4 id="CLIENT-LIST"><a href="#CLIENT-LIST" class="headerlink" title="CLIENT LIST"></a>CLIENT LIST</h4><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ 127.0.0.1:5000> client list</span><br><span class="line">id=320 addr=127.0.0.1:49228 fd=320 name= age=1890 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=client</span><br><span class="line">id=16 addr=127.0.0.1:63855 fd=16 name= age=2452 idle=2416 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=cluster</span><br></pre></td></tr></tbody></table></figure><h3 id="redis-trib-rb-사용하기"><a href="#redis-trib-rb-사용하기" class="headerlink" title="# redis-trib.rb 사용하기"></a># redis-trib.rb 사용하기</h3><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># redis cluster info</span></span><br><span class="line"><<<<<<< HEAD:_drafts/about-redis.md</span><br><span class="line"><span class="hljs-comment"># /Development/study/redis/redis-stable/src/redis-trib.rb </span></span><br><span class="line">=======</span><br><span class="line">>>>>>>> 8199a64e366805ddde1586b4cf8444993e165799:_posts/2018-11-11-about-redis.md</span><br><span class="line">$./redis-trib.rb info 127.0.0.1:5000</span><br><span class="line">127.0.0.1:5000 (8b4b5f3a...) -> 2 keys | 5461 slots | 0 slaves.</span><br><span class="line">127.0.0.1:5001 (9865af8c...) -> 0 keys | 5462 slots | 0 slaves.</span><br><span class="line">127.0.0.1:5002 (21ca40a9...) -> 4 keys | 5461 slots | 0 slaves.</span><br><span class="line">[OK] 6 keys <span class="hljs-keyword">in</span> 3 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># check</span></span><br><span class="line">$./redis-trib.rb check 127.0.0.1:5000</span><br><span class="line">>>> Performing Cluster Check (using node 127.0.0.1:5000)</span><br><span class="line">M: 8b4b5f3aa0357331c644f2cf678a3b5eb7b42aa6 127.0.0.1:5000</span><br><span class="line">   slots:0-5460 (5461 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">M: 9865af8cda8dca53a8e5776900961540566af4aa 127.0.0.1:5001</span><br><span class="line">   slots:5461-10922 (5462 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">M: 21ca40a9a2c8e178943d0b5311dbc4308ddd8438 127.0.0.1:5002</span><br><span class="line">   slots:10923-16383 (5461 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line">>>> Check <span class="hljs-keyword">for</span> open slots...</span><br><span class="line">>>> Check slots coverage...</span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># call ex1</span></span><br><span class="line">$./redis-trib.rb call 127.0.0.1:5000 dbsize</span><br><span class="line">>>> Calling DBSIZE</span><br><span class="line">127.0.0.1:5000: 2</span><br><span class="line">127.0.0.1:5001: 0</span><br><span class="line">127.0.0.1:5002: 4</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># call ex2</span></span><br><span class="line">$./redis-trib.rb call 127.0.0.1:5000 keys <span class="hljs-string">'*'</span></span><br><span class="line">>>> Calling KEYS *</span><br><span class="line">127.0.0.1:5000: [<span class="hljs-string">"pushResult:preferredAt:2018-10-16T16:54:38.601"</span>, <span class="hljs-string">"pushResult:campaignId:223456"</span>]</span><br><span class="line">127.0.0.1:5001: []</span><br><span class="line">127.0.0.1:5002: [<span class="hljs-string">"pushResult:mobileSeq:123456"</span>, <span class="hljs-string">"pushResult:-1799219234927987399:idx"</span>, <span class="hljs-string">"pushResult:-1799219234927987399"</span>, <span class="hljs-string">"pushResult"</span>]</span><br></pre></td></tr></tbody></table></figure><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># 35개의 pushResult에 대해서 176개의 key 가 생성 되었고, 소요시간은 10초...</span></span><br><span class="line">$ ./redis-trib.rb info endpoint.clustercfg.apn2.cache.amazonaws.com:6379</span><br><span class="line">10.213.145.56:6379 (38a8538d...) -> 65 keys | 5461 slots | 2 slaves.</span><br><span class="line">10.213.145.43:6379 (84128d7b...) -> 62 keys | 5461 slots | 2 slaves.</span><br><span class="line">10.213.145.50:6379 (6fdadcab...) -> 49 keys | 5462 slots | 2 slaves.</span><br><span class="line">[OK] 176 keys <span class="hljs-keyword">in</span> 3 masters.</span><br><span class="line">0.01 keys per slot on average.</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># (dev) 1224 개의 데이터를 bucket key/value 형태로 저장한결과 102/sec</span></span><br></pre></td></tr></tbody></table></figure><h1 id="참고서적"><a href="#참고서적" class="headerlink" title="참고서적"></a>참고서적</h1><table><thead><tr><th>Memcached 와 Redis</th><th>Redis 운영관리</th><th>Redis 핵심정리</th></tr></thead><tbody><tr><td><img src="https://user-images.githubusercontent.com/10233723/48313335-30530080-e5fe-11e8-8d0b-d95d15afca17.jpeg" alt="b1"></td><td><img src="https://user-images.githubusercontent.com/10233723/48313350-71e3ab80-e5fe-11e8-86a5-139b34d51b0c.jpeg" alt="b2"></td><td><img src="https://user-images.githubusercontent.com/10233723/48313358-89229900-e5fe-11e8-9f66-7feefb995631.jpeg" alt="b3"></td></tr></tbody></table><h1 id="참고사이트"><a href="#참고사이트" class="headerlink" title="참고사이트"></a>참고사이트</h1><ul><li>출처 : <a href="https://redis.io/clients#java" target="_blank" rel="external nofollow noopener noreferrer">https://redis.io/clients#java</a></li><li>출처 : <a href="http://bcho.tistory.com/654" target="_blank" rel="external nofollow noopener noreferrer">http://bcho.tistory.com/654</a></li><li>출처 : <a href="http://bcho.tistory.com/tag/%EA%B0%95%EB%8C%80%EB%AA%85" target="_blank" rel="external nofollow noopener noreferrer">http://bcho.tistory.com/tag/%EA%B0%95%EB%8C%80%EB%AA%85</a> </li><li>출처 : <a href="https://redis.io/" target="_blank" rel="external nofollow noopener noreferrer">https://redis.io/</a></li><li>출처 : <a href="https://aws.amazon.com/ko/elasticache/redis/" target="_blank" rel="external nofollow noopener noreferrer">https://aws.amazon.com/ko/elasticache/redis/</a></li></ul></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2018/11/12/about-redis/#disqus_thread</comments>
    </item>
    
    <item>
      <title>토비&#39;s Spring 3.1 정리</title>
      <link>http://ddongeee.github.io/2018/11/06/toby-spring-summary/</link>
      <guid>http://ddongeee.github.io/2018/11/06/toby-spring-summary/</guid>
      <pubDate>Mon, 05 Nov 2018 23:30:00 GMT</pubDate>
      <description>
      
        
        
          &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;토비’s-Spring-3-1-정리&quot;&gt;&lt;a href=&quot;#토비’s-Spring-3-1-정리&quot; class=&quot;headerlink&quot; title=&quot;토비’s Spring 3.1 정리&quot;&gt;&lt;/a&gt;토비’s Sp
        
      
      </description>
      
      
      <content:encoded><![CDATA[<html><head></head><body><h1 id="토비’s-Spring-3-1-정리"><a href="#토비’s-Spring-3-1-정리" class="headerlink" title="토비’s Spring 3.1 정리"></a>토비’s Spring 3.1 정리</h1><h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><h3 id="스프링이란"><a href="#스프링이란" class="headerlink" title="스프링이란?"></a>스프링이란?</h3><ul><li>웹 어플리케이션 서버를 개발하기 위해 필요한 모델 혹은 API 및 특징등을 제공해 주는 프레임 워크이다</li><li>스프링 컨테이너 제공<ul><li>어플리케이션 컨텍스트로도 불리는 스프링 컨테이너는 서블릿을 등록하여 런타임엔진을 제공한다.</li><li>라이프 사이클을 관리해 준다.</li></ul></li><li>IoC/DI, 서비스추상화, AOP 과 같은 모델 제공<ul><li>IoC/DI는 오브젝트 생명 주기와 의존관계에 대한 모델</li><li>서비스 추상화는, 추상계층을 두어 이식성이 뛰어난, 특정 기술에 종속적이지 않은 어플리케이션을 만들수 있도록한다.</li><li>관점지향프로그래밍 ~</li></ul></li><li>기타 API</li></ul><h2 id="Vol-1-스프링의-이해와-원리"><a href="#Vol-1-스프링의-이해와-원리" class="headerlink" title="Vol. 1 스프링의 이해와 원리"></a>Vol. 1 스프링의 이해와 원리</h2><h3 id="1장-오브젝트와-의존관계"><a href="#1장-오브젝트와-의존관계" class="headerlink" title="1장 오브젝트와 의존관계"></a>1장 오브젝트와 의존관계</h3><h4 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h4><ul><li>스프링은 객체지향 설계 측면에서, 오브젝트를 어떻게 효과적으로 설계하고 구현하고, 사용하고 개선해 나가야할지에 대해서 손쉽게 적용할수 있도록 프레임워크 형태로 제공한다. 해당 장에서는 스프링이 무엇이고 무엇을 제공하고, 오브젝트의 설계와 구현 동작원리에 대해서 설명한다.</li></ul><h4 id="1-1-초난감-DAO"><a href="#1-1-초난감-DAO" class="headerlink" title="1.1 초난감 DAO"></a>1.1 초난감 DAO</h4><h4 id="1-2-DAO-분리"><a href="#1-2-DAO-분리" class="headerlink" title="1.2 DAO 분리"></a>1.2 DAO 분리</h4><ul><li>분리와 확장을 고려한 설계가 필요하다<ul><li>관심사의 분리(SoC : Separation of Concern)<ul><li>관심이 같은 것끼리는 모으고, 관심이 다른것은 따로 분리</li><li>예제에서는 DAO 에 너무 많은 관심사를 분리하는것으로 시작 (ex. DB연결, SQL 실행, Connection 관리)<ul><li>중복코드의 메소드를 추출 및 하나로 관리함으로써, 해당 관심사에 변경이 생겼을경우 하나만 고치면됨</li></ul></li></ul></li><li>템플릿 메소드 패턴<ul><li>상속을 통해 슈퍼클래스의 기능을 확장할때 사용하는 가장 대표적인 패턴</li><li>슈퍼클래스에 기본적인 로직의 흐름을 정의하고, 추상메소드나 오버라이딩 가능한 protected 메소드 등으로 만들어 서브 클래스에서 구현하는 방법</li><li>변하지 않는 기능은 슈퍼클래스에, 자주 변경되며 확장할 기능은 서브클래스에 만든다.</li><li>선택적으로 오버라이드 할수잇는 protected 메소드를 훅(hook) 메소드라 한다.</li></ul></li><li>팩토리 메소드 패턴<ul><li>서브클래스에서 구체적인 오브젝트 생성 방법을 결정하는것</li></ul></li><li>추상 클래스만들어 상속을 통해, 참조하고 구현하는것<ul><li>해당 메소드 하나를 사용하는데에만 관심, 구현레벨에서도 그 하나의 메소드를 구현하는것에만 관심</li><li>하지만 자바는 다중상속 지원안함, 긴밀한 결합관계가 되버린다.</li></ul></li></ul></li></ul><h4 id="1-3-DAO-확장"><a href="#1-3-DAO-확장" class="headerlink" title="1.3 DAO 확장"></a>1.3 DAO 확장</h4><ul><li>클래스분리 및 인터페이스 도입<ul><li>인터페이스는 기능만 정의햇지, 구현방법은 나타나 있지 않아서 확실한 관심사 분리의 개념을 나타낼수 있다.</li><li>하지만 결국엔 코드에 어떤 구현체를 쓸지 명시되어 있어서, 확실한 관심사 분리가 되어있지 않다.</li></ul></li><li>관계설정 책임의 분리<ul><li>현재 오브젝트에서 사용할 다른 오브젝트를 생성자를 통해 주입받는 식으로 개발</li><li>두 오브젝트의 의존관계를 클라이언트로 넘겨, 어떤 구현체를 써야할지에 대한 관심사를 제거하고, 단순히 자기 자신이 어떠한 일만 처리하면 될지에 대한 관심사 만을 가져갈수 있게 되었다.</li><li>결과적으로, 이러한 구현체를 바꿔야 하는 부분이 생기면, 단순히 클라이언트만 수정해 주면 된다.</li></ul></li><li>개방 폐쇄 원칙(OCP, Open-Closed Principle)<ul><li>클래스나 모듈은 확장에는 열려 있어야 하고 변경에는 닫혀 있어야한다. </li></ul></li><li>객체지향 설계 원칙(SOLID) by 로버트 마틴<ul><li>SRP(The Single Responsibility) : 단일책임원칙</li><li>OCP(The Open Closed Principle) : 개방 폐쇄 원칙</li><li>LSP(The Liskov Substitution Principle) : 리스코프 치환 원칙 </li><li>ISP(The Interface Segregation Principle) : 인터페이스 분리 원칙  </li><li>DIP(The Dependency Inversion Principle) : 의존관계 역전 원칙 </li></ul></li><li>높은 응집도와 낮은 결합도 (high coherencde and low coupling)<ul><li>높은 응집도<ul><li>하나의 모듈, 클래스가 하나의 책임 또는 관심사에만 집중되어 있다.</li></ul></li><li>낮은 결합도 <ul><li>하나의 오브젝트가 변경이 일어날 때에 관계를 맺고 잇는 다른 오브젝트에게 변화를 요구하는 정도가 낮다.</li><li>즉 변화로 인한 사이드 이펙트를 적게하는것</li></ul></li></ul></li><li>전략패턴(Strategy Pattern)<ul><li>자신의 기능 맥락(Context)에서, 필요에 따라 변경이 필요한 알고리즘 클래스를 필요에 따라 바꾸서 사용할수 있게 하는 디자인 패턴.</li><li>그러면 결국 스프링 프레임워크 또한 전략패턴으로 설계가 된것이라고 볼수도 있다.</li></ul></li></ul><h4 id="1-4-제어의-역전-IoC"><a href="#1-4-제어의-역전-IoC" class="headerlink" title="1.4 제어의 역전(IoC)"></a>1.4 제어의 역전(IoC)</h4><ul><li>팩토리<ul><li>객체 생성방법을 결정하고, 생성하여 돌려주는 역할 ::: 마치 설계도 로써 작동하는것 같다.</li><li>오브젝트를 생성하는 쪽과 생성된 오브젝트를 사용하는 쪽의 역할과 책임을 분리해준다.</li></ul></li><li>제어의 역전에 관해<ul><li>제어의 역전에서는 오브젝트가 자신이 사용할 오브젝트를 스스로 선택하지도 않고 생성하지도 않는다.</li><li>이러한 모든 오브젝트에 대한 제어 권한을 위임</li><li>서블릿이 한 예<ul><li>서블릿에 대한 제어 권한을 가진 컨테이너가 적절한 시점에 서블릿 클래스의 오브젝트를 만들고 그안의 메소드를 호출한다. </li></ul></li></ul></li><li>라이브러리를 사용하는 애플리케이션 코드는 애플리케이션 흐름을 직접 제어한다. 하지만 프레임워크는 거꾸로 애플리케이션 코드가 프레임워크에 의해 사용된다. 프레임워크가 주도하는 중에 개발자가 만든 애플리케이션 코드를 사용하는 방식! 즉 프레임워크에는 제어의 역전 개념이 적용되어 잇어야 한다!</li><li>이러한 IoC 스타일의 설계와 코드는, 깔끔하고 유연성이 증가하며 확장성이 좋아진다.</li></ul><h4 id="1-5-스프링의-IoC"><a href="#1-5-스프링의-IoC" class="headerlink" title="1.5 스프링의 IoC"></a>1.5 스프링의 IoC</h4><ul><li>스프링 빈<ul><li>스프링 컨테이너가 생성과 관계설정, 사용 등을 제어해 주는 제어의 역전이 적용된 오브젝트</li></ul></li><li>애플리케이션 컨텍스트 <ul><li>빈팩토리를 확장한 개념으로, 스프링빈의 제어를 담당하는 IoC 엔진이라고 보면 된다.</li><li>빈팩토리는 빈을 등록 관리만 하는 기본적 기능을 담당하고, 컨텍스트는 더 나아가 스프링 기능을 추가적으로 지원한다. </li></ul></li><li>컨테이너 혹은 IoC 컨테이너<ul><li>하나의 애플리케이션에는 여러개의 애플리케이션컨텍스트가 존재하고 이를 통틀어 스프링 컨테이너라 부른다.</li></ul></li><li>@Configuration 을 사용하기위해, AnnotaionConfigApplicatoinContext를 사용한다.</li></ul><h4 id="1-6-싱글톤-레지스트리와-오브젝트-스코프"><a href="#1-6-싱글톤-레지스트리와-오브젝트-스코프" class="headerlink" title="1.6 싱글톤 레지스트리와 오브젝트 스코프"></a>1.6 싱글톤 레지스트리와 오브젝트 스코프</h4><ul><li>애플리케이션 컨텍스트는 싱글톤 레지스트리 이다.<ul><li>매번 요청당 객체를 생성하면 부하 이슈가 있기 때문에, 서블릿 클래스당 하나의 오브젝트만 만들어두고, 요청 스레드에서 하나의 오브젝트를 공유해 동시에 사용한다.</li><li>하지만 기본적인 자바 싱글턴 모델은 아래와 같은 이슈가 있다.<ul><li>Private 생성자를 갖고 잇기때문에 상속할수 없다.</li><li>싱글톤은 테스트하기 힘들다.</li><li>서버환경에서는 싱글톤이 하나만 만들어지는것을 보장하지 못한다.</li><li>싱글톤의 사용은 전역 상태를 만들 수 있기 때문에 발람직하지 못하다.</li></ul></li><li>그래서 스프링이 직접 싱글톤 오브젝트를 관리하는 자체 서비스를 만들엇고, 그게 ‘싱글톤 레지스트리’이다.</li><li>기본적으로 싱글톤이 멀티스레드 환경에서 서비스 형태의 오브젝트로 사용되는 경우에는 상태정보를 내부에 갖고 있지 않은 무상태(stateless) 방식으로 만들어 저야 한다. 메소드 파라미터나, 메소드 안에서 생성되는 로컬 변수는 매번 새로운 값을 저장할 독립적인 공간이 만들어지기 때문에 싱글톤 이라고 해도 여러 스레드가 변수의 값을 덮어쓸 일은 없다.</li><li>스프링 빈의 스코프 종류<ul><li>싱글톤<ul><li>컨테이너 내에 한개의 오브젝트만 유지.</li></ul></li><li>프로토타입<ul><li>컨테이너에 빈을 요청할 때마다 매번 새로운 오브젝트를 만들어 준다.</li></ul></li><li>요청(Request)<ul><li>새로운 HTTP 요청당 오브젝트 생성</li></ul></li><li>Session <ul><li>새로운 세션마다 생성</li></ul></li></ul></li></ul></li></ul><h4 id="1-7-의존관계-주입-DI"><a href="#1-7-의존관계-주입-DI" class="headerlink" title="1.7 의존관계 주입(DI)"></a>1.7 의존관계 주입(DI)</h4><ul><li>스프링은 IoC에서 더 나아가 DI 를 해줌으로, 여타 다른 프레임워크와 차별점을 둔다.</li><li>(UML) A –> B : A 가 B에 의존하고 있다. 즉 B의 변경은 A에 영향을 미치지만, A의 변경은 B에 영향을 미치치 않는다.</li><li>(UML) A –|> B : A 는 B를 구현한다. </li><li>DI를 통해 얻을수 있는 이점<ul><li>기능 구현의 교환<ul><li>프로파일에 따라서 서로다른 빈을 주입할수 있다. Ex) 개발디비, 운영디비</li></ul></li><li>부가기능 추가<ul><li>프록시 패턴으로, 한번 랩핑하여 추가 기능을 구현할수 있다. </li></ul></li></ul></li></ul><h4 id="1-8-XML을-이용한-설정"><a href="#1-8-XML을-이용한-설정" class="headerlink" title="1.8 XML을 이용한 설정"></a>1.8 XML을 이용한 설정</h4><ul><li>…</li></ul><h4 id="1-9-정리"><a href="#1-9-정리" class="headerlink" title="1.9 정리"></a>1.9 정리</h4><ul><li>1장에서 한것들..<ul><li>코드분리(SoC, Refectoring)</li><li>인터페이스로 두개의 오브젝트 참조관계를 정의하고 한쪽은 접근, 한쪽은 구현하도록함. (전략패턴)</li><li>개방폐쇄원칙에 따라, 자신의 책임 변경을 제외하고 불필요한 변화가 발생하지 않도록 막아줌</li><li>한쪽의 기능 변화가 다른쪽에 영향을 미치지 않게 하고(낮은 결합도), 자신의 관심사에만 집중(높은 응집성)</li><li>오브젝트 생성 및 관리를, 팩토리에 넘겼다. 그래서 그러한 관리에 책임으로 부터 자유롭게 했다.(IoC)팩토리는 전략패턴</li><li>전통적 싱글톤 패턴에서 벗어나, 스프링은 자체적으로 싱글톤 레지스트리를 통해 싱글톤 빈을 관리한다.</li><li>설계시점에는 인터페이스로 의존성을 느슨하게 만들어놓고, 런타임시에 IoC/DI 에 의해 의존성이 결정된다.</li></ul></li></ul><h3 id="2장-테스트"><a href="#2장-테스트" class="headerlink" title="2장 테스트"></a>2장 테스트</h3><h4 id="서론-1"><a href="#서론-1" class="headerlink" title="서론"></a>서론</h4><ul><li>테스트란 무엇이며, 가치와 장점, 활용전략, 스프링과의 관계. 대표적인 테스트 프레임워크 알아보기</li></ul><h4 id="2-1-USERDAOTEST-다시보기"><a href="#2-1-USERDAOTEST-다시보기" class="headerlink" title="2.1 USERDAOTEST 다시보기"></a>2.1 USERDAOTEST 다시보기</h4><ul><li>다른계층과 분리하여 테스트가 된다면, 각 레이어별로 문제를 빠르게 분리해서 찾아낼수 있다.</li><li>단위테스트<ul><li>개발자 스스로 빨리 피드백 받을수 있다.</li><li>수정된 코드가 기능에 영향을 줄때, 테스트를 통해 안정성을 검증받을수 있다.</li></ul></li></ul><h4 id="2-2-USERDAOTEST-개선"><a href="#2-2-USERDAOTEST-개선" class="headerlink" title="2.2 USERDAOTEST 개선"></a>2.2 USERDAOTEST 개선</h4><ul><li>Junit 프레임워크</li></ul><h4 id="2-3-개발자를-위한-테스팅-프레임워크-JUNIT"><a href="#2-3-개발자를-위한-테스팅-프레임워크-JUNIT" class="headerlink" title="2.3 개발자를 위한 테스팅 프레임워크 JUNIT"></a>2.3 개발자를 위한 테스팅 프레임워크 JUNIT</h4><h4 id="2-4-스프링-테스트-적용"><a href="#2-4-스프링-테스트-적용" class="headerlink" title="2.4 스프링 테스트 적용"></a>2.4 스프링 테스트 적용</h4><h4 id="2-5-학습-테스트로-배우는-스프링"><a href="#2-5-학습-테스트로-배우는-스프링" class="headerlink" title="2.5 학습 테스트로 배우는 스프링"></a>2.5 학습 테스트로 배우는 스프링</h4><h4 id="2-6-정리"><a href="#2-6-정리" class="headerlink" title="2.6 정리"></a>2.6 정리</h4><h3 id="3장-템플릿"><a href="#3장-템플릿" class="headerlink" title="3장 템플릿"></a>3장 템플릿</h3><h4 id="3-1-다시보는-초난감-DAO"><a href="#3-1-다시보는-초난감-DAO" class="headerlink" title="3.1 다시보는 초난감 DAO"></a>3.1 다시보는 초난감 DAO</h4><ul><li>예외처리<ul><li>JDBC 에서 이슈 발생시에 커넥션 리소스 릴리즈 관련 try, catch, finally 구문을 통해 리소스 반환을 잘해줘야한다.</li><li>connection.close() 시에도 에러가 발생할수 있으므로, not null 시에 close에서 한번더 try catch 해준다. </li><li>ResultSet 또한 반환해야 하는 리소스 중에 하나이다.</li><li>하지만 매번 위와 같이 진행햇을때, 한번이라도 close 빼먹으면 리소스 부족으로 죽을수 있다. </li><li>따라서, 위 코드를 템플릿 패턴으로 개선하자.</li><li>변경되지 않는 부분은, 커넥션 가져오는부분, 리소스 반납하는 부분이다.</li><li>변경 필요한 부분만 abstract protected 로 슈퍼클래스에서 선언하고, 하위에서 구현하면, OCP를 확실히 구현할수 있다. </li><li>하지만 상속구조를 이용하기 때문에, 서브클래스에서 PreparedStatment라는 고정적으로 return 해줘야 하기때문에 유연성이 떨어져서, 확장이 힘들어 진다.</li><li>So, 전략패턴을 적용해야한다.</li><li>전략패턴은 OPC 원칙을 잘지키면서, 템플릿 메소드 패턴보다 유연하고 확장성뛰어나다. 이는 인터페이스로 서로를 의존하도록 만들엇기 때문이다.</li><li>전략패턴에서 Context가 사용하는 전략은 앞단의 Client 에서 전달한다. 이를 기반으로 Context 는 해당 전략으로 이뤄진 구현 클래스의 오브젝트를 사용한다.</li><li>결과적으로 StatementStrategy 인터페이스를 넘겨주는 것이 확장성에 좋다. <strong>(219 페이지 다시 읽어볼것… )</strong></li><li><strong>226 페이지, 전략과 클라이언트의 동거</strong> 다시 한번 읽어 볼것. 내부클래스 및 등등</li><li>결과적으로 해당 샘플에서 전략적 패턴의 구조로 보자면, UserDao의 메소드가 클라이언트이고, 익명 내부 클래스가 개별전략이고, jdbcContextWithStatementStrategy()메소드는 컨텍스트 이다.</li></ul></li></ul><h4 id="3-2-변하는-것과-변하지-않는-것"><a href="#3-2-변하는-것과-변하지-않는-것" class="headerlink" title="3.2 변하는 것과 변하지 않는 것"></a>3.2 변하는 것과 변하지 않는 것</h4><h4 id="3-3-JDBC-전력-패턴의-최적화"><a href="#3-3-JDBC-전력-패턴의-최적화" class="headerlink" title="3.3 JDBC 전력 패턴의 최적화"></a>3.3 JDBC 전력 패턴의 최적화</h4><h4 id="3-4-컨텍스트와-DI"><a href="#3-4-컨텍스트와-DI" class="headerlink" title="3.4 컨텍스트와 DI"></a>3.4 컨텍스트와 DI</h4><h4 id="3-5-템플릿과-콜백"><a href="#3-5-템플릿과-콜백" class="headerlink" title="3.5 템플릿과 콜백"></a>3.5 템플릿과 콜백</h4><h4 id="3-6-스프링의-JDBCTEMPLATE"><a href="#3-6-스프링의-JDBCTEMPLATE" class="headerlink" title="3.6 스프링의 JDBCTEMPLATE"></a>3.6 스프링의 JDBCTEMPLATE</h4><h4 id="3-7-정리"><a href="#3-7-정리" class="headerlink" title="3.7 정리"></a>3.7 정리</h4><h3 id="4장-예외"><a href="#4장-예외" class="headerlink" title="4장 예외"></a>4장 예외</h3><h4 id="4-1-사라진-SQLEXCEPTION"><a href="#4-1-사라진-SQLEXCEPTION" class="headerlink" title="4.1 사라진 SQLEXCEPTION"></a>4.1 사라진 SQLEXCEPTION</h4><h4 id="4-2-예외-전환"><a href="#4-2-예외-전환" class="headerlink" title="4.2 예외 전환"></a>4.2 예외 전환</h4><h4 id="4-3-정리"><a href="#4-3-정리" class="headerlink" title="4.3 정리"></a>4.3 정리</h4><h3 id="5장-서비스-추상화"><a href="#5장-서비스-추상화" class="headerlink" title="5장 서비스 추상화"></a>5장 서비스 추상화</h3><h4 id="5-1-사용자-레벨-관리-기능-추가"><a href="#5-1-사용자-레벨-관리-기능-추가" class="headerlink" title="5.1 사용자 레벨 관리 기능 추가"></a>5.1 사용자 레벨 관리 기능 추가</h4><h4 id="5-2-트랜잭션-서비스-추상화"><a href="#5-2-트랜잭션-서비스-추상화" class="headerlink" title="5.2 트랜잭션 서비스 추상화"></a>5.2 트랜잭션 서비스 추상화</h4><h4 id="5-3-서비스-추상화와-단일-책임-원칙"><a href="#5-3-서비스-추상화와-단일-책임-원칙" class="headerlink" title="5.3 서비스 추상화와 단일 책임 원칙"></a>5.3 서비스 추상화와 단일 책임 원칙</h4><h4 id="5-4-메일-서비스-추상화"><a href="#5-4-메일-서비스-추상화" class="headerlink" title="5.4 메일 서비스 추상화"></a>5.4 메일 서비스 추상화</h4><h4 id="5-5-정리"><a href="#5-5-정리" class="headerlink" title="5.5 정리"></a>5.5 정리</h4><h3 id="6장-AOP"><a href="#6장-AOP" class="headerlink" title="6장 AOP"></a>6장 AOP</h3><h4 id="6-1-트랜잭션-코드의-분리"><a href="#6-1-트랜잭션-코드의-분리" class="headerlink" title="6.1 트랜잭션 코드의 분리"></a>6.1 트랜잭션 코드의 분리</h4><h4 id="6-2-고립된-단위-테스트"><a href="#6-2-고립된-단위-테스트" class="headerlink" title="6.2 고립된 단위 테스트"></a>6.2 고립된 단위 테스트</h4><h4 id="6-3-다이내믹-프록시와-팩토리-빈"><a href="#6-3-다이내믹-프록시와-팩토리-빈" class="headerlink" title="6.3 다이내믹 프록시와 팩토리 빈"></a>6.3 다이내믹 프록시와 팩토리 빈</h4><h4 id="6-4-스프링-프록시-팩토리-빈"><a href="#6-4-스프링-프록시-팩토리-빈" class="headerlink" title="6.4 스프링 프록시 팩토리 빈"></a>6.4 스프링 프록시 팩토리 빈</h4><h4 id="6-5-스프링-AOP"><a href="#6-5-스프링-AOP" class="headerlink" title="6.5 스프링 AOP"></a>6.5 스프링 AOP</h4><h4 id="6-6-트랜잭션-속성"><a href="#6-6-트랜잭션-속성" class="headerlink" title="6.6 트랜잭션 속성"></a>6.6 트랜잭션 속성</h4><h4 id="6-7-애노테이션-트랜잭션-속성과-포인트컷"><a href="#6-7-애노테이션-트랜잭션-속성과-포인트컷" class="headerlink" title="6.7 애노테이션 트랜잭션 속성과 포인트컷"></a>6.7 애노테이션 트랜잭션 속성과 포인트컷</h4><h4 id="6-8-트랜잭션-지원-테스트"><a href="#6-8-트랜잭션-지원-테스트" class="headerlink" title="6.8 트랜잭션 지원 테스트"></a>6.8 트랜잭션 지원 테스트</h4><h4 id="6-9-정리"><a href="#6-9-정리" class="headerlink" title="6.9 정리"></a>6.9 정리</h4><h3 id="7장-스프링-핵심-기술의-응용"><a href="#7장-스프링-핵심-기술의-응용" class="headerlink" title="7장 스프링 핵심 기술의 응용"></a>7장 스프링 핵심 기술의 응용</h3><h4 id="7-1-SQL과-DAO의-분리"><a href="#7-1-SQL과-DAO의-분리" class="headerlink" title="7.1 SQL과 DAO의 분리"></a>7.1 SQL과 DAO의 분리</h4><h4 id="7-2-인터페이스의-분리와-자기참조-빈"><a href="#7-2-인터페이스의-분리와-자기참조-빈" class="headerlink" title="7.2 인터페이스의 분리와 자기참조 빈"></a>7.2 인터페이스의 분리와 자기참조 빈</h4><h4 id="7-3-서비스-추상화-적용"><a href="#7-3-서비스-추상화-적용" class="headerlink" title="7.3 서비스 추상화 적용"></a>7.3 서비스 추상화 적용</h4><h4 id="7-4-인터페이스-상속을-통한-안전한-기능확장"><a href="#7-4-인터페이스-상속을-통한-안전한-기능확장" class="headerlink" title="7.4 인터페이스 상속을 통한 안전한 기능확장"></a>7.4 인터페이스 상속을 통한 안전한 기능확장</h4><h4 id="7-5-DI를-이용해-다양한-구현-방법-적용하기"><a href="#7-5-DI를-이용해-다양한-구현-방법-적용하기" class="headerlink" title="7.5 DI를 이용해 다양한 구현 방법 적용하기"></a>7.5 DI를 이용해 다양한 구현 방법 적용하기</h4><h4 id="7-6-스프링-3-1의-DI"><a href="#7-6-스프링-3-1의-DI" class="headerlink" title="7.6 스프링 3.1의 DI"></a>7.6 스프링 3.1의 DI</h4><h4 id="7-7-정리"><a href="#7-7-정리" class="headerlink" title="7.7 정리"></a>7.7 정리</h4><h3 id="8장-스프링이란-무엇인가"><a href="#8장-스프링이란-무엇인가" class="headerlink" title="8장 스프링이란 무엇인가?"></a>8장 스프링이란 무엇인가?</h3><h4 id="8-1-스프링의-정의"><a href="#8-1-스프링의-정의" class="headerlink" title="8.1 스프링의 정의"></a>8.1 스프링의 정의</h4><h4 id="8-2-스프링의-목적"><a href="#8-2-스프링의-목적" class="headerlink" title="8.2 스프링의 목적"></a>8.2 스프링의 목적</h4><h4 id="8-3-POJO-프로그래밍"><a href="#8-3-POJO-프로그래밍" class="headerlink" title="8.3 POJO 프로그래밍"></a>8.3 POJO 프로그래밍</h4><h4 id="8-4-스프링의-기술"><a href="#8-4-스프링의-기술" class="headerlink" title="8.4 스프링의 기술"></a>8.4 스프링의 기술</h4><h4 id="8-5-정리"><a href="#8-5-정리" class="headerlink" title="8.5 정리"></a>8.5 정리</h4><h3 id="9장-스프링-프로젝트-시작하기"><a href="#9장-스프링-프로젝트-시작하기" class="headerlink" title="9장 스프링 프로젝트 시작하기"></a>9장 스프링 프로젝트 시작하기</h3><h4 id="9-1-자바-엔터프라이즈-플랫폼과-스프링-애플리케이션"><a href="#9-1-자바-엔터프라이즈-플랫폼과-스프링-애플리케이션" class="headerlink" title="9.1 자바 엔터프라이즈 플랫폼과 스프링 애플리케이션"></a>9.1 자바 엔터프라이즈 플랫폼과 스프링 애플리케이션</h4><h4 id="9-2-개발도구와-환경"><a href="#9-2-개발도구와-환경" class="headerlink" title="9.2 개발도구와 환경"></a>9.2 개발도구와 환경</h4><h4 id="9-3-애플리케이션-아키텍처"><a href="#9-3-애플리케이션-아키텍처" class="headerlink" title="9.3 애플리케이션 아키텍처"></a>9.3 애플리케이션 아키텍처</h4><h4 id="9-4-정리"><a href="#9-4-정리" class="headerlink" title="9.4 정리"></a>9.4 정리</h4><h3 id="부록-A-스프링-모듈"><a href="#부록-A-스프링-모듈" class="headerlink" title="부록 A 스프링 모듈"></a>부록 A 스프링 모듈</h3><h4 id="A-1-스프링-모듈의-종류와-특징"><a href="#A-1-스프링-모듈의-종류와-특징" class="headerlink" title="A.1 스프링 모듈의 종류와 특징"></a>A.1 스프링 모듈의 종류와 특징</h4><h4 id="A-2-스프링-모듈의-의존관계"><a href="#A-2-스프링-모듈의-의존관계" class="headerlink" title="A.2 스프링 모듈의 의존관계"></a>A.2 스프링 모듈의 의존관계</h4><h3 id="부록-B-스프링-의존-라이브러리"><a href="#부록-B-스프링-의존-라이브러리" class="headerlink" title="부록 B 스프링 의존 라이브러리"></a>부록 B 스프링 의존 라이브러리</h3><h4 id="B-1-의존-라이브러리의-종류와-특징"><a href="#B-1-의존-라이브러리의-종류와-특징" class="headerlink" title="B.1 의존 라이브러리의 종류와 특징"></a>B.1 의존 라이브러리의 종류와 특징</h4><h4 id="B-2-모듈별-의존-라이브러리-의존관계"><a href="#B-2-모듈별-의존-라이브러리-의존관계" class="headerlink" title="B.2 모듈별 의존 라이브러리 의존관계"></a>B.2 모듈별 의존 라이브러리 의존관계</h4><h2 id="Vol-2-스프링의-기술과-선택"><a href="#Vol-2-스프링의-기술과-선택" class="headerlink" title="Vol. 2 스프링의 기술과 선택"></a>Vol. 2 스프링의 기술과 선택</h2><h3 id="1장-IoC-컨테이너와-DI"><a href="#1장-IoC-컨테이너와-DI" class="headerlink" title="1장 IoC 컨테이너와 DI"></a>1장 IoC 컨테이너와 DI</h3><h3 id="2장-데이터-액세스-기술"><a href="#2장-데이터-액세스-기술" class="headerlink" title="2장 데이터 액세스 기술"></a>2장 데이터 액세스 기술</h3><h3 id="3장-스프링-웹-기술과-스프링-MVC"><a href="#3장-스프링-웹-기술과-스프링-MVC" class="headerlink" title="3장 스프링 웹 기술과 스프링 MVC"></a>3장 스프링 웹 기술과 스프링 MVC</h3><h3 id="4장-스프링-MVC"><a href="#4장-스프링-MVC" class="headerlink" title="4장 스프링 @MVC"></a>4장 스프링 @MVC</h3><h3 id="5장-AOP와-LTW"><a href="#5장-AOP와-LTW" class="headerlink" title="5장 AOP와 LTW"></a>5장 AOP와 LTW</h3><h3 id="6장-테스트-컨텍스트-프레임워크"><a href="#6장-테스트-컨텍스트-프레임워크" class="headerlink" title="6장 테스트 컨텍스트 프레임워크"></a>6장 테스트 컨텍스트 프레임워크</h3><h3 id="7장-스프링의-기타-기술과-효과적인-학습방법"><a href="#7장-스프링의-기타-기술과-효과적인-학습방법" class="headerlink" title="7장 스프링의 기타 기술과 효과적인 학습방법"></a>7장 스프링의 기타 기술과 효과적인 학습방법</h3><h3 id="부록-A-스프링-모듈-1"><a href="#부록-A-스프링-모듈-1" class="headerlink" title="부록 A 스프링 모듈"></a>부록 A 스프링 모듈</h3><h3 id="부록-B-스프링-의존-라이브러리-1"><a href="#부록-B-스프링-의존-라이브러리-1" class="headerlink" title="부록 B 스프링 의존 라이브러리"></a>부록 B 스프링 의존 라이브러리</h3></body></html>]]></content:encoded>
      
      <comments>http://ddongeee.github.io/2018/11/06/toby-spring-summary/#disqus_thread</comments>
    </item>
    
  </channel>
</rss>
